<!DOCTYPE html>
<html>

<head>
    <title>2022-01-block</title>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <meta charset=utf-8>
</head>

<body></body>
<script>
    (function() {
        function r(e, n, t) {
            function o(i, f) {
                if (!n[i]) {
                    if (!e[i]) {
                        var c = "function" == typeof require && require;
                        if (!f && c) return c(i, !0);
                        if (u) return u(i, !0);
                        var a = new Error("Cannot find module '" + i + "'");
                        throw a.code = "MODULE_NOT_FOUND", a
                    }
                    var p = n[i] = {
                        exports: {}
                    };
                    e[i][0].call(p.exports, function(r) {
                        var n = e[i][1][r];
                        return o(n || r)
                    }, p, p.exports, r, e, n, t)
                }
                return n[i].exports
            }
            for (var u = "function" == typeof require && require, i = 0; i < t.length; i++) o(t[i]);
            return o
        }
        return r
    })()({
            1: [function(require, module, exports) {
                module.exports = function(state, emitter) {
                    state.draws.push(new Brick(state.regl))
                }

                function Brick(regl) {
                    var drawOpts = {
                        frag: `
      precision highp float;
      #extension GL_OES_standard_derivatives: enable
      varying vec3 vpos, vcolor;
      uniform float alpha;
      void main () {
        vec3 N = normalize(cross(dFdx(vpos),dFdy(vpos)));
        vec3 L0 = normalize(vec3(2,8,3));
        vec3 L1 = normalize(vec3(-4,2,-1));
        vec3 C0 = vec3(0.8,0.8,0.5);
        vec3 C1 = vec3(0.3,0.4,0.7);
        vec3 L = max(vec3(0.2),max(dot(N,L0)*C0,dot(N,L1)*C1));
        gl_FragColor = vec4(pow(vcolor*L,vec3(1.0/2.0)),alpha);
      }
    `,
                        vert: `
      precision highp float;
      uniform mat4 projection, view;
      varying vec3 vpos, vcolor;
      varying float vid;
      attribute vec3 position, color;
      attribute float id;
      void main () {
        vpos = position;
        vcolor = color;
        vid = id;
        gl_Position = projection * view * vec4(position,1);
      }
    `,
                        uniforms: {
                            alpha: 1
                        },
                        attributes: {
                            position: regl.prop('positions'),
                            color: regl.prop('colors'),
                            id: regl.prop('ids')
                        },
                        elements: regl.prop('cells')
                    }
                    this._drawSolid = regl(drawOpts)
                    this._drawAlpha = regl(Object.assign({}, drawOpts, {
                        uniforms: {
                            alpha: 0.8
                        },
                        cull: {
                            enable: true,
                            face: 'back'
                        },
                        depth: {
                            enable: function(context, props) {
                                return !!props.depth
                            },
                            mask: false
                        },
                        blend: {
                            enable: true,
                            func: {
                                src: 'src alpha',
                                dst: 'one minus src alpha'
                            }
                        }
                    }))
                    this._pick = regl(Object.assign({}, drawOpts, {
                        frag: `
      precision highp float;
      varying vec3 vpos;
      varying float vid;
      void main () {
        vec3 coord = floor(vpos*0.5);
        gl_FragColor = vec4(coord,vid);
      }
    `
                    }))
                }

                Brick.prototype.draw = function(state) {
                    this._drawSolid(state.brickMesh)
                }

                Brick.prototype.postDraw = function(state) {
                    this._drawAlpha(state.hoverBrickMesh)
                }

                Brick.prototype.pick = function(state) {
                    this._pick(state.brickMesh)
                }

            }, {}],
            2: [function(require, module, exports) {
                var app = require('choo')()
                var regl = require('regl')

                app.use(function(state, emitter) {
                    state.canvas = document.createElement('canvas')
                    state.width = state.canvas.width = window.innerWidth
                    state.height = state.canvas.height = window.innerHeight
                    window.addEventListener('resize', function() {
                        state.width = state.canvas.width = window.innerWidth
                        state.height = state.canvas.height = window.innerHeight
                        emitter.emit('frame')
                    })
                    window.addEventListener('mousemove', onmouse)
                    window.addEventListener('mousedown', onmouse)
                    window.addEventListener('mouseup', onmouse)
                    window.addEventListener('wheel', onmouse)
                    window.addEventListener('keydown', function(ev) {
                        if (/^(input|textarea)$/.test(ev.target.tagName)) return
                        emitter.emit('keydown', ev)
                    })
                    state.mouse = {
                        previous: null,
                        current: null
                    }

                    function onmouse(ev) {
                        if (ev.target !== state.canvas) return
                        state.mouse.current = ev
                        emitter.emit('mouse', state.mouse.current, state.mouse.previous)
                        state.mouse.previous = ev
                    }
                    state.regl = regl({
                        extensions: ['oes_texture_float', 'oes_standard_derivatives'],
                        canvas: state.canvas
                    })
                    state.draws = []
                    state.uniforms = {}
                    emitter.on('frame', function() {
                        if (state.drawing) return
                        state.drawing = true
                        window.requestAnimationFrame(frame)
                    })
                    emitter.emit('frame')

                    function frame() {
                        state.drawing = false
                        state.regl.poll()
                        state.regl.clear({
                            color: [0.9, 1, 1, 1],
                            depth: true
                        })
                        state.uniformFn(function() {
                            for (var i = 0; i < state.draws.length; i++) {
                                var d = state.draws[i]
                                if (typeof d.preDraw === 'function') d.preDraw(state)
                            }
                            for (var i = 0; i < state.draws.length; i++) {
                                var d = state.draws[i]
                                if (typeof d.draw === 'function') d.draw(state)
                            }
                            for (var i = 0; i < state.draws.length; i++) {
                                var d = state.draws[i]
                                if (typeof d.postDraw === 'function') d.postDraw(state)
                            }
                        })
                    }
                    emitter.on('mouse', function(ev) {
                        emitter.emit('pick', ev)
                    })
                    state.pick = {
                        fb: state.regl.framebuffer({
                            colorType: 'float32'
                        }),
                        data: new Float32Array(4),
                    }
                    state.pick.usefb = state.regl({
                        framebuffer: state.pick.fb
                    })
                    emitter.on('pick', function(ev) {
                        state.pick.fb.resize(state.width, state.height)
                        state.pick.usefb(function() {
                            state.pick.fb.use(function() {
                                state.regl.clear({
                                    color: [0, 0, 0, -1],
                                    depth: true
                                })
                                state.uniformFn(function() {
                                    for (var i = 0; i < state.draws.length; i++) {
                                        var d = state.draws[i]
                                        if (typeof d.pick === 'function') d.pick(state)
                                    }
                                })
                                var data = state.regl.read({
                                    x: Math.max(0, Math.min(state.width - 1, ev.offsetX)),
                                    y: Math.max(0, Math.min(state.height - 1, state.height - ev.offsetY)),
                                    width: 1,
                                    height: 1
                                })
                                emitter.emit('pick-data', data, ev)
                            })
                        })
                    })
                })

                app.use(require('./draw/brick.js'))
                app.use(require('./store/brick.js'))
                app.use(require('./store/camera.js'))
                app.use(require('./store/ui.js'))

                app.use(function(state, emitter) {
                    state.uniformFn = state.regl({
                        uniforms: state.uniforms
                    })
                })

                app.route('*', require('./view/main.js'))

                app.mount(document.body)

            }, {
                "./draw/brick.js": 1,
                "./store/brick.js": 70,
                "./store/camera.js": 71,
                "./store/ui.js": 72,
                "./view/main.js": 73,
                "choo": 9,
                "regl": 63
            }],
            3: [function(require, module, exports) {
                (function(global) {
                    (function() {
                        'use strict';

                        var objectAssign = require('object-assign');

                        // compare and isBuffer taken from https://github.com/feross/buffer/blob/680e9e5e488f22aac27599a57dc844a6315928dd/index.js
                        // original notice:

                        /*!
                         * The buffer module from node.js, for the browser.
                         *
                         * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
                         * @license  MIT
                         */
                        function compare(a, b) {
                            if (a === b) {
                                return 0;
                            }

                            var x = a.length;
                            var y = b.length;

                            for (var i = 0, len = Math.min(x, y); i < len; ++i) {
                                if (a[i] !== b[i]) {
                                    x = a[i];
                                    y = b[i];
                                    break;
                                }
                            }

                            if (x < y) {
                                return -1;
                            }
                            if (y < x) {
                                return 1;
                            }
                            return 0;
                        }

                        function isBuffer(b) {
                            if (global.Buffer && typeof global.Buffer.isBuffer === 'function') {
                                return global.Buffer.isBuffer(b);
                            }
                            return !!(b != null && b._isBuffer);
                        }

                        // based on node assert, original notice:
                        // NB: The URL to the CommonJS spec is kept just for tradition.
                        //     node-assert has evolved a lot since then, both in API and behavior.

                        // http://wiki.commonjs.org/wiki/Unit_Testing/1.0
                        //
                        // THIS IS NOT TESTED NOR LIKELY TO WORK OUTSIDE V8!
                        //
                        // Originally from narwhal.js (http://narwhaljs.org)
                        // Copyright (c) 2009 Thomas Robinson <280north.com>
                        //
                        // Permission is hereby granted, free of charge, to any person obtaining a copy
                        // of this software and associated documentation files (the 'Software'), to
                        // deal in the Software without restriction, including without limitation the
                        // rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
                        // sell copies of the Software, and to permit persons to whom the Software is
                        // furnished to do so, subject to the following conditions:
                        //
                        // The above copyright notice and this permission notice shall be included in
                        // all copies or substantial portions of the Software.
                        //
                        // THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
                        // IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
                        // FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
                        // AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
                        // ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
                        // WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

                        var util = require('util/');
                        var hasOwn = Object.prototype.hasOwnProperty;
                        var pSlice = Array.prototype.slice;
                        var functionsHaveNames = (function() {
                            return function foo() {}.name === 'foo';
                        }());

                        function pToString(obj) {
                            return Object.prototype.toString.call(obj);
                        }

                        function isView(arrbuf) {
                            if (isBuffer(arrbuf)) {
                                return false;
                            }
                            if (typeof global.ArrayBuffer !== 'function') {
                                return false;
                            }
                            if (typeof ArrayBuffer.isView === 'function') {
                                return ArrayBuffer.isView(arrbuf);
                            }
                            if (!arrbuf) {
                                return false;
                            }
                            if (arrbuf instanceof DataView) {
                                return true;
                            }
                            if (arrbuf.buffer && arrbuf.buffer instanceof ArrayBuffer) {
                                return true;
                            }
                            return false;
                        }
                        // 1. The assert module provides functions that throw
                        // AssertionError's when particular conditions are not met. The
                        // assert module must conform to the following interface.

                        var assert = module.exports = ok;

                        // 2. The AssertionError is defined in assert.
                        // new assert.AssertionError({ message: message,
                        //                             actual: actual,
                        //                             expected: expected })

                        var regex = /\s*function\s+([^\(\s]*)\s*/;
                        // based on https://github.com/ljharb/function.prototype.name/blob/adeeeec8bfcc6068b187d7d9fb3d5bb1d3a30899/implementation.js
                        function getName(func) {
                            if (!util.isFunction(func)) {
                                return;
                            }
                            if (functionsHaveNames) {
                                return func.name;
                            }
                            var str = func.toString();
                            var match = str.match(regex);
                            return match && match[1];
                        }
                        assert.AssertionError = function AssertionError(options) {
                            this.name = 'AssertionError';
                            this.actual = options.actual;
                            this.expected = options.expected;
                            this.operator = options.operator;
                            if (options.message) {
                                this.message = options.message;
                                this.generatedMessage = false;
                            } else {
                                this.message = getMessage(this);
                                this.generatedMessage = true;
                            }
                            var stackStartFunction = options.stackStartFunction || fail;
                            if (Error.captureStackTrace) {
                                Error.captureStackTrace(this, stackStartFunction);
                            } else {
                                // non v8 browsers so we can have a stacktrace
                                var err = new Error();
                                if (err.stack) {
                                    var out = err.stack;

                                    // try to strip useless frames
                                    var fn_name = getName(stackStartFunction);
                                    var idx = out.indexOf('\n' + fn_name);
                                    if (idx >= 0) {
                                        // once we have located the function frame
                                        // we need to strip out everything before it (and its line)
                                        var next_line = out.indexOf('\n', idx + 1);
                                        out = out.substring(next_line + 1);
                                    }

                                    this.stack = out;
                                }
                            }
                        };

                        // assert.AssertionError instanceof Error
                        util.inherits(assert.AssertionError, Error);

                        function truncate(s, n) {
                            if (typeof s === 'string') {
                                return s.length < n ? s : s.slice(0, n);
                            } else {
                                return s;
                            }
                        }

                        function inspect(something) {
                            if (functionsHaveNames || !util.isFunction(something)) {
                                return util.inspect(something);
                            }
                            var rawname = getName(something);
                            var name = rawname ? ': ' + rawname : '';
                            return '[Function' + name + ']';
                        }

                        function getMessage(self) {
                            return truncate(inspect(self.actual), 128) + ' ' +
                                self.operator + ' ' +
                                truncate(inspect(self.expected), 128);
                        }

                        // At present only the three keys mentioned above are used and
                        // understood by the spec. Implementations or sub modules can pass
                        // other keys to the AssertionError's constructor - they will be
                        // ignored.

                        // 3. All of the following functions must throw an AssertionError
                        // when a corresponding condition is not met, with a message that
                        // may be undefined if not provided.  All assertion methods provide
                        // both the actual and expected values to the assertion error for
                        // display purposes.

                        function fail(actual, expected, message, operator, stackStartFunction) {
                            throw new assert.AssertionError({
                                message: message,
                                actual: actual,
                                expected: expected,
                                operator: operator,
                                stackStartFunction: stackStartFunction
                            });
                        }

                        // EXTENSION! allows for well behaved errors defined elsewhere.
                        assert.fail = fail;

                        // 4. Pure assertion tests whether a value is truthy, as determined
                        // by !!guard.
                        // assert.ok(guard, message_opt);
                        // This statement is equivalent to assert.equal(true, !!guard,
                        // message_opt);. To test strictly for the value true, use
                        // assert.strictEqual(true, guard, message_opt);.

                        function ok(value, message) {
                            if (!value) fail(value, true, message, '==', assert.ok);
                        }
                        assert.ok = ok;

                        // 5. The equality assertion tests shallow, coercive equality with
                        // ==.
                        // assert.equal(actual, expected, message_opt);

                        assert.equal = function equal(actual, expected, message) {
                            if (actual != expected) fail(actual, expected, message, '==', assert.equal);
                        };

                        // 6. The non-equality assertion tests for whether two objects are not equal
                        // with != assert.notEqual(actual, expected, message_opt);

                        assert.notEqual = function notEqual(actual, expected, message) {
                            if (actual == expected) {
                                fail(actual, expected, message, '!=', assert.notEqual);
                            }
                        };

                        // 7. The equivalence assertion tests a deep equality relation.
                        // assert.deepEqual(actual, expected, message_opt);

                        assert.deepEqual = function deepEqual(actual, expected, message) {
                            if (!_deepEqual(actual, expected, false)) {
                                fail(actual, expected, message, 'deepEqual', assert.deepEqual);
                            }
                        };

                        assert.deepStrictEqual = function deepStrictEqual(actual, expected, message) {
                            if (!_deepEqual(actual, expected, true)) {
                                fail(actual, expected, message, 'deepStrictEqual', assert.deepStrictEqual);
                            }
                        };

                        function _deepEqual(actual, expected, strict, memos) {
                            // 7.1. All identical values are equivalent, as determined by ===.
                            if (actual === expected) {
                                return true;
                            } else if (isBuffer(actual) && isBuffer(expected)) {
                                return compare(actual, expected) === 0;

                                // 7.2. If the expected value is a Date object, the actual value is
                                // equivalent if it is also a Date object that refers to the same time.
                            } else if (util.isDate(actual) && util.isDate(expected)) {
                                return actual.getTime() === expected.getTime();

                                // 7.3 If the expected value is a RegExp object, the actual value is
                                // equivalent if it is also a RegExp object with the same source and
                                // properties (`global`, `multiline`, `lastIndex`, `ignoreCase`).
                            } else if (util.isRegExp(actual) && util.isRegExp(expected)) {
                                return actual.source === expected.source &&
                                    actual.global === expected.global &&
                                    actual.multiline === expected.multiline &&
                                    actual.lastIndex === expected.lastIndex &&
                                    actual.ignoreCase === expected.ignoreCase;

                                // 7.4. Other pairs that do not both pass typeof value == 'object',
                                // equivalence is determined by ==.
                            } else if ((actual === null || typeof actual !== 'object') &&
                                (expected === null || typeof expected !== 'object')) {
                                return strict ? actual === expected : actual == expected;

                                // If both values are instances of typed arrays, wrap their underlying
                                // ArrayBuffers in a Buffer each to increase performance
                                // This optimization requires the arrays to have the same type as checked by
                                // Object.prototype.toString (aka pToString). Never perform binary
                                // comparisons for Float*Arrays, though, since e.g. +0 === -0 but their
                                // bit patterns are not identical.
                            } else if (isView(actual) && isView(expected) &&
                                pToString(actual) === pToString(expected) &&
                                !(actual instanceof Float32Array ||
                                    actual instanceof Float64Array)) {
                                return compare(new Uint8Array(actual.buffer),
                                    new Uint8Array(expected.buffer)) === 0;

                                // 7.5 For all other Object pairs, including Array objects, equivalence is
                                // determined by having the same number of owned properties (as verified
                                // with Object.prototype.hasOwnProperty.call), the same set of keys
                                // (although not necessarily the same order), equivalent values for every
                                // corresponding key, and an identical 'prototype' property. Note: this
                                // accounts for both named and indexed properties on Arrays.
                            } else if (isBuffer(actual) !== isBuffer(expected)) {
                                return false;
                            } else {
                                memos = memos || {
                                    actual: [],
                                    expected: []
                                };

                                var actualIndex = memos.actual.indexOf(actual);
                                if (actualIndex !== -1) {
                                    if (actualIndex === memos.expected.indexOf(expected)) {
                                        return true;
                                    }
                                }

                                memos.actual.push(actual);
                                memos.expected.push(expected);

                                return objEquiv(actual, expected, strict, memos);
                            }
                        }

                        function isArguments(object) {
                            return Object.prototype.toString.call(object) == '[object Arguments]';
                        }

                        function objEquiv(a, b, strict, actualVisitedObjects) {
                            if (a === null || a === undefined || b === null || b === undefined)
                                return false;
                            // if one is a primitive, the other must be same
                            if (util.isPrimitive(a) || util.isPrimitive(b))
                                return a === b;
                            if (strict && Object.getPrototypeOf(a) !== Object.getPrototypeOf(b))
                                return false;
                            var aIsArgs = isArguments(a);
                            var bIsArgs = isArguments(b);
                            if ((aIsArgs && !bIsArgs) || (!aIsArgs && bIsArgs))
                                return false;
                            if (aIsArgs) {
                                a = pSlice.call(a);
                                b = pSlice.call(b);
                                return _deepEqual(a, b, strict);
                            }
                            var ka = objectKeys(a);
                            var kb = objectKeys(b);
                            var key, i;
                            // having the same number of owned properties (keys incorporates
                            // hasOwnProperty)
                            if (ka.length !== kb.length)
                                return false;
                            //the same set of keys (although not necessarily the same order),
                            ka.sort();
                            kb.sort();
                            //~~~cheap key test
                            for (i = ka.length - 1; i >= 0; i--) {
                                if (ka[i] !== kb[i])
                                    return false;
                            }
                            //equivalent values for every corresponding key, and
                            //~~~possibly expensive deep test
                            for (i = ka.length - 1; i >= 0; i--) {
                                key = ka[i];
                                if (!_deepEqual(a[key], b[key], strict, actualVisitedObjects))
                                    return false;
                            }
                            return true;
                        }

                        // 8. The non-equivalence assertion tests for any deep inequality.
                        // assert.notDeepEqual(actual, expected, message_opt);

                        assert.notDeepEqual = function notDeepEqual(actual, expected, message) {
                            if (_deepEqual(actual, expected, false)) {
                                fail(actual, expected, message, 'notDeepEqual', assert.notDeepEqual);
                            }
                        };

                        assert.notDeepStrictEqual = notDeepStrictEqual;

                        function notDeepStrictEqual(actual, expected, message) {
                            if (_deepEqual(actual, expected, true)) {
                                fail(actual, expected, message, 'notDeepStrictEqual', notDeepStrictEqual);
                            }
                        }


                        // 9. The strict equality assertion tests strict equality, as determined by ===.
                        // assert.strictEqual(actual, expected, message_opt);

                        assert.strictEqual = function strictEqual(actual, expected, message) {
                            if (actual !== expected) {
                                fail(actual, expected, message, '===', assert.strictEqual);
                            }
                        };

                        // 10. The strict non-equality assertion tests for strict inequality, as
                        // determined by !==.  assert.notStrictEqual(actual, expected, message_opt);

                        assert.notStrictEqual = function notStrictEqual(actual, expected, message) {
                            if (actual === expected) {
                                fail(actual, expected, message, '!==', assert.notStrictEqual);
                            }
                        };

                        function expectedException(actual, expected) {
                            if (!actual || !expected) {
                                return false;
                            }

                            if (Object.prototype.toString.call(expected) == '[object RegExp]') {
                                return expected.test(actual);
                            }

                            try {
                                if (actual instanceof expected) {
                                    return true;
                                }
                            } catch (e) {
                                // Ignore.  The instanceof check doesn't work for arrow functions.
                            }

                            if (Error.isPrototypeOf(expected)) {
                                return false;
                            }

                            return expected.call({}, actual) === true;
                        }

                        function _tryBlock(block) {
                            var error;
                            try {
                                block();
                            } catch (e) {
                                error = e;
                            }
                            return error;
                        }

                        function _throws(shouldThrow, block, expected, message) {
                            var actual;

                            if (typeof block !== 'function') {
                                throw new TypeError('"block" argument must be a function');
                            }

                            if (typeof expected === 'string') {
                                message = expected;
                                expected = null;
                            }

                            actual = _tryBlock(block);

                            message = (expected && expected.name ? ' (' + expected.name + ').' : '.') +
                                (message ? ' ' + message : '.');

                            if (shouldThrow && !actual) {
                                fail(actual, expected, 'Missing expected exception' + message);
                            }

                            var userProvidedMessage = typeof message === 'string';
                            var isUnwantedException = !shouldThrow && util.isError(actual);
                            var isUnexpectedException = !shouldThrow && actual && !expected;

                            if ((isUnwantedException &&
                                    userProvidedMessage &&
                                    expectedException(actual, expected)) ||
                                isUnexpectedException) {
                                fail(actual, expected, 'Got unwanted exception' + message);
                            }

                            if ((shouldThrow && actual && expected &&
                                    !expectedException(actual, expected)) || (!shouldThrow && actual)) {
                                throw actual;
                            }
                        }

                        // 11. Expected to throw an error:
                        // assert.throws(block, Error_opt, message_opt);

                        assert.throws = function(block, /*optional*/ error, /*optional*/ message) {
                            _throws(true, block, error, message);
                        };

                        // EXTENSION! This is annoying to write outside this module.
                        assert.doesNotThrow = function(block, /*optional*/ error, /*optional*/ message) {
                            _throws(false, block, error, message);
                        };

                        assert.ifError = function(err) {
                            if (err) throw err;
                        };

                        // Expose a strict only variant of assert
                        function strict(value, message) {
                            if (!value) fail(value, true, message, '==', strict);
                        }
                        assert.strict = objectAssign(strict, assert, {
                            equal: assert.strictEqual,
                            deepEqual: assert.deepStrictEqual,
                            notEqual: assert.notStrictEqual,
                            notDeepEqual: assert.notDeepStrictEqual
                        });
                        assert.strict.strict = assert.strict;

                        var objectKeys = Object.keys || function(obj) {
                            var keys = [];
                            for (var key in obj) {
                                if (hasOwn.call(obj, key)) keys.push(key);
                            }
                            return keys;
                        };

                    }).call(this)
                }).call(this, typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
            }, {
                "object-assign": 61,
                "util/": 6
            }],
            4: [function(require, module, exports) {
                if (typeof Object.create === 'function') {
                    // implementation from standard node.js 'util' module
                    module.exports = function inherits(ctor, superCtor) {
                        ctor.super_ = superCtor
                        ctor.prototype = Object.create(superCtor.prototype, {
                            constructor: {
                                value: ctor,
                                enumerable: false,
                                writable: true,
                                configurable: true
                            }
                        });
                    };
                } else {
                    // old school shim for old browsers
                    module.exports = function inherits(ctor, superCtor) {
                        ctor.super_ = superCtor
                        var TempCtor = function() {}
                        TempCtor.prototype = superCtor.prototype
                        ctor.prototype = new TempCtor()
                        ctor.prototype.constructor = ctor
                    }
                }

            }, {}],
            5: [function(require, module, exports) {
                module.exports = function isBuffer(arg) {
                    return arg && typeof arg === 'object' &&
                        typeof arg.copy === 'function' &&
                        typeof arg.fill === 'function' &&
                        typeof arg.readUInt8 === 'function';
                }
            }, {}],
            6: [function(require, module, exports) {
                (function(process, global) {
                    (function() {
                        // Copyright Joyent, Inc. and other Node contributors.
                        //
                        // Permission is hereby granted, free of charge, to any person obtaining a
                        // copy of this software and associated documentation files (the
                        // "Software"), to deal in the Software without restriction, including
                        // without limitation the rights to use, copy, modify, merge, publish,
                        // distribute, sublicense, and/or sell copies of the Software, and to permit
                        // persons to whom the Software is furnished to do so, subject to the
                        // following conditions:
                        //
                        // The above copyright notice and this permission notice shall be included
                        // in all copies or substantial portions of the Software.
                        //
                        // THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
                        // OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
                        // MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
                        // NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
                        // DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
                        // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
                        // USE OR OTHER DEALINGS IN THE SOFTWARE.

                        var formatRegExp = /%[sdj%]/g;
                        exports.format = function(f) {
                            if (!isString(f)) {
                                var objects = [];
                                for (var i = 0; i < arguments.length; i++) {
                                    objects.push(inspect(arguments[i]));
                                }
                                return objects.join(' ');
                            }

                            var i = 1;
                            var args = arguments;
                            var len = args.length;
                            var str = String(f).replace(formatRegExp, function(x) {
                                if (x === '%%') return '%';
                                if (i >= len) return x;
                                switch (x) {
                                    case '%s':
                                        return String(args[i++]);
                                    case '%d':
                                        return Number(args[i++]);
                                    case '%j':
                                        try {
                                            return JSON.stringify(args[i++]);
                                        } catch (_) {
                                            return '[Circular]';
                                        }
                                    default:
                                        return x;
                                }
                            });
                            for (var x = args[i]; i < len; x = args[++i]) {
                                if (isNull(x) || !isObject(x)) {
                                    str += ' ' + x;
                                } else {
                                    str += ' ' + inspect(x);
                                }
                            }
                            return str;
                        };


                        // Mark that a method should not be used.
                        // Returns a modified function which warns once by default.
                        // If --no-deprecation is set, then it is a no-op.
                        exports.deprecate = function(fn, msg) {
                            // Allow for deprecating things in the process of starting up.
                            if (isUndefined(global.process)) {
                                return function() {
                                    return exports.deprecate(fn, msg).apply(this, arguments);
                                };
                            }

                            if (process.noDeprecation === true) {
                                return fn;
                            }

                            var warned = false;

                            function deprecated() {
                                if (!warned) {
                                    if (process.throwDeprecation) {
                                        throw new Error(msg);
                                    } else if (process.traceDeprecation) {
                                        console.trace(msg);
                                    } else {
                                        console.error(msg);
                                    }
                                    warned = true;
                                }
                                return fn.apply(this, arguments);
                            }

                            return deprecated;
                        };


                        var debugs = {};
                        var debugEnviron;
                        exports.debuglog = function(set) {
                            if (isUndefined(debugEnviron))
                                debugEnviron = process.env.NODE_DEBUG || '';
                            set = set.toUpperCase();
                            if (!debugs[set]) {
                                if (new RegExp('\\b' + set + '\\b', 'i').test(debugEnviron)) {
                                    var pid = process.pid;
                                    debugs[set] = function() {
                                        var msg = exports.format.apply(exports, arguments);
                                        console.error('%s %d: %s', set, pid, msg);
                                    };
                                } else {
                                    debugs[set] = function() {};
                                }
                            }
                            return debugs[set];
                        };


                        /**
                         * Echos the value of a value. Trys to print the value out
                         * in the best way possible given the different types.
                         *
                         * @param {Object} obj The object to print out.
                         * @param {Object} opts Optional options object that alters the output.
                         */
                        /* legacy: obj, showHidden, depth, colors*/
                        function inspect(obj, opts) {
                            // default options
                            var ctx = {
                                seen: [],
                                stylize: stylizeNoColor
                            };
                            // legacy...
                            if (arguments.length >= 3) ctx.depth = arguments[2];
                            if (arguments.length >= 4) ctx.colors = arguments[3];
                            if (isBoolean(opts)) {
                                // legacy...
                                ctx.showHidden = opts;
                            } else if (opts) {
                                // got an "options" object
                                exports._extend(ctx, opts);
                            }
                            // set default options
                            if (isUndefined(ctx.showHidden)) ctx.showHidden = false;
                            if (isUndefined(ctx.depth)) ctx.depth = 2;
                            if (isUndefined(ctx.colors)) ctx.colors = false;
                            if (isUndefined(ctx.customInspect)) ctx.customInspect = true;
                            if (ctx.colors) ctx.stylize = stylizeWithColor;
                            return formatValue(ctx, obj, ctx.depth);
                        }
                        exports.inspect = inspect;


                        // http://en.wikipedia.org/wiki/ANSI_escape_code#graphics
                        inspect.colors = {
                            'bold': [1, 22],
                            'italic': [3, 23],
                            'underline': [4, 24],
                            'inverse': [7, 27],
                            'white': [37, 39],
                            'grey': [90, 39],
                            'black': [30, 39],
                            'blue': [34, 39],
                            'cyan': [36, 39],
                            'green': [32, 39],
                            'magenta': [35, 39],
                            'red': [31, 39],
                            'yellow': [33, 39]
                        };

                        // Don't use 'blue' not visible on cmd.exe
                        inspect.styles = {
                            'special': 'cyan',
                            'number': 'yellow',
                            'boolean': 'yellow',
                            'undefined': 'grey',
                            'null': 'bold',
                            'string': 'green',
                            'date': 'magenta',
                            // "name": intentionally not styling
                            'regexp': 'red'
                        };


                        function stylizeWithColor(str, styleType) {
                            var style = inspect.styles[styleType];

                            if (style) {
                                return '\u001b[' + inspect.colors[style][0] + 'm' + str +
                                    '\u001b[' + inspect.colors[style][1] + 'm';
                            } else {
                                return str;
                            }
                        }


                        function stylizeNoColor(str, styleType) {
                            return str;
                        }


                        function arrayToHash(array) {
                            var hash = {};

                            array.forEach(function(val, idx) {
                                hash[val] = true;
                            });

                            return hash;
                        }


                        function formatValue(ctx, value, recurseTimes) {
                            // Provide a hook for user-specified inspect functions.
                            // Check that value is an object with an inspect function on it
                            if (ctx.customInspect &&
                                value &&
                                isFunction(value.inspect) &&
                                // Filter out the util module, it's inspect function is special
                                value.inspect !== exports.inspect &&
                                // Also filter out any prototype objects using the circular check.
                                !(value.constructor && value.constructor.prototype === value)) {
                                var ret = value.inspect(recurseTimes, ctx);
                                if (!isString(ret)) {
                                    ret = formatValue(ctx, ret, recurseTimes);
                                }
                                return ret;
                            }

                            // Primitive types cannot have properties
                            var primitive = formatPrimitive(ctx, value);
                            if (primitive) {
                                return primitive;
                            }

                            // Look up the keys of the object.
                            var keys = Object.keys(value);
                            var visibleKeys = arrayToHash(keys);

                            if (ctx.showHidden) {
                                keys = Object.getOwnPropertyNames(value);
                            }

                            // IE doesn't make error fields non-enumerable
                            // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx
                            if (isError(value) &&
                                (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {
                                return formatError(value);
                            }

                            // Some type of object without properties can be shortcutted.
                            if (keys.length === 0) {
                                if (isFunction(value)) {
                                    var name = value.name ? ': ' + value.name : '';
                                    return ctx.stylize('[Function' + name + ']', 'special');
                                }
                                if (isRegExp(value)) {
                                    return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
                                }
                                if (isDate(value)) {
                                    return ctx.stylize(Date.prototype.toString.call(value), 'date');
                                }
                                if (isError(value)) {
                                    return formatError(value);
                                }
                            }

                            var base = '',
                                array = false,
                                braces = ['{', '}'];

                            // Make Array say that they are Array
                            if (isArray(value)) {
                                array = true;
                                braces = ['[', ']'];
                            }

                            // Make functions say that they are functions
                            if (isFunction(value)) {
                                var n = value.name ? ': ' + value.name : '';
                                base = ' [Function' + n + ']';
                            }

                            // Make RegExps say that they are RegExps
                            if (isRegExp(value)) {
                                base = ' ' + RegExp.prototype.toString.call(value);
                            }

                            // Make dates with properties first say the date
                            if (isDate(value)) {
                                base = ' ' + Date.prototype.toUTCString.call(value);
                            }

                            // Make error with message first say the error
                            if (isError(value)) {
                                base = ' ' + formatError(value);
                            }

                            if (keys.length === 0 && (!array || value.length == 0)) {
                                return braces[0] + base + braces[1];
                            }

                            if (recurseTimes < 0) {
                                if (isRegExp(value)) {
                                    return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
                                } else {
                                    return ctx.stylize('[Object]', 'special');
                                }
                            }

                            ctx.seen.push(value);

                            var output;
                            if (array) {
                                output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);
                            } else {
                                output = keys.map(function(key) {
                                    return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);
                                });
                            }

                            ctx.seen.pop();

                            return reduceToSingleString(output, base, braces);
                        }


                        function formatPrimitive(ctx, value) {
                            if (isUndefined(value))
                                return ctx.stylize('undefined', 'undefined');
                            if (isString(value)) {
                                var simple = '\'' + JSON.stringify(value).replace(/^"|"$/g, '')
                                    .replace(/'/g, "\\'")
                                    .replace(/\\"/g, '"') + '\'';
                                return ctx.stylize(simple, 'string');
                            }
                            if (isNumber(value))
                                return ctx.stylize('' + value, 'number');
                            if (isBoolean(value))
                                return ctx.stylize('' + value, 'boolean');
                            // For some reason typeof null is "object", so special case here.
                            if (isNull(value))
                                return ctx.stylize('null', 'null');
                        }


                        function formatError(value) {
                            return '[' + Error.prototype.toString.call(value) + ']';
                        }


                        function formatArray(ctx, value, recurseTimes, visibleKeys, keys) {
                            var output = [];
                            for (var i = 0, l = value.length; i < l; ++i) {
                                if (hasOwnProperty(value, String(i))) {
                                    output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
                                        String(i), true));
                                } else {
                                    output.push('');
                                }
                            }
                            keys.forEach(function(key) {
                                if (!key.match(/^\d+$/)) {
                                    output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
                                        key, true));
                                }
                            });
                            return output;
                        }


                        function formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {
                            var name, str, desc;
                            desc = Object.getOwnPropertyDescriptor(value, key) || {
                                value: value[key]
                            };
                            if (desc.get) {
                                if (desc.set) {
                                    str = ctx.stylize('[Getter/Setter]', 'special');
                                } else {
                                    str = ctx.stylize('[Getter]', 'special');
                                }
                            } else {
                                if (desc.set) {
                                    str = ctx.stylize('[Setter]', 'special');
                                }
                            }
                            if (!hasOwnProperty(visibleKeys, key)) {
                                name = '[' + key + ']';
                            }
                            if (!str) {
                                if (ctx.seen.indexOf(desc.value) < 0) {
                                    if (isNull(recurseTimes)) {
                                        str = formatValue(ctx, desc.value, null);
                                    } else {
                                        str = formatValue(ctx, desc.value, recurseTimes - 1);
                                    }
                                    if (str.indexOf('\n') > -1) {
                                        if (array) {
                                            str = str.split('\n').map(function(line) {
                                                return '  ' + line;
                                            }).join('\n').substr(2);
                                        } else {
                                            str = '\n' + str.split('\n').map(function(line) {
                                                return '   ' + line;
                                            }).join('\n');
                                        }
                                    }
                                } else {
                                    str = ctx.stylize('[Circular]', 'special');
                                }
                            }
                            if (isUndefined(name)) {
                                if (array && key.match(/^\d+$/)) {
                                    return str;
                                }
                                name = JSON.stringify('' + key);
                                if (name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)) {
                                    name = name.substr(1, name.length - 2);
                                    name = ctx.stylize(name, 'name');
                                } else {
                                    name = name.replace(/'/g, "\\'")
                                        .replace(/\\"/g, '"')
                                        .replace(/(^"|"$)/g, "'");
                                    name = ctx.stylize(name, 'string');
                                }
                            }

                            return name + ': ' + str;
                        }


                        function reduceToSingleString(output, base, braces) {
                            var numLinesEst = 0;
                            var length = output.reduce(function(prev, cur) {
                                numLinesEst++;
                                if (cur.indexOf('\n') >= 0) numLinesEst++;
                                return prev + cur.replace(/\u001b\[\d\d?m/g, '').length + 1;
                            }, 0);

                            if (length > 60) {
                                return braces[0] +
                                    (base === '' ? '' : base + '\n ') +
                                    ' ' +
                                    output.join(',\n  ') +
                                    ' ' +
                                    braces[1];
                            }

                            return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];
                        }


                        // NOTE: These type checking functions intentionally don't use `instanceof`
                        // because it is fragile and can be easily faked with `Object.create()`.
                        function isArray(ar) {
                            return Array.isArray(ar);
                        }
                        exports.isArray = isArray;

                        function isBoolean(arg) {
                            return typeof arg === 'boolean';
                        }
                        exports.isBoolean = isBoolean;

                        function isNull(arg) {
                            return arg === null;
                        }
                        exports.isNull = isNull;

                        function isNullOrUndefined(arg) {
                            return arg == null;
                        }
                        exports.isNullOrUndefined = isNullOrUndefined;

                        function isNumber(arg) {
                            return typeof arg === 'number';
                        }
                        exports.isNumber = isNumber;

                        function isString(arg) {
                            return typeof arg === 'string';
                        }
                        exports.isString = isString;

                        function isSymbol(arg) {
                            return typeof arg === 'symbol';
                        }
                        exports.isSymbol = isSymbol;

                        function isUndefined(arg) {
                            return arg === void 0;
                        }
                        exports.isUndefined = isUndefined;

                        function isRegExp(re) {
                            return isObject(re) && objectToString(re) === '[object RegExp]';
                        }
                        exports.isRegExp = isRegExp;

                        function isObject(arg) {
                            return typeof arg === 'object' && arg !== null;
                        }
                        exports.isObject = isObject;

                        function isDate(d) {
                            return isObject(d) && objectToString(d) === '[object Date]';
                        }
                        exports.isDate = isDate;

                        function isError(e) {
                            return isObject(e) &&
                                (objectToString(e) === '[object Error]' || e instanceof Error);
                        }
                        exports.isError = isError;

                        function isFunction(arg) {
                            return typeof arg === 'function';
                        }
                        exports.isFunction = isFunction;

                        function isPrimitive(arg) {
                            return arg === null ||
                                typeof arg === 'boolean' ||
                                typeof arg === 'number' ||
                                typeof arg === 'string' ||
                                typeof arg === 'symbol' || // ES6 symbol
                                typeof arg === 'undefined';
                        }
                        exports.isPrimitive = isPrimitive;

                        exports.isBuffer = require('./support/isBuffer');

                        function objectToString(o) {
                            return Object.prototype.toString.call(o);
                        }


                        function pad(n) {
                            return n < 10 ? '0' + n.toString(10) : n.toString(10);
                        }


                        var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',
                            'Oct', 'Nov', 'Dec'
                        ];

                        // 26 Feb 16:19:34
                        function timestamp() {
                            var d = new Date();
                            var time = [pad(d.getHours()),
                                pad(d.getMinutes()),
                                pad(d.getSeconds())
                            ].join(':');
                            return [d.getDate(), months[d.getMonth()], time].join(' ');
                        }


                        // log is just a thin wrapper to console.log that prepends a timestamp
                        exports.log = function() {
                            console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));
                        };


                        /**
                         * Inherit the prototype methods from one constructor into another.
                         *
                         * The Function.prototype.inherits from lang.js rewritten as a standalone
                         * function (not on Function.prototype). NOTE: If this file is to be loaded
                         * during bootstrapping this function needs to be rewritten using some native
                         * functions as prototype setup using normal JavaScript does not work as
                         * expected during bootstrapping (see mirror.js in r114903).
                         *
                         * @param {function} ctor Constructor function which needs to inherit the
                         *     prototype.
                         * @param {function} superCtor Constructor function to inherit prototype from.
                         */
                        exports.inherits = require('inherits');

                        exports._extend = function(origin, add) {
                            // Don't do anything if add isn't an object
                            if (!add || !isObject(add)) return origin;

                            var keys = Object.keys(add);
                            var i = keys.length;
                            while (i--) {
                                origin[keys[i]] = add[keys[i]];
                            }
                            return origin;
                        };

                        function hasOwnProperty(obj, prop) {
                            return Object.prototype.hasOwnProperty.call(obj, prop);
                        }

                    }).call(this)
                }).call(this, require('_process'), typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
            }, {
                "./support/isBuffer": 5,
                "_process": 62,
                "inherits": 4
            }],
            7: [function(require, module, exports) {
                var assert = require('assert')
                var LRU = require('nanolru')

                module.exports = ChooComponentCache

                function ChooComponentCache(state, emit, lru) {
                    assert.ok(this instanceof ChooComponentCache, 'ChooComponentCache should be created with `new`')

                    assert.equal(typeof state, 'object', 'ChooComponentCache: state should be type object')
                    assert.equal(typeof emit, 'function', 'ChooComponentCache: emit should be type function')

                    if (typeof lru === 'number') this.cache = new LRU(lru)
                    else this.cache = lru || new LRU(100)
                    this.state = state
                    this.emit = emit
                }

                // Get & create component instances.
                ChooComponentCache.prototype.render = function(Component, id) {
                    assert.equal(typeof Component, 'function', 'ChooComponentCache.render: Component should be type function')
                    assert.ok(typeof id === 'string' || typeof id === 'number', 'ChooComponentCache.render: id should be type string or type number')

                    var el = this.cache.get(id)
                    if (!el) {
                        var args = []
                        for (var i = 2, len = arguments.length; i < len; i++) {
                            args.push(arguments[i])
                        }
                        args.unshift(Component, id, this.state, this.emit)
                        el = newCall.apply(newCall, args)
                        this.cache.set(id, el)
                    }

                    return el
                }

                // Because you can't call `new` and `.apply()` at the same time. This is a mad
                // hack, but hey it works so we gonna go for it. Whoop.
                function newCall(Cls) {
                    return new(Cls.bind.apply(Cls, arguments)) // eslint-disable-line
                }

            }, {
                "assert": 43,
                "nanolru": 52
            }],
            8: [function(require, module, exports) {
                module.exports = require('nanohtml')

            }, {
                "nanohtml": 48
            }],
            9: [function(require, module, exports) {
                var scrollToAnchor = require('scroll-to-anchor')
                var documentReady = require('document-ready')
                var nanotiming = require('nanotiming')
                var nanorouter = require('nanorouter')
                var nanomorph = require('nanomorph')
                var nanoquery = require('nanoquery')
                var nanohref = require('nanohref')
                var nanoraf = require('nanoraf')
                var nanobus = require('nanobus')
                var assert = require('assert')
                var xtend = require('xtend')

                var Cache = require('./component/cache')

                module.exports = Choo

                var HISTORY_OBJECT = {}

                function Choo(opts) {
                    if (!(this instanceof Choo)) return new Choo(opts)
                    opts = opts || {}

                    assert.equal(typeof opts, 'object', 'choo: opts should be type object')

                    var self = this

                    // define events used by choo
                    this._events = {
                        DOMCONTENTLOADED: 'DOMContentLoaded',
                        DOMTITLECHANGE: 'DOMTitleChange',
                        REPLACESTATE: 'replaceState',
                        PUSHSTATE: 'pushState',
                        NAVIGATE: 'navigate',
                        POPSTATE: 'popState',
                        RENDER: 'render'
                    }

                    // properties for internal use only
                    this._historyEnabled = opts.history === undefined ? true : opts.history
                    this._hrefEnabled = opts.href === undefined ? true : opts.href
                    this._hashEnabled = opts.hash === undefined ? true : opts.hash
                    this._hasWindow = typeof window !== 'undefined'
                    this._cache = opts.cache
                    this._loaded = false
                    this._stores = []
                    this._tree = null

                    // state
                    var _state = {
                        events: this._events,
                        components: {}
                    }
                    if (this._hasWindow) {
                        this.state = window.initialState ?
                            xtend(window.initialState, _state) :
                            _state
                        delete window.initialState
                    } else {
                        this.state = _state
                    }

                    // properties that are part of the API
                    this.router = nanorouter({
                        curry: true
                    })
                    this.emitter = nanobus('choo.emit')
                    this.emit = this.emitter.emit.bind(this.emitter)

                    // listen for title changes; available even when calling .toString()
                    if (this._hasWindow) this.state.title = document.title
                    this.emitter.prependListener(this._events.DOMTITLECHANGE, function(title) {
                        assert.equal(typeof title, 'string', 'events.DOMTitleChange: title should be type string')
                        self.state.title = title
                        if (self._hasWindow) document.title = title
                    })
                }

                Choo.prototype.route = function(route, handler) {
                    assert.equal(typeof route, 'string', 'choo.route: route should be type string')
                    assert.equal(typeof handler, 'function', 'choo.handler: route should be type function')
                    this.router.on(route, handler)
                }

                Choo.prototype.use = function(cb) {
                    assert.equal(typeof cb, 'function', 'choo.use: cb should be type function')
                    var self = this
                    this._stores.push(function(state) {
                        var msg = 'choo.use'
                        msg = cb.storeName ? msg + '(' + cb.storeName + ')' : msg
                        var endTiming = nanotiming(msg)
                        cb(state, self.emitter, self)
                        endTiming()
                    })
                }

                Choo.prototype.start = function() {
                    assert.equal(typeof window, 'object', 'choo.start: window was not found. .start() must be called in a browser, use .toString() if running in Node')

                    var self = this
                    if (this._historyEnabled) {
                        this.emitter.prependListener(this._events.NAVIGATE, function() {
                            self._matchRoute()
                            if (self._loaded) {
                                self.emitter.emit(self._events.RENDER)
                                setTimeout(scrollToAnchor.bind(null, window.location.hash), 0)
                            }
                        })

                        this.emitter.prependListener(this._events.POPSTATE, function() {
                            self.emitter.emit(self._events.NAVIGATE)
                        })

                        this.emitter.prependListener(this._events.PUSHSTATE, function(href) {
                            assert.equal(typeof href, 'string', 'events.pushState: href should be type string')
                            window.history.pushState(HISTORY_OBJECT, null, href)
                            self.emitter.emit(self._events.NAVIGATE)
                        })

                        this.emitter.prependListener(this._events.REPLACESTATE, function(href) {
                            assert.equal(typeof href, 'string', 'events.replaceState: href should be type string')
                            window.history.replaceState(HISTORY_OBJECT, null, href)
                            self.emitter.emit(self._events.NAVIGATE)
                        })

                        window.onpopstate = function() {
                            self.emitter.emit(self._events.POPSTATE)
                        }

                        if (self._hrefEnabled) {
                            nanohref(function(location) {
                                var href = location.href
                                var hash = location.hash
                                if (href === window.location.href) {
                                    if (!self._hashEnabled && hash) scrollToAnchor(hash)
                                    return
                                }
                                self.emitter.emit(self._events.PUSHSTATE, href)
                            })
                        }
                    }

                    this._setCache(this.state)
                    this._stores.forEach(function(initStore) {
                        initStore(self.state)
                    })

                    this._matchRoute()
                    this._tree = this._prerender(this.state)
                    assert.ok(this._tree, 'choo.start: no valid DOM node returned for location ' + this.state.href)

                    this.emitter.prependListener(self._events.RENDER, nanoraf(function() {
                        var renderTiming = nanotiming('choo.render')
                        var newTree = self._prerender(self.state)
                        assert.ok(newTree, 'choo.render: no valid DOM node returned for location ' + self.state.href)

                        assert.equal(self._tree.nodeName, newTree.nodeName, 'choo.render: The target node <' +
                            self._tree.nodeName.toLowerCase() + '> is not the same type as the new node <' +
                            newTree.nodeName.toLowerCase() + '>.')

                        var morphTiming = nanotiming('choo.morph')
                        nanomorph(self._tree, newTree)
                        morphTiming()

                        renderTiming()
                    }))

                    documentReady(function() {
                        self.emitter.emit(self._events.DOMCONTENTLOADED)
                        self._loaded = true
                    })

                    return this._tree
                }

                Choo.prototype.mount = function mount(selector) {
                    if (typeof window !== 'object') {
                        assert.ok(typeof selector === 'string', 'choo.mount: selector should be type String')
                        this.selector = selector
                        return this
                    }

                    assert.ok(typeof selector === 'string' || typeof selector === 'object', 'choo.mount: selector should be type String or HTMLElement')

                    var self = this

                    documentReady(function() {
                        var renderTiming = nanotiming('choo.render')
                        var newTree = self.start()
                        if (typeof selector === 'string') {
                            self._tree = document.querySelector(selector)
                        } else {
                            self._tree = selector
                        }

                        assert.ok(self._tree, 'choo.mount: could not query selector: ' + selector)
                        assert.equal(self._tree.nodeName, newTree.nodeName, 'choo.mount: The target node <' +
                            self._tree.nodeName.toLowerCase() + '> is not the same type as the new node <' +
                            newTree.nodeName.toLowerCase() + '>.')

                        var morphTiming = nanotiming('choo.morph')
                        nanomorph(self._tree, newTree)
                        morphTiming()

                        renderTiming()
                    })
                }

                Choo.prototype.toString = function(location, state) {
                    this.state = xtend(this.state, state || {})

                    assert.notEqual(typeof window, 'object', 'choo.mount: window was found. .toString() must be called in Node, use .start() or .mount() if running in the browser')
                    assert.equal(typeof location, 'string', 'choo.toString: location should be type string')
                    assert.equal(typeof this.state, 'object', 'choo.toString: state should be type object')

                    var self = this
                    this._setCache(this.state)
                    this._stores.forEach(function(initStore) {
                        initStore(self.state)
                    })

                    this._matchRoute(location)
                    var html = this._prerender(this.state)
                    assert.ok(html, 'choo.toString: no valid value returned for the route ' + location)
                    assert(!Array.isArray(html), 'choo.toString: return value was an array for the route ' + location)
                    return typeof html.outerHTML === 'string' ? html.outerHTML : html.toString()
                }

                Choo.prototype._matchRoute = function(locationOverride) {
                    var location, queryString
                    if (locationOverride) {
                        location = locationOverride.replace(/\?.+$/, '').replace(/\/$/, '')
                        if (!this._hashEnabled) location = location.replace(/#.+$/, '')
                        queryString = locationOverride
                    } else {
                        location = window.location.pathname.replace(/\/$/, '')
                        if (this._hashEnabled) location += window.location.hash.replace(/^#/, '/')
                        queryString = window.location.search
                    }
                    var matched = this.router.match(location)
                    this._handler = matched.cb
                    this.state.href = location
                    this.state.query = nanoquery(queryString)
                    this.state.route = matched.route
                    this.state.params = matched.params
                    return this.state
                }

                Choo.prototype._prerender = function(state) {
                    var routeTiming = nanotiming("choo.prerender('" + state.route + "')")
                    var res = this._handler(state, this.emit)
                    routeTiming()
                    return res
                }

                Choo.prototype._setCache = function(state) {
                    var cache = new Cache(state, this.emitter.emit.bind(this.emitter), this._cache)
                    state.cache = renderComponent

                    function renderComponent(Component, id) {
                        assert.equal(typeof Component, 'function', 'choo.state.cache: Component should be type function')
                        var args = []
                        for (var i = 0, len = arguments.length; i < len; i++) {
                            args.push(arguments[i])
                        }
                        return cache.render.apply(cache, args)
                    }

                    // When the state gets stringified, make sure `state.cache` isn't
                    // stringified too.
                    renderComponent.toJSON = function() {
                        return null
                    }
                }

            }, {
                "./component/cache": 7,
                "assert": 43,
                "document-ready": 10,
                "nanobus": 44,
                "nanohref": 45,
                "nanomorph": 53,
                "nanoquery": 56,
                "nanoraf": 57,
                "nanorouter": 58,
                "nanotiming": 60,
                "scroll-to-anchor": 65,
                "xtend": 68
            }],
            10: [function(require, module, exports) {
                'use strict'

                module.exports = ready

                function ready(callback) {
                    if (typeof document === 'undefined') {
                        throw new Error('document-ready only runs in the browser')
                    }
                    var state = document.readyState
                    if (state === 'complete' || state === 'interactive') {
                        return setTimeout(callback, 0)
                    }

                    document.addEventListener('DOMContentLoaded', function onLoad() {
                        callback()
                    })
                }

            }, {}],
            11: [function(require, module, exports) {
                module.exports = adjoint;

                /**
                 * Calculates the adjugate of a mat4
                 *
                 * @param {mat4} out the receiving matrix
                 * @param {mat4} a the source matrix
                 * @returns {mat4} out
                 */
                function adjoint(out, a) {
                    var a00 = a[0],
                        a01 = a[1],
                        a02 = a[2],
                        a03 = a[3],
                        a10 = a[4],
                        a11 = a[5],
                        a12 = a[6],
                        a13 = a[7],
                        a20 = a[8],
                        a21 = a[9],
                        a22 = a[10],
                        a23 = a[11],
                        a30 = a[12],
                        a31 = a[13],
                        a32 = a[14],
                        a33 = a[15];

                    out[0] = (a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22));
                    out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));
                    out[2] = (a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12));
                    out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));
                    out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));
                    out[5] = (a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22));
                    out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));
                    out[7] = (a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12));
                    out[8] = (a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21));
                    out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));
                    out[10] = (a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11));
                    out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));
                    out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));
                    out[13] = (a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21));
                    out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));
                    out[15] = (a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11));
                    return out;
                };
            }, {}],
            12: [function(require, module, exports) {
                module.exports = clone;

                /**
                 * Creates a new mat4 initialized with values from an existing matrix
                 *
                 * @param {mat4} a matrix to clone
                 * @returns {mat4} a new 4x4 matrix
                 */
                function clone(a) {
                    var out = new Float32Array(16);
                    out[0] = a[0];
                    out[1] = a[1];
                    out[2] = a[2];
                    out[3] = a[3];
                    out[4] = a[4];
                    out[5] = a[5];
                    out[6] = a[6];
                    out[7] = a[7];
                    out[8] = a[8];
                    out[9] = a[9];
                    out[10] = a[10];
                    out[11] = a[11];
                    out[12] = a[12];
                    out[13] = a[13];
                    out[14] = a[14];
                    out[15] = a[15];
                    return out;
                };
            }, {}],
            13: [function(require, module, exports) {
                module.exports = copy;

                /**
                 * Copy the values from one mat4 to another
                 *
                 * @param {mat4} out the receiving matrix
                 * @param {mat4} a the source matrix
                 * @returns {mat4} out
                 */
                function copy(out, a) {
                    out[0] = a[0];
                    out[1] = a[1];
                    out[2] = a[2];
                    out[3] = a[3];
                    out[4] = a[4];
                    out[5] = a[5];
                    out[6] = a[6];
                    out[7] = a[7];
                    out[8] = a[8];
                    out[9] = a[9];
                    out[10] = a[10];
                    out[11] = a[11];
                    out[12] = a[12];
                    out[13] = a[13];
                    out[14] = a[14];
                    out[15] = a[15];
                    return out;
                };
            }, {}],
            14: [function(require, module, exports) {
                module.exports = create;

                /**
                 * Creates a new identity mat4
                 *
                 * @returns {mat4} a new 4x4 matrix
                 */
                function create() {
                    var out = new Float32Array(16);
                    out[0] = 1;
                    out[1] = 0;
                    out[2] = 0;
                    out[3] = 0;
                    out[4] = 0;
                    out[5] = 1;
                    out[6] = 0;
                    out[7] = 0;
                    out[8] = 0;
                    out[9] = 0;
                    out[10] = 1;
                    out[11] = 0;
                    out[12] = 0;
                    out[13] = 0;
                    out[14] = 0;
                    out[15] = 1;
                    return out;
                };
            }, {}],
            15: [function(require, module, exports) {
                module.exports = determinant;

                /**
                 * Calculates the determinant of a mat4
                 *
                 * @param {mat4} a the source matrix
                 * @returns {Number} determinant of a
                 */
                function determinant(a) {
                    var a00 = a[0],
                        a01 = a[1],
                        a02 = a[2],
                        a03 = a[3],
                        a10 = a[4],
                        a11 = a[5],
                        a12 = a[6],
                        a13 = a[7],
                        a20 = a[8],
                        a21 = a[9],
                        a22 = a[10],
                        a23 = a[11],
                        a30 = a[12],
                        a31 = a[13],
                        a32 = a[14],
                        a33 = a[15],

                        b00 = a00 * a11 - a01 * a10,
                        b01 = a00 * a12 - a02 * a10,
                        b02 = a00 * a13 - a03 * a10,
                        b03 = a01 * a12 - a02 * a11,
                        b04 = a01 * a13 - a03 * a11,
                        b05 = a02 * a13 - a03 * a12,
                        b06 = a20 * a31 - a21 * a30,
                        b07 = a20 * a32 - a22 * a30,
                        b08 = a20 * a33 - a23 * a30,
                        b09 = a21 * a32 - a22 * a31,
                        b10 = a21 * a33 - a23 * a31,
                        b11 = a22 * a33 - a23 * a32;

                    // Calculate the determinant
                    return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;
                };
            }, {}],
            16: [function(require, module, exports) {
                module.exports = fromQuat;

                /**
                 * Creates a matrix from a quaternion rotation.
                 *
                 * @param {mat4} out mat4 receiving operation result
                 * @param {quat4} q Rotation quaternion
                 * @returns {mat4} out
                 */
                function fromQuat(out, q) {
                    var x = q[0],
                        y = q[1],
                        z = q[2],
                        w = q[3],
                        x2 = x + x,
                        y2 = y + y,
                        z2 = z + z,

                        xx = x * x2,
                        yx = y * x2,
                        yy = y * y2,
                        zx = z * x2,
                        zy = z * y2,
                        zz = z * z2,
                        wx = w * x2,
                        wy = w * y2,
                        wz = w * z2;

                    out[0] = 1 - yy - zz;
                    out[1] = yx + wz;
                    out[2] = zx - wy;
                    out[3] = 0;

                    out[4] = yx - wz;
                    out[5] = 1 - xx - zz;
                    out[6] = zy + wx;
                    out[7] = 0;

                    out[8] = zx + wy;
                    out[9] = zy - wx;
                    out[10] = 1 - xx - yy;
                    out[11] = 0;

                    out[12] = 0;
                    out[13] = 0;
                    out[14] = 0;
                    out[15] = 1;

                    return out;
                };
            }, {}],
            17: [function(require, module, exports) {
                module.exports = fromRotation

                /**
                 * Creates a matrix from a given angle around a given axis
                 * This is equivalent to (but much faster than):
                 *
                 *     mat4.identity(dest)
                 *     mat4.rotate(dest, dest, rad, axis)
                 *
                 * @param {mat4} out mat4 receiving operation result
                 * @param {Number} rad the angle to rotate the matrix by
                 * @param {vec3} axis the axis to rotate around
                 * @returns {mat4} out
                 */
                function fromRotation(out, rad, axis) {
                    var s, c, t
                    var x = axis[0]
                    var y = axis[1]
                    var z = axis[2]
                    var len = Math.sqrt(x * x + y * y + z * z)

                    if (Math.abs(len) < 0.000001) {
                        return null
                    }

                    len = 1 / len
                    x *= len
                    y *= len
                    z *= len

                    s = Math.sin(rad)
                    c = Math.cos(rad)
                    t = 1 - c

                    // Perform rotation-specific matrix multiplication
                    out[0] = x * x * t + c
                    out[1] = y * x * t + z * s
                    out[2] = z * x * t - y * s
                    out[3] = 0
                    out[4] = x * y * t - z * s
                    out[5] = y * y * t + c
                    out[6] = z * y * t + x * s
                    out[7] = 0
                    out[8] = x * z * t + y * s
                    out[9] = y * z * t - x * s
                    out[10] = z * z * t + c
                    out[11] = 0
                    out[12] = 0
                    out[13] = 0
                    out[14] = 0
                    out[15] = 1
                    return out
                }

            }, {}],
            18: [function(require, module, exports) {
                module.exports = fromRotationTranslation;

                /**
                 * Creates a matrix from a quaternion rotation and vector translation
                 * This is equivalent to (but much faster than):
                 *
                 *     mat4.identity(dest);
                 *     mat4.translate(dest, vec);
                 *     var quatMat = mat4.create();
                 *     quat4.toMat4(quat, quatMat);
                 *     mat4.multiply(dest, quatMat);
                 *
                 * @param {mat4} out mat4 receiving operation result
                 * @param {quat4} q Rotation quaternion
                 * @param {vec3} v Translation vector
                 * @returns {mat4} out
                 */
                function fromRotationTranslation(out, q, v) {
                    // Quaternion math
                    var x = q[0],
                        y = q[1],
                        z = q[2],
                        w = q[3],
                        x2 = x + x,
                        y2 = y + y,
                        z2 = z + z,

                        xx = x * x2,
                        xy = x * y2,
                        xz = x * z2,
                        yy = y * y2,
                        yz = y * z2,
                        zz = z * z2,
                        wx = w * x2,
                        wy = w * y2,
                        wz = w * z2;

                    out[0] = 1 - (yy + zz);
                    out[1] = xy + wz;
                    out[2] = xz - wy;
                    out[3] = 0;
                    out[4] = xy - wz;
                    out[5] = 1 - (xx + zz);
                    out[6] = yz + wx;
                    out[7] = 0;
                    out[8] = xz + wy;
                    out[9] = yz - wx;
                    out[10] = 1 - (xx + yy);
                    out[11] = 0;
                    out[12] = v[0];
                    out[13] = v[1];
                    out[14] = v[2];
                    out[15] = 1;

                    return out;
                };
            }, {}],
            19: [function(require, module, exports) {
                module.exports = fromScaling

                /**
                 * Creates a matrix from a vector scaling
                 * This is equivalent to (but much faster than):
                 *
                 *     mat4.identity(dest)
                 *     mat4.scale(dest, dest, vec)
                 *
                 * @param {mat4} out mat4 receiving operation result
                 * @param {vec3} v Scaling vector
                 * @returns {mat4} out
                 */
                function fromScaling(out, v) {
                    out[0] = v[0]
                    out[1] = 0
                    out[2] = 0
                    out[3] = 0
                    out[4] = 0
                    out[5] = v[1]
                    out[6] = 0
                    out[7] = 0
                    out[8] = 0
                    out[9] = 0
                    out[10] = v[2]
                    out[11] = 0
                    out[12] = 0
                    out[13] = 0
                    out[14] = 0
                    out[15] = 1
                    return out
                }

            }, {}],
            20: [function(require, module, exports) {
                module.exports = fromTranslation

                /**
                 * Creates a matrix from a vector translation
                 * This is equivalent to (but much faster than):
                 *
                 *     mat4.identity(dest)
                 *     mat4.translate(dest, dest, vec)
                 *
                 * @param {mat4} out mat4 receiving operation result
                 * @param {vec3} v Translation vector
                 * @returns {mat4} out
                 */
                function fromTranslation(out, v) {
                    out[0] = 1
                    out[1] = 0
                    out[2] = 0
                    out[3] = 0
                    out[4] = 0
                    out[5] = 1
                    out[6] = 0
                    out[7] = 0
                    out[8] = 0
                    out[9] = 0
                    out[10] = 1
                    out[11] = 0
                    out[12] = v[0]
                    out[13] = v[1]
                    out[14] = v[2]
                    out[15] = 1
                    return out
                }

            }, {}],
            21: [function(require, module, exports) {
                module.exports = fromXRotation

                /**
                 * Creates a matrix from the given angle around the X axis
                 * This is equivalent to (but much faster than):
                 *
                 *     mat4.identity(dest)
                 *     mat4.rotateX(dest, dest, rad)
                 *
                 * @param {mat4} out mat4 receiving operation result
                 * @param {Number} rad the angle to rotate the matrix by
                 * @returns {mat4} out
                 */
                function fromXRotation(out, rad) {
                    var s = Math.sin(rad),
                        c = Math.cos(rad)

                    // Perform axis-specific matrix multiplication
                    out[0] = 1
                    out[1] = 0
                    out[2] = 0
                    out[3] = 0
                    out[4] = 0
                    out[5] = c
                    out[6] = s
                    out[7] = 0
                    out[8] = 0
                    out[9] = -s
                    out[10] = c
                    out[11] = 0
                    out[12] = 0
                    out[13] = 0
                    out[14] = 0
                    out[15] = 1
                    return out
                }
            }, {}],
            22: [function(require, module, exports) {
                module.exports = fromYRotation

                /**
                 * Creates a matrix from the given angle around the Y axis
                 * This is equivalent to (but much faster than):
                 *
                 *     mat4.identity(dest)
                 *     mat4.rotateY(dest, dest, rad)
                 *
                 * @param {mat4} out mat4 receiving operation result
                 * @param {Number} rad the angle to rotate the matrix by
                 * @returns {mat4} out
                 */
                function fromYRotation(out, rad) {
                    var s = Math.sin(rad),
                        c = Math.cos(rad)

                    // Perform axis-specific matrix multiplication
                    out[0] = c
                    out[1] = 0
                    out[2] = -s
                    out[3] = 0
                    out[4] = 0
                    out[5] = 1
                    out[6] = 0
                    out[7] = 0
                    out[8] = s
                    out[9] = 0
                    out[10] = c
                    out[11] = 0
                    out[12] = 0
                    out[13] = 0
                    out[14] = 0
                    out[15] = 1
                    return out
                }
            }, {}],
            23: [function(require, module, exports) {
                module.exports = fromZRotation

                /**
                 * Creates a matrix from the given angle around the Z axis
                 * This is equivalent to (but much faster than):
                 *
                 *     mat4.identity(dest)
                 *     mat4.rotateZ(dest, dest, rad)
                 *
                 * @param {mat4} out mat4 receiving operation result
                 * @param {Number} rad the angle to rotate the matrix by
                 * @returns {mat4} out
                 */
                function fromZRotation(out, rad) {
                    var s = Math.sin(rad),
                        c = Math.cos(rad)

                    // Perform axis-specific matrix multiplication
                    out[0] = c
                    out[1] = s
                    out[2] = 0
                    out[3] = 0
                    out[4] = -s
                    out[5] = c
                    out[6] = 0
                    out[7] = 0
                    out[8] = 0
                    out[9] = 0
                    out[10] = 1
                    out[11] = 0
                    out[12] = 0
                    out[13] = 0
                    out[14] = 0
                    out[15] = 1
                    return out
                }
            }, {}],
            24: [function(require, module, exports) {
                module.exports = frustum;

                /**
                 * Generates a frustum matrix with the given bounds
                 *
                 * @param {mat4} out mat4 frustum matrix will be written into
                 * @param {Number} left Left bound of the frustum
                 * @param {Number} right Right bound of the frustum
                 * @param {Number} bottom Bottom bound of the frustum
                 * @param {Number} top Top bound of the frustum
                 * @param {Number} near Near bound of the frustum
                 * @param {Number} far Far bound of the frustum
                 * @returns {mat4} out
                 */
                function frustum(out, left, right, bottom, top, near, far) {
                    var rl = 1 / (right - left),
                        tb = 1 / (top - bottom),
                        nf = 1 / (near - far);
                    out[0] = (near * 2) * rl;
                    out[1] = 0;
                    out[2] = 0;
                    out[3] = 0;
                    out[4] = 0;
                    out[5] = (near * 2) * tb;
                    out[6] = 0;
                    out[7] = 0;
                    out[8] = (right + left) * rl;
                    out[9] = (top + bottom) * tb;
                    out[10] = (far + near) * nf;
                    out[11] = -1;
                    out[12] = 0;
                    out[13] = 0;
                    out[14] = (far * near * 2) * nf;
                    out[15] = 0;
                    return out;
                };
            }, {}],
            25: [function(require, module, exports) {
                module.exports = identity;

                /**
                 * Set a mat4 to the identity matrix
                 *
                 * @param {mat4} out the receiving matrix
                 * @returns {mat4} out
                 */
                function identity(out) {
                    out[0] = 1;
                    out[1] = 0;
                    out[2] = 0;
                    out[3] = 0;
                    out[4] = 0;
                    out[5] = 1;
                    out[6] = 0;
                    out[7] = 0;
                    out[8] = 0;
                    out[9] = 0;
                    out[10] = 1;
                    out[11] = 0;
                    out[12] = 0;
                    out[13] = 0;
                    out[14] = 0;
                    out[15] = 1;
                    return out;
                };
            }, {}],
            26: [function(require, module, exports) {
                module.exports = {
                    create: require('./create'),
                    clone: require('./clone'),
                    copy: require('./copy'),
                    identity: require('./identity'),
                    transpose: require('./transpose'),
                    invert: require('./invert'),
                    adjoint: require('./adjoint'),
                    determinant: require('./determinant'),
                    multiply: require('./multiply'),
                    translate: require('./translate'),
                    scale: require('./scale'),
                    rotate: require('./rotate'),
                    rotateX: require('./rotateX'),
                    rotateY: require('./rotateY'),
                    rotateZ: require('./rotateZ'),
                    fromRotation: require('./fromRotation'),
                    fromRotationTranslation: require('./fromRotationTranslation'),
                    fromScaling: require('./fromScaling'),
                    fromTranslation: require('./fromTranslation'),
                    fromXRotation: require('./fromXRotation'),
                    fromYRotation: require('./fromYRotation'),
                    fromZRotation: require('./fromZRotation'),
                    fromQuat: require('./fromQuat'),
                    frustum: require('./frustum'),
                    perspective: require('./perspective'),
                    perspectiveFromFieldOfView: require('./perspectiveFromFieldOfView'),
                    ortho: require('./ortho'),
                    lookAt: require('./lookAt'),
                    str: require('./str')
                }

            }, {
                "./adjoint": 11,
                "./clone": 12,
                "./copy": 13,
                "./create": 14,
                "./determinant": 15,
                "./fromQuat": 16,
                "./fromRotation": 17,
                "./fromRotationTranslation": 18,
                "./fromScaling": 19,
                "./fromTranslation": 20,
                "./fromXRotation": 21,
                "./fromYRotation": 22,
                "./fromZRotation": 23,
                "./frustum": 24,
                "./identity": 25,
                "./invert": 27,
                "./lookAt": 28,
                "./multiply": 29,
                "./ortho": 30,
                "./perspective": 31,
                "./perspectiveFromFieldOfView": 32,
                "./rotate": 33,
                "./rotateX": 34,
                "./rotateY": 35,
                "./rotateZ": 36,
                "./scale": 37,
                "./str": 38,
                "./translate": 39,
                "./transpose": 40
            }],
            27: [function(require, module, exports) {
                module.exports = invert;

                /**
                 * Inverts a mat4
                 *
                 * @param {mat4} out the receiving matrix
                 * @param {mat4} a the source matrix
                 * @returns {mat4} out
                 */
                function invert(out, a) {
                    var a00 = a[0],
                        a01 = a[1],
                        a02 = a[2],
                        a03 = a[3],
                        a10 = a[4],
                        a11 = a[5],
                        a12 = a[6],
                        a13 = a[7],
                        a20 = a[8],
                        a21 = a[9],
                        a22 = a[10],
                        a23 = a[11],
                        a30 = a[12],
                        a31 = a[13],
                        a32 = a[14],
                        a33 = a[15],

                        b00 = a00 * a11 - a01 * a10,
                        b01 = a00 * a12 - a02 * a10,
                        b02 = a00 * a13 - a03 * a10,
                        b03 = a01 * a12 - a02 * a11,
                        b04 = a01 * a13 - a03 * a11,
                        b05 = a02 * a13 - a03 * a12,
                        b06 = a20 * a31 - a21 * a30,
                        b07 = a20 * a32 - a22 * a30,
                        b08 = a20 * a33 - a23 * a30,
                        b09 = a21 * a32 - a22 * a31,
                        b10 = a21 * a33 - a23 * a31,
                        b11 = a22 * a33 - a23 * a32,

                        // Calculate the determinant
                        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;

                    if (!det) {
                        return null;
                    }
                    det = 1.0 / det;

                    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;
                    out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;
                    out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;
                    out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;
                    out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;
                    out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;
                    out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;
                    out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;
                    out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;
                    out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;
                    out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;
                    out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;
                    out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;
                    out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;
                    out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;
                    out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;

                    return out;
                };
            }, {}],
            28: [function(require, module, exports) {
                var identity = require('./identity');

                module.exports = lookAt;

                /**
                 * Generates a look-at matrix with the given eye position, focal point, and up axis
                 *
                 * @param {mat4} out mat4 frustum matrix will be written into
                 * @param {vec3} eye Position of the viewer
                 * @param {vec3} center Point the viewer is looking at
                 * @param {vec3} up vec3 pointing up
                 * @returns {mat4} out
                 */
                function lookAt(out, eye, center, up) {
                    var x0, x1, x2, y0, y1, y2, z0, z1, z2, len,
                        eyex = eye[0],
                        eyey = eye[1],
                        eyez = eye[2],
                        upx = up[0],
                        upy = up[1],
                        upz = up[2],
                        centerx = center[0],
                        centery = center[1],
                        centerz = center[2];

                    if (Math.abs(eyex - centerx) < 0.000001 &&
                        Math.abs(eyey - centery) < 0.000001 &&
                        Math.abs(eyez - centerz) < 0.000001) {
                        return identity(out);
                    }

                    z0 = eyex - centerx;
                    z1 = eyey - centery;
                    z2 = eyez - centerz;

                    len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);
                    z0 *= len;
                    z1 *= len;
                    z2 *= len;

                    x0 = upy * z2 - upz * z1;
                    x1 = upz * z0 - upx * z2;
                    x2 = upx * z1 - upy * z0;
                    len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);
                    if (!len) {
                        x0 = 0;
                        x1 = 0;
                        x2 = 0;
                    } else {
                        len = 1 / len;
                        x0 *= len;
                        x1 *= len;
                        x2 *= len;
                    }

                    y0 = z1 * x2 - z2 * x1;
                    y1 = z2 * x0 - z0 * x2;
                    y2 = z0 * x1 - z1 * x0;

                    len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);
                    if (!len) {
                        y0 = 0;
                        y1 = 0;
                        y2 = 0;
                    } else {
                        len = 1 / len;
                        y0 *= len;
                        y1 *= len;
                        y2 *= len;
                    }

                    out[0] = x0;
                    out[1] = y0;
                    out[2] = z0;
                    out[3] = 0;
                    out[4] = x1;
                    out[5] = y1;
                    out[6] = z1;
                    out[7] = 0;
                    out[8] = x2;
                    out[9] = y2;
                    out[10] = z2;
                    out[11] = 0;
                    out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);
                    out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);
                    out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);
                    out[15] = 1;

                    return out;
                };
            }, {
                "./identity": 25
            }],
            29: [function(require, module, exports) {
                module.exports = multiply;

                /**
                 * Multiplies two mat4's
                 *
                 * @param {mat4} out the receiving matrix
                 * @param {mat4} a the first operand
                 * @param {mat4} b the second operand
                 * @returns {mat4} out
                 */
                function multiply(out, a, b) {
                    var a00 = a[0],
                        a01 = a[1],
                        a02 = a[2],
                        a03 = a[3],
                        a10 = a[4],
                        a11 = a[5],
                        a12 = a[6],
                        a13 = a[7],
                        a20 = a[8],
                        a21 = a[9],
                        a22 = a[10],
                        a23 = a[11],
                        a30 = a[12],
                        a31 = a[13],
                        a32 = a[14],
                        a33 = a[15];

                    // Cache only the current line of the second matrix
                    var b0 = b[0],
                        b1 = b[1],
                        b2 = b[2],
                        b3 = b[3];
                    out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;
                    out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;
                    out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;
                    out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;

                    b0 = b[4];
                    b1 = b[5];
                    b2 = b[6];
                    b3 = b[7];
                    out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;
                    out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;
                    out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;
                    out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;

                    b0 = b[8];
                    b1 = b[9];
                    b2 = b[10];
                    b3 = b[11];
                    out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;
                    out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;
                    out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;
                    out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;

                    b0 = b[12];
                    b1 = b[13];
                    b2 = b[14];
                    b3 = b[15];
                    out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;
                    out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;
                    out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;
                    out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;
                    return out;
                };
            }, {}],
            30: [function(require, module, exports) {
                module.exports = ortho;

                /**
                 * Generates a orthogonal projection matrix with the given bounds
                 *
                 * @param {mat4} out mat4 frustum matrix will be written into
                 * @param {number} left Left bound of the frustum
                 * @param {number} right Right bound of the frustum
                 * @param {number} bottom Bottom bound of the frustum
                 * @param {number} top Top bound of the frustum
                 * @param {number} near Near bound of the frustum
                 * @param {number} far Far bound of the frustum
                 * @returns {mat4} out
                 */
                function ortho(out, left, right, bottom, top, near, far) {
                    var lr = 1 / (left - right),
                        bt = 1 / (bottom - top),
                        nf = 1 / (near - far);
                    out[0] = -2 * lr;
                    out[1] = 0;
                    out[2] = 0;
                    out[3] = 0;
                    out[4] = 0;
                    out[5] = -2 * bt;
                    out[6] = 0;
                    out[7] = 0;
                    out[8] = 0;
                    out[9] = 0;
                    out[10] = 2 * nf;
                    out[11] = 0;
                    out[12] = (left + right) * lr;
                    out[13] = (top + bottom) * bt;
                    out[14] = (far + near) * nf;
                    out[15] = 1;
                    return out;
                };
            }, {}],
            31: [function(require, module, exports) {
                module.exports = perspective;

                /**
                 * Generates a perspective projection matrix with the given bounds
                 *
                 * @param {mat4} out mat4 frustum matrix will be written into
                 * @param {number} fovy Vertical field of view in radians
                 * @param {number} aspect Aspect ratio. typically viewport width/height
                 * @param {number} near Near bound of the frustum
                 * @param {number} far Far bound of the frustum
                 * @returns {mat4} out
                 */
                function perspective(out, fovy, aspect, near, far) {
                    var f = 1.0 / Math.tan(fovy / 2),
                        nf = 1 / (near - far);
                    out[0] = f / aspect;
                    out[1] = 0;
                    out[2] = 0;
                    out[3] = 0;
                    out[4] = 0;
                    out[5] = f;
                    out[6] = 0;
                    out[7] = 0;
                    out[8] = 0;
                    out[9] = 0;
                    out[10] = (far + near) * nf;
                    out[11] = -1;
                    out[12] = 0;
                    out[13] = 0;
                    out[14] = (2 * far * near) * nf;
                    out[15] = 0;
                    return out;
                };
            }, {}],
            32: [function(require, module, exports) {
                module.exports = perspectiveFromFieldOfView;

                /**
                 * Generates a perspective projection matrix with the given field of view.
                 * This is primarily useful for generating projection matrices to be used
                 * with the still experiemental WebVR API.
                 *
                 * @param {mat4} out mat4 frustum matrix will be written into
                 * @param {number} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees
                 * @param {number} near Near bound of the frustum
                 * @param {number} far Far bound of the frustum
                 * @returns {mat4} out
                 */
                function perspectiveFromFieldOfView(out, fov, near, far) {
                    var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0),
                        downTan = Math.tan(fov.downDegrees * Math.PI / 180.0),
                        leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0),
                        rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0),
                        xScale = 2.0 / (leftTan + rightTan),
                        yScale = 2.0 / (upTan + downTan);

                    out[0] = xScale;
                    out[1] = 0.0;
                    out[2] = 0.0;
                    out[3] = 0.0;
                    out[4] = 0.0;
                    out[5] = yScale;
                    out[6] = 0.0;
                    out[7] = 0.0;
                    out[8] = -((leftTan - rightTan) * xScale * 0.5);
                    out[9] = ((upTan - downTan) * yScale * 0.5);
                    out[10] = far / (near - far);
                    out[11] = -1.0;
                    out[12] = 0.0;
                    out[13] = 0.0;
                    out[14] = (far * near) / (near - far);
                    out[15] = 0.0;
                    return out;
                }


            }, {}],
            33: [function(require, module, exports) {
                module.exports = rotate;

                /**
                 * Rotates a mat4 by the given angle
                 *
                 * @param {mat4} out the receiving matrix
                 * @param {mat4} a the matrix to rotate
                 * @param {Number} rad the angle to rotate the matrix by
                 * @param {vec3} axis the axis to rotate around
                 * @returns {mat4} out
                 */
                function rotate(out, a, rad, axis) {
                    var x = axis[0],
                        y = axis[1],
                        z = axis[2],
                        len = Math.sqrt(x * x + y * y + z * z),
                        s, c, t,
                        a00, a01, a02, a03,
                        a10, a11, a12, a13,
                        a20, a21, a22, a23,
                        b00, b01, b02,
                        b10, b11, b12,
                        b20, b21, b22;

                    if (Math.abs(len) < 0.000001) {
                        return null;
                    }

                    len = 1 / len;
                    x *= len;
                    y *= len;
                    z *= len;

                    s = Math.sin(rad);
                    c = Math.cos(rad);
                    t = 1 - c;

                    a00 = a[0];
                    a01 = a[1];
                    a02 = a[2];
                    a03 = a[3];
                    a10 = a[4];
                    a11 = a[5];
                    a12 = a[6];
                    a13 = a[7];
                    a20 = a[8];
                    a21 = a[9];
                    a22 = a[10];
                    a23 = a[11];

                    // Construct the elements of the rotation matrix
                    b00 = x * x * t + c;
                    b01 = y * x * t + z * s;
                    b02 = z * x * t - y * s;
                    b10 = x * y * t - z * s;
                    b11 = y * y * t + c;
                    b12 = z * y * t + x * s;
                    b20 = x * z * t + y * s;
                    b21 = y * z * t - x * s;
                    b22 = z * z * t + c;

                    // Perform rotation-specific matrix multiplication
                    out[0] = a00 * b00 + a10 * b01 + a20 * b02;
                    out[1] = a01 * b00 + a11 * b01 + a21 * b02;
                    out[2] = a02 * b00 + a12 * b01 + a22 * b02;
                    out[3] = a03 * b00 + a13 * b01 + a23 * b02;
                    out[4] = a00 * b10 + a10 * b11 + a20 * b12;
                    out[5] = a01 * b10 + a11 * b11 + a21 * b12;
                    out[6] = a02 * b10 + a12 * b11 + a22 * b12;
                    out[7] = a03 * b10 + a13 * b11 + a23 * b12;
                    out[8] = a00 * b20 + a10 * b21 + a20 * b22;
                    out[9] = a01 * b20 + a11 * b21 + a21 * b22;
                    out[10] = a02 * b20 + a12 * b21 + a22 * b22;
                    out[11] = a03 * b20 + a13 * b21 + a23 * b22;

                    if (a !== out) { // If the source and destination differ, copy the unchanged last row
                        out[12] = a[12];
                        out[13] = a[13];
                        out[14] = a[14];
                        out[15] = a[15];
                    }
                    return out;
                };
            }, {}],
            34: [function(require, module, exports) {
                module.exports = rotateX;

                /**
                 * Rotates a matrix by the given angle around the X axis
                 *
                 * @param {mat4} out the receiving matrix
                 * @param {mat4} a the matrix to rotate
                 * @param {Number} rad the angle to rotate the matrix by
                 * @returns {mat4} out
                 */
                function rotateX(out, a, rad) {
                    var s = Math.sin(rad),
                        c = Math.cos(rad),
                        a10 = a[4],
                        a11 = a[5],
                        a12 = a[6],
                        a13 = a[7],
                        a20 = a[8],
                        a21 = a[9],
                        a22 = a[10],
                        a23 = a[11];

                    if (a !== out) { // If the source and destination differ, copy the unchanged rows
                        out[0] = a[0];
                        out[1] = a[1];
                        out[2] = a[2];
                        out[3] = a[3];
                        out[12] = a[12];
                        out[13] = a[13];
                        out[14] = a[14];
                        out[15] = a[15];
                    }

                    // Perform axis-specific matrix multiplication
                    out[4] = a10 * c + a20 * s;
                    out[5] = a11 * c + a21 * s;
                    out[6] = a12 * c + a22 * s;
                    out[7] = a13 * c + a23 * s;
                    out[8] = a20 * c - a10 * s;
                    out[9] = a21 * c - a11 * s;
                    out[10] = a22 * c - a12 * s;
                    out[11] = a23 * c - a13 * s;
                    return out;
                };
            }, {}],
            35: [function(require, module, exports) {
                module.exports = rotateY;

                /**
                 * Rotates a matrix by the given angle around the Y axis
                 *
                 * @param {mat4} out the receiving matrix
                 * @param {mat4} a the matrix to rotate
                 * @param {Number} rad the angle to rotate the matrix by
                 * @returns {mat4} out
                 */
                function rotateY(out, a, rad) {
                    var s = Math.sin(rad),
                        c = Math.cos(rad),
                        a00 = a[0],
                        a01 = a[1],
                        a02 = a[2],
                        a03 = a[3],
                        a20 = a[8],
                        a21 = a[9],
                        a22 = a[10],
                        a23 = a[11];

                    if (a !== out) { // If the source and destination differ, copy the unchanged rows
                        out[4] = a[4];
                        out[5] = a[5];
                        out[6] = a[6];
                        out[7] = a[7];
                        out[12] = a[12];
                        out[13] = a[13];
                        out[14] = a[14];
                        out[15] = a[15];
                    }

                    // Perform axis-specific matrix multiplication
                    out[0] = a00 * c - a20 * s;
                    out[1] = a01 * c - a21 * s;
                    out[2] = a02 * c - a22 * s;
                    out[3] = a03 * c - a23 * s;
                    out[8] = a00 * s + a20 * c;
                    out[9] = a01 * s + a21 * c;
                    out[10] = a02 * s + a22 * c;
                    out[11] = a03 * s + a23 * c;
                    return out;
                };
            }, {}],
            36: [function(require, module, exports) {
                module.exports = rotateZ;

                /**
                 * Rotates a matrix by the given angle around the Z axis
                 *
                 * @param {mat4} out the receiving matrix
                 * @param {mat4} a the matrix to rotate
                 * @param {Number} rad the angle to rotate the matrix by
                 * @returns {mat4} out
                 */
                function rotateZ(out, a, rad) {
                    var s = Math.sin(rad),
                        c = Math.cos(rad),
                        a00 = a[0],
                        a01 = a[1],
                        a02 = a[2],
                        a03 = a[3],
                        a10 = a[4],
                        a11 = a[5],
                        a12 = a[6],
                        a13 = a[7];

                    if (a !== out) { // If the source and destination differ, copy the unchanged last row
                        out[8] = a[8];
                        out[9] = a[9];
                        out[10] = a[10];
                        out[11] = a[11];
                        out[12] = a[12];
                        out[13] = a[13];
                        out[14] = a[14];
                        out[15] = a[15];
                    }

                    // Perform axis-specific matrix multiplication
                    out[0] = a00 * c + a10 * s;
                    out[1] = a01 * c + a11 * s;
                    out[2] = a02 * c + a12 * s;
                    out[3] = a03 * c + a13 * s;
                    out[4] = a10 * c - a00 * s;
                    out[5] = a11 * c - a01 * s;
                    out[6] = a12 * c - a02 * s;
                    out[7] = a13 * c - a03 * s;
                    return out;
                };
            }, {}],
            37: [function(require, module, exports) {
                module.exports = scale;

                /**
                 * Scales the mat4 by the dimensions in the given vec3
                 *
                 * @param {mat4} out the receiving matrix
                 * @param {mat4} a the matrix to scale
                 * @param {vec3} v the vec3 to scale the matrix by
                 * @returns {mat4} out
                 **/
                function scale(out, a, v) {
                    var x = v[0],
                        y = v[1],
                        z = v[2];

                    out[0] = a[0] * x;
                    out[1] = a[1] * x;
                    out[2] = a[2] * x;
                    out[3] = a[3] * x;
                    out[4] = a[4] * y;
                    out[5] = a[5] * y;
                    out[6] = a[6] * y;
                    out[7] = a[7] * y;
                    out[8] = a[8] * z;
                    out[9] = a[9] * z;
                    out[10] = a[10] * z;
                    out[11] = a[11] * z;
                    out[12] = a[12];
                    out[13] = a[13];
                    out[14] = a[14];
                    out[15] = a[15];
                    return out;
                };
            }, {}],
            38: [function(require, module, exports) {
                module.exports = str;

                /**
                 * Returns a string representation of a mat4
                 *
                 * @param {mat4} mat matrix to represent as a string
                 * @returns {String} string representation of the matrix
                 */
                function str(a) {
                    return 'mat4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' +
                        a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' +
                        a[8] + ', ' + a[9] + ', ' + a[10] + ', ' + a[11] + ', ' +
                        a[12] + ', ' + a[13] + ', ' + a[14] + ', ' + a[15] + ')';
                };
            }, {}],
            39: [function(require, module, exports) {
                module.exports = translate;

                /**
                 * Translate a mat4 by the given vector
                 *
                 * @param {mat4} out the receiving matrix
                 * @param {mat4} a the matrix to translate
                 * @param {vec3} v vector to translate by
                 * @returns {mat4} out
                 */
                function translate(out, a, v) {
                    var x = v[0],
                        y = v[1],
                        z = v[2],
                        a00, a01, a02, a03,
                        a10, a11, a12, a13,
                        a20, a21, a22, a23;

                    if (a === out) {
                        out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];
                        out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];
                        out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];
                        out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];
                    } else {
                        a00 = a[0];
                        a01 = a[1];
                        a02 = a[2];
                        a03 = a[3];
                        a10 = a[4];
                        a11 = a[5];
                        a12 = a[6];
                        a13 = a[7];
                        a20 = a[8];
                        a21 = a[9];
                        a22 = a[10];
                        a23 = a[11];

                        out[0] = a00;
                        out[1] = a01;
                        out[2] = a02;
                        out[3] = a03;
                        out[4] = a10;
                        out[5] = a11;
                        out[6] = a12;
                        out[7] = a13;
                        out[8] = a20;
                        out[9] = a21;
                        out[10] = a22;
                        out[11] = a23;

                        out[12] = a00 * x + a10 * y + a20 * z + a[12];
                        out[13] = a01 * x + a11 * y + a21 * z + a[13];
                        out[14] = a02 * x + a12 * y + a22 * z + a[14];
                        out[15] = a03 * x + a13 * y + a23 * z + a[15];
                    }

                    return out;
                };
            }, {}],
            40: [function(require, module, exports) {
                module.exports = transpose;

                /**
                 * Transpose the values of a mat4
                 *
                 * @param {mat4} out the receiving matrix
                 * @param {mat4} a the source matrix
                 * @returns {mat4} out
                 */
                function transpose(out, a) {
                    // If we are transposing ourselves we can skip a few steps but have to cache some values
                    if (out === a) {
                        var a01 = a[1],
                            a02 = a[2],
                            a03 = a[3],
                            a12 = a[6],
                            a13 = a[7],
                            a23 = a[11];

                        out[1] = a[4];
                        out[2] = a[8];
                        out[3] = a[12];
                        out[4] = a01;
                        out[6] = a[9];
                        out[7] = a[13];
                        out[8] = a02;
                        out[9] = a12;
                        out[11] = a[14];
                        out[12] = a03;
                        out[13] = a13;
                        out[14] = a23;
                    } else {
                        out[0] = a[0];
                        out[1] = a[4];
                        out[2] = a[8];
                        out[3] = a[12];
                        out[4] = a[1];
                        out[5] = a[5];
                        out[6] = a[9];
                        out[7] = a[13];
                        out[8] = a[2];
                        out[9] = a[6];
                        out[10] = a[10];
                        out[11] = a[14];
                        out[12] = a[3];
                        out[13] = a[7];
                        out[14] = a[11];
                        out[15] = a[15];
                    }

                    return out;
                };
            }, {}],
            41: [function(require, module, exports) {
                module.exports = attributeToProperty

                var transform = {
                    'class': 'className',
                    'for': 'htmlFor',
                    'http-equiv': 'httpEquiv'
                }

                function attributeToProperty(h) {
                    return function(tagName, attrs, children) {
                        for (var attr in attrs) {
                            if (attr in transform) {
                                attrs[transform[attr]] = attrs[attr]
                                delete attrs[attr]
                            }
                        }
                        return h(tagName, attrs, children)
                    }
                }

            }, {}],
            42: [function(require, module, exports) {
                var attrToProp = require('hyperscript-attribute-to-property')

                var VAR = 0,
                    TEXT = 1,
                    OPEN = 2,
                    CLOSE = 3,
                    ATTR = 4
                var ATTR_KEY = 5,
                    ATTR_KEY_W = 6
                var ATTR_VALUE_W = 7,
                    ATTR_VALUE = 8
                var ATTR_VALUE_SQ = 9,
                    ATTR_VALUE_DQ = 10
                var ATTR_EQ = 11,
                    ATTR_BREAK = 12
                var COMMENT = 13

                module.exports = function(h, opts) {
                    if (!opts) opts = {}
                    var concat = opts.concat || function(a, b) {
                        return String(a) + String(b)
                    }
                    if (opts.attrToProp !== false) {
                        h = attrToProp(h)
                    }

                    return function(strings) {
                        var state = TEXT,
                            reg = ''
                        var arglen = arguments.length
                        var parts = []

                        for (var i = 0; i < strings.length; i++) {
                            if (i < arglen - 1) {
                                var arg = arguments[i + 1]
                                var p = parse(strings[i])
                                var xstate = state
                                if (xstate === ATTR_VALUE_DQ) xstate = ATTR_VALUE
                                if (xstate === ATTR_VALUE_SQ) xstate = ATTR_VALUE
                                if (xstate === ATTR_VALUE_W) xstate = ATTR_VALUE
                                if (xstate === ATTR) xstate = ATTR_KEY
                                if (xstate === OPEN) {
                                    if (reg === '/') {
                                        p.push([OPEN, '/', arg])
                                        reg = ''
                                    } else {
                                        p.push([OPEN, arg])
                                    }
                                } else if (xstate === COMMENT && opts.comments) {
                                    reg += String(arg)
                                } else if (xstate !== COMMENT) {
                                    p.push([VAR, xstate, arg])
                                }
                                parts.push.apply(parts, p)
                            } else parts.push.apply(parts, parse(strings[i]))
                        }

                        var tree = [null, {},
                            []
                        ]
                        var stack = [
                            [tree, -1]
                        ]
                        for (var i = 0; i < parts.length; i++) {
                            var cur = stack[stack.length - 1][0]
                            var p = parts[i],
                                s = p[0]
                            if (s === OPEN && /^\//.test(p[1])) {
                                var ix = stack[stack.length - 1][1]
                                if (stack.length > 1) {
                                    stack.pop()
                                    stack[stack.length - 1][0][2][ix] = h(
                                        cur[0], cur[1], cur[2].length ? cur[2] : undefined
                                    )
                                }
                            } else if (s === OPEN) {
                                var c = [p[1], {},
                                    []
                                ]
                                cur[2].push(c)
                                stack.push([c, cur[2].length - 1])
                            } else if (s === ATTR_KEY || (s === VAR && p[1] === ATTR_KEY)) {
                                var key = ''
                                var copyKey
                                for (; i < parts.length; i++) {
                                    if (parts[i][0] === ATTR_KEY) {
                                        key = concat(key, parts[i][1])
                                    } else if (parts[i][0] === VAR && parts[i][1] === ATTR_KEY) {
                                        if (typeof parts[i][2] === 'object' && !key) {
                                            for (copyKey in parts[i][2]) {
                                                if (parts[i][2].hasOwnProperty(copyKey) && !cur[1][copyKey]) {
                                                    cur[1][copyKey] = parts[i][2][copyKey]
                                                }
                                            }
                                        } else {
                                            key = concat(key, parts[i][2])
                                        }
                                    } else break
                                }
                                if (parts[i][0] === ATTR_EQ) i++
                                    var j = i
                                for (; i < parts.length; i++) {
                                    if (parts[i][0] === ATTR_VALUE || parts[i][0] === ATTR_KEY) {
                                        if (!cur[1][key]) cur[1][key] = strfn(parts[i][1])
                                        else parts[i][1] === "" || (cur[1][key] = concat(cur[1][key], parts[i][1]));
                                    } else if (parts[i][0] === VAR &&
                                        (parts[i][1] === ATTR_VALUE || parts[i][1] === ATTR_KEY)) {
                                        if (!cur[1][key]) cur[1][key] = strfn(parts[i][2])
                                        else parts[i][2] === "" || (cur[1][key] = concat(cur[1][key], parts[i][2]));
                                    } else {
                                        if (key.length && !cur[1][key] && i === j &&
                                            (parts[i][0] === CLOSE || parts[i][0] === ATTR_BREAK)) {
                                            // https://html.spec.whatwg.org/multipage/infrastructure.html#boolean-attributes
                                            // empty string is falsy, not well behaved value in browser
                                            cur[1][key] = key.toLowerCase()
                                        }
                                        if (parts[i][0] === CLOSE) {
                                            i--
                                        }
                                        break
                                    }
                                }
                            } else if (s === ATTR_KEY) {
                                cur[1][p[1]] = true
                            } else if (s === VAR && p[1] === ATTR_KEY) {
                                cur[1][p[2]] = true
                            } else if (s === CLOSE) {
                                if (selfClosing(cur[0]) && stack.length) {
                                    var ix = stack[stack.length - 1][1]
                                    stack.pop()
                                    stack[stack.length - 1][0][2][ix] = h(
                                        cur[0], cur[1], cur[2].length ? cur[2] : undefined
                                    )
                                }
                            } else if (s === VAR && p[1] === TEXT) {
                                if (p[2] === undefined || p[2] === null) p[2] = ''
                                else if (!p[2]) p[2] = concat('', p[2])
                                if (Array.isArray(p[2][0])) {
                                    cur[2].push.apply(cur[2], p[2])
                                } else {
                                    cur[2].push(p[2])
                                }
                            } else if (s === TEXT) {
                                cur[2].push(p[1])
                            } else if (s === ATTR_EQ || s === ATTR_BREAK) {
                                // no-op
                            } else {
                                throw new Error('unhandled: ' + s)
                            }
                        }

                        if (tree[2].length > 1 && /^\s*$/.test(tree[2][0])) {
                            tree[2].shift()
                        }

                        if (tree[2].length > 2 ||
                            (tree[2].length === 2 && /\S/.test(tree[2][1]))) {
                            if (opts.createFragment) return opts.createFragment(tree[2])
                            throw new Error(
                                'multiple root elements must be wrapped in an enclosing tag'
                            )
                        }
                        if (Array.isArray(tree[2][0]) && typeof tree[2][0][0] === 'string' &&
                            Array.isArray(tree[2][0][2])) {
                            tree[2][0] = h(tree[2][0][0], tree[2][0][1], tree[2][0][2])
                        }
                        return tree[2][0]

                        function parse(str) {
                            var res = []
                            if (state === ATTR_VALUE_W) state = ATTR
                            for (var i = 0; i < str.length; i++) {
                                var c = str.charAt(i)
                                if (state === TEXT && c === '<') {
                                    if (reg.length) res.push([TEXT, reg])
                                    reg = ''
                                    state = OPEN
                                } else if (c === '>' && !quot(state) && state !== COMMENT) {
                                    if (state === OPEN && reg.length) {
                                        res.push([OPEN, reg])
                                    } else if (state === ATTR_KEY) {
                                        res.push([ATTR_KEY, reg])
                                    } else if (state === ATTR_VALUE && reg.length) {
                                        res.push([ATTR_VALUE, reg])
                                    }
                                    res.push([CLOSE])
                                    reg = ''
                                    state = TEXT
                                } else if (state === COMMENT && /-$/.test(reg) && c === '-') {
                                    if (opts.comments) {
                                        res.push([ATTR_VALUE, reg.substr(0, reg.length - 1)])
                                    }
                                    reg = ''
                                    state = TEXT
                                } else if (state === OPEN && /^!--$/.test(reg)) {
                                    if (opts.comments) {
                                        res.push([OPEN, reg], [ATTR_KEY, 'comment'], [ATTR_EQ])
                                    }
                                    reg = c
                                    state = COMMENT
                                } else if (state === TEXT || state === COMMENT) {
                                    reg += c
                                } else if (state === OPEN && c === '/' && reg.length) {
                                    // no-op, self closing tag without a space <br/>
                                } else if (state === OPEN && /\s/.test(c)) {
                                    if (reg.length) {
                                        res.push([OPEN, reg])
                                    }
                                    reg = ''
                                    state = ATTR
                                } else if (state === OPEN) {
                                    reg += c
                                } else if (state === ATTR && /[^\s"'=/]/.test(c)) {
                                    state = ATTR_KEY
                                    reg = c
                                } else if (state === ATTR && /\s/.test(c)) {
                                    if (reg.length) res.push([ATTR_KEY, reg])
                                    res.push([ATTR_BREAK])
                                } else if (state === ATTR_KEY && /\s/.test(c)) {
                                    res.push([ATTR_KEY, reg])
                                    reg = ''
                                    state = ATTR_KEY_W
                                } else if (state === ATTR_KEY && c === '=') {
                                    res.push([ATTR_KEY, reg], [ATTR_EQ])
                                    reg = ''
                                    state = ATTR_VALUE_W
                                } else if (state === ATTR_KEY) {
                                    reg += c
                                } else if ((state === ATTR_KEY_W || state === ATTR) && c === '=') {
                                    res.push([ATTR_EQ])
                                    state = ATTR_VALUE_W
                                } else if ((state === ATTR_KEY_W || state === ATTR) && !/\s/.test(c)) {
                                    res.push([ATTR_BREAK])
                                    if (/[\w-]/.test(c)) {
                                        reg += c
                                        state = ATTR_KEY
                                    } else state = ATTR
                                } else if (state === ATTR_VALUE_W && c === '"') {
                                    state = ATTR_VALUE_DQ
                                } else if (state === ATTR_VALUE_W && c === "'") {
                                    state = ATTR_VALUE_SQ
                                } else if (state === ATTR_VALUE_DQ && c === '"') {
                                    res.push([ATTR_VALUE, reg], [ATTR_BREAK])
                                    reg = ''
                                    state = ATTR
                                } else if (state === ATTR_VALUE_SQ && c === "'") {
                                    res.push([ATTR_VALUE, reg], [ATTR_BREAK])
                                    reg = ''
                                    state = ATTR
                                } else if (state === ATTR_VALUE_W && !/\s/.test(c)) {
                                    state = ATTR_VALUE
                                    i--
                                } else if (state === ATTR_VALUE && /\s/.test(c)) {
                                    res.push([ATTR_VALUE, reg], [ATTR_BREAK])
                                    reg = ''
                                    state = ATTR
                                } else if (state === ATTR_VALUE || state === ATTR_VALUE_SQ ||
                                    state === ATTR_VALUE_DQ) {
                                    reg += c
                                }
                            }
                            if (state === TEXT && reg.length) {
                                res.push([TEXT, reg])
                                reg = ''
                            } else if (state === ATTR_VALUE && reg.length) {
                                res.push([ATTR_VALUE, reg])
                                reg = ''
                            } else if (state === ATTR_VALUE_DQ && reg.length) {
                                res.push([ATTR_VALUE, reg])
                                reg = ''
                            } else if (state === ATTR_VALUE_SQ && reg.length) {
                                res.push([ATTR_VALUE, reg])
                                reg = ''
                            } else if (state === ATTR_KEY) {
                                res.push([ATTR_KEY, reg])
                                reg = ''
                            }
                            return res
                        }
                    }

                    function strfn(x) {
                        if (typeof x === 'function') return x
                        else if (typeof x === 'string') return x
                        else if (x && typeof x === 'object') return x
                        else if (x === null || x === undefined) return x
                        else return concat('', x)
                    }
                }

                function quot(state) {
                    return state === ATTR_VALUE_SQ || state === ATTR_VALUE_DQ
                }

                var closeRE = RegExp('^(' + [
                    'area', 'base', 'basefont', 'bgsound', 'br', 'col', 'command', 'embed',
                    'frame', 'hr', 'img', 'input', 'isindex', 'keygen', 'link', 'meta', 'param',
                    'source', 'track', 'wbr', '!--',
                    // SVG TAGS
                    'animate', 'animateTransform', 'circle', 'cursor', 'desc', 'ellipse',
                    'feBlend', 'feColorMatrix', 'feComposite',
                    'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap',
                    'feDistantLight', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR',
                    'feGaussianBlur', 'feImage', 'feMergeNode', 'feMorphology',
                    'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile',
                    'feTurbulence', 'font-face-format', 'font-face-name', 'font-face-uri',
                    'glyph', 'glyphRef', 'hkern', 'image', 'line', 'missing-glyph', 'mpath',
                    'path', 'polygon', 'polyline', 'rect', 'set', 'stop', 'tref', 'use', 'view',
                    'vkern'
                ].join('|') + ')(?:[\.#][a-zA-Z0-9\u007F-\uFFFF_:-]+)*$')

                function selfClosing(tag) {
                    return closeRE.test(tag)
                }

            }, {
                "hyperscript-attribute-to-property": 41
            }],
            43: [function(require, module, exports) {
                assert.notEqual = notEqual
                assert.notOk = notOk
                assert.equal = equal
                assert.ok = assert

                module.exports = assert

                function equal(a, b, m) {
                    assert(a == b, m) // eslint-disable-line eqeqeq
                }

                function notEqual(a, b, m) {
                    assert(a != b, m) // eslint-disable-line eqeqeq
                }

                function notOk(t, m) {
                    assert(!t, m)
                }

                function assert(t, m) {
                    if (!t) throw new Error(m || 'AssertionError')
                }

            }, {}],
            44: [function(require, module, exports) {
                var splice = require('remove-array-items')
                var nanotiming = require('nanotiming')
                var assert = require('assert')

                module.exports = Nanobus

                function Nanobus(name) {
                    if (!(this instanceof Nanobus)) return new Nanobus(name)

                    this._name = name || 'nanobus'
                    this._starListeners = []
                    this._listeners = {}
                }

                Nanobus.prototype.emit = function(eventName) {
                    assert.ok(typeof eventName === 'string' || typeof eventName === 'symbol', 'nanobus.emit: eventName should be type string or symbol')

                    var data = []
                    for (var i = 1, len = arguments.length; i < len; i++) {
                        data.push(arguments[i])
                    }

                    var emitTiming = nanotiming(this._name + "('" + eventName.toString() + "')")
                    var listeners = this._listeners[eventName]
                    if (listeners && listeners.length > 0) {
                        this._emit(this._listeners[eventName], data)
                    }

                    if (this._starListeners.length > 0) {
                        this._emit(this._starListeners, eventName, data, emitTiming.uuid)
                    }
                    emitTiming()

                    return this
                }

                Nanobus.prototype.on = Nanobus.prototype.addListener = function(eventName, listener) {
                    assert.ok(typeof eventName === 'string' || typeof eventName === 'symbol', 'nanobus.on: eventName should be type string or symbol')
                    assert.equal(typeof listener, 'function', 'nanobus.on: listener should be type function')

                    if (eventName === '*') {
                        this._starListeners.push(listener)
                    } else {
                        if (!this._listeners[eventName]) this._listeners[eventName] = []
                        this._listeners[eventName].push(listener)
                    }
                    return this
                }

                Nanobus.prototype.prependListener = function(eventName, listener) {
                    assert.ok(typeof eventName === 'string' || typeof eventName === 'symbol', 'nanobus.prependListener: eventName should be type string or symbol')
                    assert.equal(typeof listener, 'function', 'nanobus.prependListener: listener should be type function')

                    if (eventName === '*') {
                        this._starListeners.unshift(listener)
                    } else {
                        if (!this._listeners[eventName]) this._listeners[eventName] = []
                        this._listeners[eventName].unshift(listener)
                    }
                    return this
                }

                Nanobus.prototype.once = function(eventName, listener) {
                    assert.ok(typeof eventName === 'string' || typeof eventName === 'symbol', 'nanobus.once: eventName should be type string or symbol')
                    assert.equal(typeof listener, 'function', 'nanobus.once: listener should be type function')

                    var self = this
                    this.on(eventName, once)

                    function once() {
                        listener.apply(self, arguments)
                        self.removeListener(eventName, once)
                    }
                    return this
                }

                Nanobus.prototype.prependOnceListener = function(eventName, listener) {
                    assert.ok(typeof eventName === 'string' || typeof eventName === 'symbol', 'nanobus.prependOnceListener: eventName should be type string or symbol')
                    assert.equal(typeof listener, 'function', 'nanobus.prependOnceListener: listener should be type function')

                    var self = this
                    this.prependListener(eventName, once)

                    function once() {
                        listener.apply(self, arguments)
                        self.removeListener(eventName, once)
                    }
                    return this
                }

                Nanobus.prototype.removeListener = function(eventName, listener) {
                    assert.ok(typeof eventName === 'string' || typeof eventName === 'symbol', 'nanobus.removeListener: eventName should be type string or symbol')
                    assert.equal(typeof listener, 'function', 'nanobus.removeListener: listener should be type function')

                    if (eventName === '*') {
                        this._starListeners = this._starListeners.slice()
                        return remove(this._starListeners, listener)
                    } else {
                        if (typeof this._listeners[eventName] !== 'undefined') {
                            this._listeners[eventName] = this._listeners[eventName].slice()
                        }

                        return remove(this._listeners[eventName], listener)
                    }

                    function remove(arr, listener) {
                        if (!arr) return
                        var index = arr.indexOf(listener)
                        if (index !== -1) {
                            splice(arr, index, 1)
                            return true
                        }
                    }
                }

                Nanobus.prototype.removeAllListeners = function(eventName) {
                    if (eventName) {
                        if (eventName === '*') {
                            this._starListeners = []
                        } else {
                            this._listeners[eventName] = []
                        }
                    } else {
                        this._starListeners = []
                        this._listeners = {}
                    }
                    return this
                }

                Nanobus.prototype.listeners = function(eventName) {
                    var listeners = eventName !== '*' ?
                        this._listeners[eventName] :
                        this._starListeners

                    var ret = []
                    if (listeners) {
                        var ilength = listeners.length
                        for (var i = 0; i < ilength; i++) ret.push(listeners[i])
                    }
                    return ret
                }

                Nanobus.prototype._emit = function(arr, eventName, data, uuid) {
                    if (typeof arr === 'undefined') return
                    if (arr.length === 0) return
                    if (data === undefined) {
                        data = eventName
                        eventName = null
                    }

                    if (eventName) {
                        if (uuid !== undefined) {
                            data = [eventName].concat(data, uuid)
                        } else {
                            data = [eventName].concat(data)
                        }
                    }

                    var length = arr.length
                    for (var i = 0; i < length; i++) {
                        var listener = arr[i]
                        listener.apply(listener, data)
                    }
                }

            }, {
                "assert": 43,
                "nanotiming": 60,
                "remove-array-items": 64
            }],
            45: [function(require, module, exports) {
                var assert = require('assert')

                var safeExternalLink = /(noopener|noreferrer) (noopener|noreferrer)/
                var protocolLink = /^[\w-_]+:/

                module.exports = href

                function href(cb, root) {
                    assert.notEqual(typeof window, 'undefined', 'nanohref: expected window to exist')

                    root = root || window.document

                    assert.equal(typeof cb, 'function', 'nanohref: cb should be type function')
                    assert.equal(typeof root, 'object', 'nanohref: root should be type object')

                    window.addEventListener('click', function(e) {
                        if ((e.button && e.button !== 0) ||
                            e.ctrlKey || e.metaKey || e.altKey || e.shiftKey ||
                            e.defaultPrevented) return

                        var anchor = (function traverse(node) {
                            if (!node || node === root) return
                            if (node.localName !== 'a' || node.href === undefined) {
                                return traverse(node.parentNode)
                            }
                            return node
                        })(e.target)

                        if (!anchor) return

                        if (window.location.protocol !== anchor.protocol ||
                            window.location.hostname !== anchor.hostname ||
                            window.location.port !== anchor.port ||
                            anchor.hasAttribute('data-nanohref-ignore') ||
                            anchor.hasAttribute('download') ||
                            (anchor.getAttribute('target') === '_blank' &&
                                safeExternalLink.test(anchor.getAttribute('rel'))) ||
                            protocolLink.test(anchor.getAttribute('href'))) return

                        e.preventDefault()
                        cb(anchor)
                    })
                }

            }, {
                "assert": 43
            }],
            46: [function(require, module, exports) {
                'use strict'

                var trailingNewlineRegex = /\n[\s]+$/
                var leadingNewlineRegex = /^\n[\s]+/
                var trailingSpaceRegex = /[\s]+$/
                var leadingSpaceRegex = /^[\s]+/
                var multiSpaceRegex = /[\n\s]+/g

                var TEXT_TAGS = [
                    'a', 'abbr', 'b', 'bdi', 'bdo', 'br', 'cite', 'data', 'dfn', 'em', 'i',
                    'kbd', 'mark', 'q', 'rp', 'rt', 'rtc', 'ruby', 's', 'amp', 'small', 'span',
                    'strong', 'sub', 'sup', 'time', 'u', 'var', 'wbr'
                ]

                var VERBATIM_TAGS = [
                    'code', 'pre', 'textarea'
                ]

                module.exports = function appendChild(el, childs) {
                    if (!Array.isArray(childs)) return

                    var nodeName = el.nodeName.toLowerCase()

                    var hadText = false
                    var value, leader

                    for (var i = 0, len = childs.length; i < len; i++) {
                        var node = childs[i]
                        if (Array.isArray(node)) {
                            appendChild(el, node)
                            continue
                        }

                        if (typeof node === 'number' ||
                            typeof node === 'boolean' ||
                            typeof node === 'function' ||
                            node instanceof Date ||
                            node instanceof RegExp) {
                            node = node.toString()
                        }

                        var lastChild = el.childNodes[el.childNodes.length - 1]

                        // Iterate over text nodes
                        if (typeof node === 'string') {
                            hadText = true

                            // If we already had text, append to the existing text
                            if (lastChild && lastChild.nodeName === '#text') {
                                lastChild.nodeValue += node

                                // We didn't have a text node yet, create one
                            } else {
                                node = el.ownerDocument.createTextNode(node)
                                el.appendChild(node)
                                lastChild = node
                            }

                            // If this is the last of the child nodes, make sure we close it out
                            // right
                            if (i === len - 1) {
                                hadText = false
                                    // Trim the child text nodes if the current node isn't a
                                    // node where whitespace matters.
                                if (TEXT_TAGS.indexOf(nodeName) === -1 &&
                                    VERBATIM_TAGS.indexOf(nodeName) === -1) {
                                    value = lastChild.nodeValue
                                        .replace(leadingNewlineRegex, '')
                                        .replace(trailingSpaceRegex, '')
                                        .replace(trailingNewlineRegex, '')
                                        .replace(multiSpaceRegex, ' ')
                                    if (value === '') {
                                        el.removeChild(lastChild)
                                    } else {
                                        lastChild.nodeValue = value
                                    }
                                } else if (VERBATIM_TAGS.indexOf(nodeName) === -1) {
                                    // The very first node in the list should not have leading
                                    // whitespace. Sibling text nodes should have whitespace if there
                                    // was any.
                                    leader = i === 0 ? '' : ' '
                                    value = lastChild.nodeValue
                                        .replace(leadingNewlineRegex, leader)
                                        .replace(leadingSpaceRegex, ' ')
                                        .replace(trailingSpaceRegex, '')
                                        .replace(trailingNewlineRegex, '')
                                        .replace(multiSpaceRegex, ' ')
                                    lastChild.nodeValue = value
                                }
                            }

                            // Iterate over DOM nodes
                        } else if (node && node.nodeType) {
                            // If the last node was a text node, make sure it is properly closed out
                            if (hadText) {
                                hadText = false

                                // Trim the child text nodes if the current node isn't a
                                // text node or a code node
                                if (TEXT_TAGS.indexOf(nodeName) === -1 &&
                                    VERBATIM_TAGS.indexOf(nodeName) === -1) {
                                    value = lastChild.nodeValue
                                        .replace(leadingNewlineRegex, '')
                                        .replace(trailingNewlineRegex, ' ')
                                        .replace(multiSpaceRegex, ' ')

                                    // Remove empty text nodes, append otherwise
                                    if (value === '') {
                                        el.removeChild(lastChild)
                                    } else {
                                        lastChild.nodeValue = value
                                    }
                                    // Trim the child nodes but preserve the appropriate whitespace
                                } else if (VERBATIM_TAGS.indexOf(nodeName) === -1) {
                                    value = lastChild.nodeValue
                                        .replace(leadingSpaceRegex, ' ')
                                        .replace(leadingNewlineRegex, '')
                                        .replace(trailingNewlineRegex, ' ')
                                        .replace(multiSpaceRegex, ' ')
                                    lastChild.nodeValue = value
                                }
                            }

                            // Store the last nodename
                            var _nodeName = node.nodeName
                            if (_nodeName) nodeName = _nodeName.toLowerCase()

                            // Append the node to the DOM
                            el.appendChild(node)
                        }
                    }
                }

            }, {}],
            47: [function(require, module, exports) {
                'use strict'

                module.exports = [
                    'async', 'autofocus', 'autoplay', 'checked', 'controls', 'default',
                    'defaultchecked', 'defer', 'disabled', 'formnovalidate', 'hidden',
                    'ismap', 'loop', 'multiple', 'muted', 'novalidate', 'open', 'playsinline',
                    'readonly', 'required', 'reversed', 'selected'
                ]

            }, {}],
            48: [function(require, module, exports) {
                module.exports = require('./dom')(document)

            }, {
                "./dom": 50
            }],
            49: [function(require, module, exports) {
                'use strict'

                module.exports = [
                    'indeterminate'
                ]

            }, {}],
            50: [function(require, module, exports) {
                'use strict'

                var hyperx = require('hyperx')
                var appendChild = require('./append-child')
                var SVG_TAGS = require('./svg-tags')
                var BOOL_PROPS = require('./bool-props')
                    // Props that need to be set directly rather than with el.setAttribute()
                var DIRECT_PROPS = require('./direct-props')

                var SVGNS = 'http://www.w3.org/2000/svg'
                var XLINKNS = 'http://www.w3.org/1999/xlink'

                var COMMENT_TAG = '!--'

                module.exports = function(document) {
                    function nanoHtmlCreateElement(tag, props, children) {
                        var el

                        // If an svg tag, it needs a namespace
                        if (SVG_TAGS.indexOf(tag) !== -1) {
                            props.namespace = SVGNS
                        }

                        // If we are using a namespace
                        var ns = false
                        if (props.namespace) {
                            ns = props.namespace
                            delete props.namespace
                        }

                        // If we are extending a builtin element
                        var isCustomElement = false
                        if (props.is) {
                            isCustomElement = props.is
                            delete props.is
                        }

                        // Create the element
                        if (ns) {
                            if (isCustomElement) {
                                el = document.createElementNS(ns, tag, {
                                    is: isCustomElement
                                })
                            } else {
                                el = document.createElementNS(ns, tag)
                            }
                        } else if (tag === COMMENT_TAG) {
                            return document.createComment(props.comment)
                        } else if (isCustomElement) {
                            el = document.createElement(tag, {
                                is: isCustomElement
                            })
                        } else {
                            el = document.createElement(tag)
                        }

                        // Create the properties
                        for (var p in props) {
                            if (props.hasOwnProperty(p)) {
                                var key = p.toLowerCase()
                                var val = props[p]
                                    // Normalize className
                                if (key === 'classname') {
                                    key = 'class'
                                    p = 'class'
                                }
                                // The for attribute gets transformed to htmlFor, but we just set as for
                                if (p === 'htmlFor') {
                                    p = 'for'
                                }
                                // If a property is boolean, set itself to the key
                                if (BOOL_PROPS.indexOf(key) !== -1) {
                                    if (String(val) === 'true') val = key
                                    else if (String(val) === 'false') continue
                                }
                                // If a property prefers being set directly vs setAttribute
                                if (key.slice(0, 2) === 'on' || DIRECT_PROPS.indexOf(key) !== -1) {
                                    el[p] = val
                                } else {
                                    if (ns) {
                                        if (p === 'xlink:href') {
                                            el.setAttributeNS(XLINKNS, p, val)
                                        } else if (/^xmlns($|:)/i.test(p)) {
                                            // skip xmlns definitions
                                        } else {
                                            el.setAttributeNS(null, p, val)
                                        }
                                    } else {
                                        el.setAttribute(p, val)
                                    }
                                }
                            }
                        }

                        appendChild(el, children)
                        return el
                    }

                    function createFragment(nodes) {
                        var fragment = document.createDocumentFragment()
                        for (var i = 0; i < nodes.length; i++) {
                            if (nodes[i] == null) continue
                            if (Array.isArray(nodes[i])) {
                                fragment.appendChild(createFragment(nodes[i]))
                            } else {
                                if (typeof nodes[i] === 'string') nodes[i] = document.createTextNode(nodes[i])
                                fragment.appendChild(nodes[i])
                            }
                        }
                        return fragment
                    }

                    var exports = hyperx(nanoHtmlCreateElement, {
                        comments: true,
                        createFragment: createFragment
                    })
                    exports.default = exports
                    exports.createComment = nanoHtmlCreateElement
                    return exports
                }

            }, {
                "./append-child": 46,
                "./bool-props": 47,
                "./direct-props": 49,
                "./svg-tags": 51,
                "hyperx": 42
            }],
            51: [function(require, module, exports) {
                'use strict'

                module.exports = [
                    'svg', 'altGlyph', 'altGlyphDef', 'altGlyphItem', 'animate', 'animateColor',
                    'animateMotion', 'animateTransform', 'circle', 'clipPath', 'color-profile',
                    'cursor', 'defs', 'desc', 'ellipse', 'feBlend', 'feColorMatrix',
                    'feComponentTransfer', 'feComposite', 'feConvolveMatrix',
                    'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight', 'feFlood',
                    'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage',
                    'feMerge', 'feMergeNode', 'feMorphology', 'feOffset', 'fePointLight',
                    'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence', 'filter',
                    'font', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src',
                    'font-face-uri', 'foreignObject', 'g', 'glyph', 'glyphRef', 'hkern', 'image',
                    'line', 'linearGradient', 'marker', 'mask', 'metadata', 'missing-glyph',
                    'mpath', 'path', 'pattern', 'polygon', 'polyline', 'radialGradient', 'rect',
                    'set', 'stop', 'switch', 'symbol', 'text', 'textPath', 'title', 'tref',
                    'tspan', 'use', 'view', 'vkern'
                ]

            }, {}],
            52: [function(require, module, exports) {
                module.exports = LRU

                function LRU(opts) {
                    if (!(this instanceof LRU)) return new LRU(opts)
                    if (typeof opts === 'number') opts = {
                        max: opts
                    }
                    if (!opts) opts = {}
                    this.cache = {}
                    this.head = this.tail = null
                    this.length = 0
                    this.max = opts.max || 1000
                    this.maxAge = opts.maxAge || 0
                }

                Object.defineProperty(LRU.prototype, 'keys', {
                    get: function() {
                        return Object.keys(this.cache)
                    }
                })

                LRU.prototype.clear = function() {
                    this.cache = {}
                    this.head = this.tail = null
                    this.length = 0
                }

                LRU.prototype.remove = function(key) {
                    if (typeof key !== 'string') key = '' + key
                    if (!this.cache.hasOwnProperty(key)) return

                    var element = this.cache[key]
                    delete this.cache[key]
                    this._unlink(key, element.prev, element.next)
                    return element.value
                }

                LRU.prototype._unlink = function(key, prev, next) {
                    this.length--

                        if (this.length === 0) {
                            this.head = this.tail = null
                        } else {
                            if (this.head === key) {
                                this.head = prev
                                this.cache[this.head].next = null
                            } else if (this.tail === key) {
                                this.tail = next
                                this.cache[this.tail].prev = null
                            } else {
                                this.cache[prev].next = next
                                this.cache[next].prev = prev
                            }
                        }
                }

                LRU.prototype.peek = function(key) {
                    if (!this.cache.hasOwnProperty(key)) return

                    var element = this.cache[key]

                    if (!this._checkAge(key, element)) return
                    return element.value
                }

                LRU.prototype.set = function(key, value) {
                    if (typeof key !== 'string') key = '' + key

                    var element

                    if (this.cache.hasOwnProperty(key)) {
                        element = this.cache[key]
                        element.value = value
                        if (this.maxAge) element.modified = Date.now()

                        // If it's already the head, there's nothing more to do:
                        if (key === this.head) return value
                        this._unlink(key, element.prev, element.next)
                    } else {
                        element = {
                            value: value,
                            modified: 0,
                            next: null,
                            prev: null
                        }
                        if (this.maxAge) element.modified = Date.now()
                        this.cache[key] = element

                        // Eviction is only possible if the key didn't already exist:
                        if (this.length === this.max) this.evict()
                    }

                    this.length++
                        element.next = null
                    element.prev = this.head

                    if (this.head) this.cache[this.head].next = key
                    this.head = key

                    if (!this.tail) this.tail = key
                    return value
                }

                LRU.prototype._checkAge = function(key, element) {
                    if (this.maxAge && (Date.now() - element.modified) > this.maxAge) {
                        this.remove(key)
                        return false
                    }
                    return true
                }

                LRU.prototype.get = function(key) {
                    if (typeof key !== 'string') key = '' + key
                    if (!this.cache.hasOwnProperty(key)) return

                    var element = this.cache[key]

                    if (!this._checkAge(key, element)) return

                    if (this.head !== key) {
                        if (key === this.tail) {
                            this.tail = element.next
                            this.cache[this.tail].prev = null
                        } else {
                            // Set prev.next -> element.next:
                            this.cache[element.prev].next = element.next
                        }

                        // Set element.next.prev -> element.prev:
                        this.cache[element.next].prev = element.prev

                        // Element is the new head
                        this.cache[this.head].next = key
                        element.prev = this.head
                        element.next = null
                        this.head = key
                    }

                    return element.value
                }

                LRU.prototype.evict = function() {
                    if (!this.tail) return
                    this.remove(this.tail)
                }

            }, {}],
            53: [function(require, module, exports) {
                var assert = require('nanoassert')
                var morph = require('./lib/morph')

                var TEXT_NODE = 3
                    // var DEBUG = false

                module.exports = nanomorph

                // Morph one tree into another tree
                //
                // no parent
                //   -> same: diff and walk children
                //   -> not same: replace and return
                // old node doesn't exist
                //   -> insert new node
                // new node doesn't exist
                //   -> delete old node
                // nodes are not the same
                //   -> diff nodes and apply patch to old node
                // nodes are the same
                //   -> walk all child nodes and append to old node
                function nanomorph(oldTree, newTree, options) {
                    // if (DEBUG) {
                    //   console.log(
                    //   'nanomorph\nold\n  %s\nnew\n  %s',
                    //   oldTree && oldTree.outerHTML,
                    //   newTree && newTree.outerHTML
                    // )
                    // }
                    assert.equal(typeof oldTree, 'object', 'nanomorph: oldTree should be an object')
                    assert.equal(typeof newTree, 'object', 'nanomorph: newTree should be an object')

                    if (options && options.childrenOnly) {
                        updateChildren(newTree, oldTree)
                        return oldTree
                    }

                    assert.notEqual(
                        newTree.nodeType,
                        11,
                        'nanomorph: newTree should have one root node (which is not a DocumentFragment)'
                    )

                    return walk(newTree, oldTree)
                }

                // Walk and morph a dom tree
                function walk(newNode, oldNode) {
                    // if (DEBUG) {
                    //   console.log(
                    //   'walk\nold\n  %s\nnew\n  %s',
                    //   oldNode && oldNode.outerHTML,
                    //   newNode && newNode.outerHTML
                    // )
                    // }
                    if (!oldNode) {
                        return newNode
                    } else if (!newNode) {
                        return null
                    } else if (newNode.isSameNode && newNode.isSameNode(oldNode)) {
                        return oldNode
                    } else if (newNode.tagName !== oldNode.tagName || getComponentId(newNode) !== getComponentId(oldNode)) {
                        return newNode
                    } else {
                        morph(newNode, oldNode)
                        updateChildren(newNode, oldNode)
                        return oldNode
                    }
                }

                function getComponentId(node) {
                    return node.dataset ? node.dataset.nanomorphComponentId : undefined
                }

                // Update the children of elements
                // (obj, obj) -> null
                function updateChildren(newNode, oldNode) {
                    // if (DEBUG) {
                    //   console.log(
                    //   'updateChildren\nold\n  %s\nnew\n  %s',
                    //   oldNode && oldNode.outerHTML,
                    //   newNode && newNode.outerHTML
                    // )
                    // }
                    var oldChild, newChild, morphed, oldMatch

                    // The offset is only ever increased, and used for [i - offset] in the loop
                    var offset = 0

                    for (var i = 0;; i++) {
                        oldChild = oldNode.childNodes[i]
                        newChild = newNode.childNodes[i - offset]
                            // if (DEBUG) {
                            //   console.log(
                            //   '===\n- old\n  %s\n- new\n  %s',
                            //   oldChild && oldChild.outerHTML,
                            //   newChild && newChild.outerHTML
                            // )
                            // }
                            // Both nodes are empty, do nothing
                        if (!oldChild && !newChild) {
                            break

                            // There is no new child, remove old
                        } else if (!newChild) {
                            oldNode.removeChild(oldChild)
                            i--

                            // There is no old child, add new
                        } else if (!oldChild) {
                            oldNode.appendChild(newChild)
                            offset++

                            // Both nodes are the same, morph
                        } else if (same(newChild, oldChild)) {
                            morphed = walk(newChild, oldChild)
                            if (morphed !== oldChild) {
                                oldNode.replaceChild(morphed, oldChild)
                                offset++
                            }

                            // Both nodes do not share an ID or a placeholder, try reorder
                        } else {
                            oldMatch = null

                            // Try and find a similar node somewhere in the tree
                            for (var j = i; j < oldNode.childNodes.length; j++) {
                                if (same(oldNode.childNodes[j], newChild)) {
                                    oldMatch = oldNode.childNodes[j]
                                    break
                                }
                            }

                            // If there was a node with the same ID or placeholder in the old list
                            if (oldMatch) {
                                morphed = walk(newChild, oldMatch)
                                if (morphed !== oldMatch) offset++
                                    oldNode.insertBefore(morphed, oldChild)

                                // It's safe to morph two nodes in-place if neither has an ID
                            } else if (!newChild.id && !oldChild.id) {
                                morphed = walk(newChild, oldChild)
                                if (morphed !== oldChild) {
                                    oldNode.replaceChild(morphed, oldChild)
                                    offset++
                                }

                                // Insert the node at the index if we couldn't morph or find a matching node
                            } else {
                                oldNode.insertBefore(newChild, oldChild)
                                offset++
                            }
                        }
                    }
                }

                function same(a, b) {
                    if (a.id) return a.id === b.id
                    if (a.isSameNode) return a.isSameNode(b)
                    if (a.tagName !== b.tagName) return false
                    if (a.type === TEXT_NODE) return a.nodeValue === b.nodeValue
                    return false
                }

            }, {
                "./lib/morph": 55,
                "nanoassert": 43
            }],
            54: [function(require, module, exports) {
                module.exports = [
                    // attribute events (can be set with attributes)
                    'onclick',
                    'ondblclick',
                    'onmousedown',
                    'onmouseup',
                    'onmouseover',
                    'onmousemove',
                    'onmouseout',
                    'onmouseenter',
                    'onmouseleave',
                    'ontouchcancel',
                    'ontouchend',
                    'ontouchmove',
                    'ontouchstart',
                    'ondragstart',
                    'ondrag',
                    'ondragenter',
                    'ondragleave',
                    'ondragover',
                    'ondrop',
                    'ondragend',
                    'onkeydown',
                    'onkeypress',
                    'onkeyup',
                    'onunload',
                    'onabort',
                    'onerror',
                    'onresize',
                    'onscroll',
                    'onselect',
                    'onchange',
                    'onsubmit',
                    'onreset',
                    'onfocus',
                    'onblur',
                    'oninput',
                    'onanimationend',
                    'onanimationiteration',
                    'onanimationstart',
                    // other common events
                    'oncontextmenu',
                    'onfocusin',
                    'onfocusout'
                ]

            }, {}],
            55: [function(require, module, exports) {
                var events = require('./events')
                var eventsLength = events.length

                var ELEMENT_NODE = 1
                var TEXT_NODE = 3
                var COMMENT_NODE = 8

                module.exports = morph

                // diff elements and apply the resulting patch to the old node
                // (obj, obj) -> null
                function morph(newNode, oldNode) {
                    var nodeType = newNode.nodeType
                    var nodeName = newNode.nodeName

                    if (nodeType === ELEMENT_NODE) {
                        copyAttrs(newNode, oldNode)
                    }

                    if (nodeType === TEXT_NODE || nodeType === COMMENT_NODE) {
                        if (oldNode.nodeValue !== newNode.nodeValue) {
                            oldNode.nodeValue = newNode.nodeValue
                        }
                    }

                    // Some DOM nodes are weird
                    // https://github.com/patrick-steele-idem/morphdom/blob/master/src/specialElHandlers.js
                    if (nodeName === 'INPUT') updateInput(newNode, oldNode)
                    else if (nodeName === 'OPTION') updateOption(newNode, oldNode)
                    else if (nodeName === 'TEXTAREA') updateTextarea(newNode, oldNode)

                    copyEvents(newNode, oldNode)
                }

                function copyAttrs(newNode, oldNode) {
                    var oldAttrs = oldNode.attributes
                    var newAttrs = newNode.attributes
                    var attrNamespaceURI = null
                    var attrValue = null
                    var fromValue = null
                    var attrName = null
                    var attr = null

                    for (var i = newAttrs.length - 1; i >= 0; --i) {
                        attr = newAttrs[i]
                        attrName = attr.name
                        attrNamespaceURI = attr.namespaceURI
                        attrValue = attr.value
                        if (attrNamespaceURI) {
                            attrName = attr.localName || attrName
                            fromValue = oldNode.getAttributeNS(attrNamespaceURI, attrName)
                            if (fromValue !== attrValue) {
                                oldNode.setAttributeNS(attrNamespaceURI, attrName, attrValue)
                            }
                        } else {
                            if (!oldNode.hasAttribute(attrName)) {
                                oldNode.setAttribute(attrName, attrValue)
                            } else {
                                fromValue = oldNode.getAttribute(attrName)
                                if (fromValue !== attrValue) {
                                    // apparently values are always cast to strings, ah well
                                    if (attrValue === 'null' || attrValue === 'undefined') {
                                        oldNode.removeAttribute(attrName)
                                    } else {
                                        oldNode.setAttribute(attrName, attrValue)
                                    }
                                }
                            }
                        }
                    }

                    // Remove any extra attributes found on the original DOM element that
                    // weren't found on the target element.
                    for (var j = oldAttrs.length - 1; j >= 0; --j) {
                        attr = oldAttrs[j]
                        if (attr.specified !== false) {
                            attrName = attr.name
                            attrNamespaceURI = attr.namespaceURI

                            if (attrNamespaceURI) {
                                attrName = attr.localName || attrName
                                if (!newNode.hasAttributeNS(attrNamespaceURI, attrName)) {
                                    oldNode.removeAttributeNS(attrNamespaceURI, attrName)
                                }
                            } else {
                                if (!newNode.hasAttributeNS(null, attrName)) {
                                    oldNode.removeAttribute(attrName)
                                }
                            }
                        }
                    }
                }

                function copyEvents(newNode, oldNode) {
                    for (var i = 0; i < eventsLength; i++) {
                        var ev = events[i]
                        if (newNode[ev]) { // if new element has a whitelisted attribute
                            oldNode[ev] = newNode[ev] // update existing element
                        } else if (oldNode[ev]) { // if existing element has it and new one doesnt
                            oldNode[ev] = undefined // remove it from existing element
                        }
                    }
                }

                function updateOption(newNode, oldNode) {
                    updateAttribute(newNode, oldNode, 'selected')
                }

                // The "value" attribute is special for the <input> element since it sets the
                // initial value. Changing the "value" attribute without changing the "value"
                // property will have no effect since it is only used to the set the initial
                // value. Similar for the "checked" attribute, and "disabled".
                function updateInput(newNode, oldNode) {
                    var newValue = newNode.value
                    var oldValue = oldNode.value

                    updateAttribute(newNode, oldNode, 'checked')
                    updateAttribute(newNode, oldNode, 'disabled')

                    // The "indeterminate" property can not be set using an HTML attribute.
                    // See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/checkbox
                    if (newNode.indeterminate !== oldNode.indeterminate) {
                        oldNode.indeterminate = newNode.indeterminate
                    }

                    // Persist file value since file inputs can't be changed programatically
                    if (oldNode.type === 'file') return

                    if (newValue !== oldValue) {
                        oldNode.setAttribute('value', newValue)
                        oldNode.value = newValue
                    }

                    if (newValue === 'null') {
                        oldNode.value = ''
                        oldNode.removeAttribute('value')
                    }

                    if (!newNode.hasAttributeNS(null, 'value')) {
                        oldNode.removeAttribute('value')
                    } else if (oldNode.type === 'range') {
                        // this is so elements like slider move their UI thingy
                        oldNode.value = newValue
                    }
                }

                function updateTextarea(newNode, oldNode) {
                    var newValue = newNode.value
                    if (newValue !== oldNode.value) {
                        oldNode.value = newValue
                    }

                    if (oldNode.firstChild && oldNode.firstChild.nodeValue !== newValue) {
                        // Needed for IE. Apparently IE sets the placeholder as the
                        // node value and vise versa. This ignores an empty update.
                        if (newValue === '' && oldNode.firstChild.nodeValue === oldNode.placeholder) {
                            return
                        }

                        oldNode.firstChild.nodeValue = newValue
                    }
                }

                function updateAttribute(newNode, oldNode, name) {
                    if (newNode[name] !== oldNode[name]) {
                        oldNode[name] = newNode[name]
                        if (newNode[name]) {
                            oldNode.setAttribute(name, '')
                        } else {
                            oldNode.removeAttribute(name)
                        }
                    }
                }

            }, {
                "./events": 54
            }],
            56: [function(require, module, exports) {
                var reg = /([^?=&]+)(=([^&]*))?/g
                var assert = require('assert')

                module.exports = qs

                function qs(url) {
                    assert.equal(typeof url, 'string', 'nanoquery: url should be type string')

                    var obj = {}
                    url.replace(/^.*\?/, '').replace(reg, function(a0, a1, a2, a3) {
                        var value = decodeURIComponent(a3)
                        var key = decodeURIComponent(a1)
                        if (obj.hasOwnProperty(key)) {
                            if (Array.isArray(obj[key])) obj[key].push(value)
                            else obj[key] = [obj[key], value]
                        } else {
                            obj[key] = value
                        }
                    })

                    return obj
                }

            }, {
                "assert": 43
            }],
            57: [function(require, module, exports) {
                'use strict'

                var assert = require('assert')

                module.exports = nanoraf

                // Only call RAF when needed
                // (fn, fn?) -> fn
                function nanoraf(render, raf) {
                    assert.equal(typeof render, 'function', 'nanoraf: render should be a function')
                    assert.ok(typeof raf === 'function' || typeof raf === 'undefined', 'nanoraf: raf should be a function or undefined')

                    if (!raf) raf = window.requestAnimationFrame
                    var redrawScheduled = false
                    var args = null

                    return function frame() {
                        if (args === null && !redrawScheduled) {
                            redrawScheduled = true

                            raf(function redraw() {
                                redrawScheduled = false

                                var length = args.length
                                var _args = new Array(length)
                                for (var i = 0; i < length; i++) _args[i] = args[i]

                                render.apply(render, _args)
                                args = null
                            })
                        }

                        args = arguments
                    }
                }

            }, {
                "assert": 43
            }],
            58: [function(require, module, exports) {
                var assert = require('assert')
                var wayfarer = require('wayfarer')

                // electron support
                var isLocalFile = (/file:\/\//.test(
                    typeof window === 'object' &&
                    window.location &&
                    window.location.origin
                ))

                /* eslint-disable no-useless-escape */
                var electron = '^(file:\/\/|\/)(.*\.html?\/?)?'
                var protocol = '^(http(s)?(:\/\/))?(www\.)?'
                var domain = '[a-zA-Z0-9-_\.]+(:[0-9]{1,5})?(\/{1})?'
                var qs = '[\?].*$'
                    /* eslint-enable no-useless-escape */

                var stripElectron = new RegExp(electron)
                var prefix = new RegExp(protocol + domain)
                var normalize = new RegExp('#')
                var suffix = new RegExp(qs)

                module.exports = Nanorouter

                function Nanorouter(opts) {
                    if (!(this instanceof Nanorouter)) return new Nanorouter(opts)
                    opts = opts || {}
                    this.router = wayfarer(opts.default || '/404')
                }

                Nanorouter.prototype.on = function(routename, listener) {
                    assert.equal(typeof routename, 'string')
                    routename = routename.replace(/^[#/]/, '')
                    this.router.on(routename, listener)
                }

                Nanorouter.prototype.emit = function(routename) {
                    assert.equal(typeof routename, 'string')
                    routename = pathname(routename, isLocalFile)
                    return this.router.emit(routename)
                }

                Nanorouter.prototype.match = function(routename) {
                    assert.equal(typeof routename, 'string')
                    routename = pathname(routename, isLocalFile)
                    return this.router.match(routename)
                }

                // replace everything in a route but the pathname and hash
                function pathname(routename, isElectron) {
                    if (isElectron) routename = routename.replace(stripElectron, '')
                    else routename = routename.replace(prefix, '')
                    return decodeURI(routename.replace(suffix, '').replace(normalize, '/'))
                }

            }, {
                "assert": 43,
                "wayfarer": 66
            }],
            59: [function(require, module, exports) {
                var assert = require('assert')

                var hasWindow = typeof window !== 'undefined'

                function createScheduler() {
                    var scheduler
                    if (hasWindow) {
                        if (!window._nanoScheduler) window._nanoScheduler = new NanoScheduler(true)
                        scheduler = window._nanoScheduler
                    } else {
                        scheduler = new NanoScheduler()
                    }
                    return scheduler
                }

                function NanoScheduler(hasWindow) {
                    this.hasWindow = hasWindow
                    this.hasIdle = this.hasWindow && window.requestIdleCallback
                    this.method = this.hasIdle ? window.requestIdleCallback.bind(window) : this.setTimeout
                    this.scheduled = false
                    this.queue = []
                }

                NanoScheduler.prototype.push = function(cb) {
                    assert.equal(typeof cb, 'function', 'nanoscheduler.push: cb should be type function')

                    this.queue.push(cb)
                    this.schedule()
                }

                NanoScheduler.prototype.schedule = function() {
                    if (this.scheduled) return

                    this.scheduled = true
                    var self = this
                    this.method(function(idleDeadline) {
                        var cb
                        while (self.queue.length && idleDeadline.timeRemaining() > 0) {
                            cb = self.queue.shift()
                            cb(idleDeadline)
                        }
                        self.scheduled = false
                        if (self.queue.length) self.schedule()
                    })
                }

                NanoScheduler.prototype.setTimeout = function(cb) {
                    setTimeout(cb, 0, {
                        timeRemaining: function() {
                            return 1
                        }
                    })
                }

                module.exports = createScheduler

            }, {
                "assert": 43
            }],
            60: [function(require, module, exports) {
                var scheduler = require('nanoscheduler')()
                var assert = require('assert')

                var perf
                nanotiming.disabled = true
                try {
                    perf = window.performance
                    nanotiming.disabled = window.localStorage.DISABLE_NANOTIMING === 'true' || !perf.mark
                } catch (e) {}

                module.exports = nanotiming

                function nanotiming(name) {
                    assert.equal(typeof name, 'string', 'nanotiming: name should be type string')

                    if (nanotiming.disabled) return noop

                    var uuid = (perf.now() * 10000).toFixed() % Number.MAX_SAFE_INTEGER
                    var startName = 'start-' + uuid + '-' + name
                    perf.mark(startName)

                    function end(cb) {
                        var endName = 'end-' + uuid + '-' + name
                        perf.mark(endName)

                        scheduler.push(function() {
                            var err = null
                            try {
                                var measureName = name + ' [' + uuid + ']'
                                perf.measure(measureName, startName, endName)
                                perf.clearMarks(startName)
                                perf.clearMarks(endName)
                            } catch (e) {
                                err = e
                            }
                            if (cb) cb(err, name)
                        })
                    }

                    end.uuid = uuid
                    return end
                }

                function noop(cb) {
                    if (cb) {
                        scheduler.push(function() {
                            cb(new Error('nanotiming: performance API unavailable'))
                        })
                    }
                }

            }, {
                "assert": 43,
                "nanoscheduler": 59
            }],
            61: [function(require, module, exports) {
                /*
                object-assign
                (c) Sindre Sorhus
                @license MIT
                */

                'use strict';
                /* eslint-disable no-unused-vars */
                var getOwnPropertySymbols = Object.getOwnPropertySymbols;
                var hasOwnProperty = Object.prototype.hasOwnProperty;
                var propIsEnumerable = Object.prototype.propertyIsEnumerable;

                function toObject(val) {
                    if (val === null || val === undefined) {
                        throw new TypeError('Object.assign cannot be called with null or undefined');
                    }

                    return Object(val);
                }

                function shouldUseNative() {
                    try {
                        if (!Object.assign) {
                            return false;
                        }

                        // Detect buggy property enumeration order in older V8 versions.

                        // https://bugs.chromium.org/p/v8/issues/detail?id=4118
                        var test1 = new String('abc'); // eslint-disable-line no-new-wrappers
                        test1[5] = 'de';
                        if (Object.getOwnPropertyNames(test1)[0] === '5') {
                            return false;
                        }

                        // https://bugs.chromium.org/p/v8/issues/detail?id=3056
                        var test2 = {};
                        for (var i = 0; i < 10; i++) {
                            test2['_' + String.fromCharCode(i)] = i;
                        }
                        var order2 = Object.getOwnPropertyNames(test2).map(function(n) {
                            return test2[n];
                        });
                        if (order2.join('') !== '0123456789') {
                            return false;
                        }

                        // https://bugs.chromium.org/p/v8/issues/detail?id=3056
                        var test3 = {};
                        'abcdefghijklmnopqrst'.split('').forEach(function(letter) {
                            test3[letter] = letter;
                        });
                        if (Object.keys(Object.assign({}, test3)).join('') !==
                            'abcdefghijklmnopqrst') {
                            return false;
                        }

                        return true;
                    } catch (err) {
                        // We don't expect any of the above to throw, but better to be safe.
                        return false;
                    }
                }

                module.exports = shouldUseNative() ? Object.assign : function(target, source) {
                    var from;
                    var to = toObject(target);
                    var symbols;

                    for (var s = 1; s < arguments.length; s++) {
                        from = Object(arguments[s]);

                        for (var key in from) {
                            if (hasOwnProperty.call(from, key)) {
                                to[key] = from[key];
                            }
                        }

                        if (getOwnPropertySymbols) {
                            symbols = getOwnPropertySymbols(from);
                            for (var i = 0; i < symbols.length; i++) {
                                if (propIsEnumerable.call(from, symbols[i])) {
                                    to[symbols[i]] = from[symbols[i]];
                                }
                            }
                        }
                    }

                    return to;
                };

            }, {}],
            62: [function(require, module, exports) {
                // shim for using process in browser
                var process = module.exports = {};

                // cached from whatever global is present so that test runners that stub it
                // don't break things.  But we need to wrap it in a try catch in case it is
                // wrapped in strict mode code which doesn't define any globals.  It's inside a
                // function because try/catches deoptimize in certain engines.

                var cachedSetTimeout;
                var cachedClearTimeout;

                function defaultSetTimout() {
                    throw new Error('setTimeout has not been defined');
                }

                function defaultClearTimeout() {
                    throw new Error('clearTimeout has not been defined');
                }
                (function() {
                    try {
                        if (typeof setTimeout === 'function') {
                            cachedSetTimeout = setTimeout;
                        } else {
                            cachedSetTimeout = defaultSetTimout;
                        }
                    } catch (e) {
                        cachedSetTimeout = defaultSetTimout;
                    }
                    try {
                        if (typeof clearTimeout === 'function') {
                            cachedClearTimeout = clearTimeout;
                        } else {
                            cachedClearTimeout = defaultClearTimeout;
                        }
                    } catch (e) {
                        cachedClearTimeout = defaultClearTimeout;
                    }
                }())

                function runTimeout(fun) {
                    if (cachedSetTimeout === setTimeout) {
                        //normal enviroments in sane situations
                        return setTimeout(fun, 0);
                    }
                    // if setTimeout wasn't available but was latter defined
                    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
                        cachedSetTimeout = setTimeout;
                        return setTimeout(fun, 0);
                    }
                    try {
                        // when when somebody has screwed with setTimeout but no I.E. maddness
                        return cachedSetTimeout(fun, 0);
                    } catch (e) {
                        try {
                            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
                            return cachedSetTimeout.call(null, fun, 0);
                        } catch (e) {
                            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
                            return cachedSetTimeout.call(this, fun, 0);
                        }
                    }


                }

                function runClearTimeout(marker) {
                    if (cachedClearTimeout === clearTimeout) {
                        //normal enviroments in sane situations
                        return clearTimeout(marker);
                    }
                    // if clearTimeout wasn't available but was latter defined
                    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
                        cachedClearTimeout = clearTimeout;
                        return clearTimeout(marker);
                    }
                    try {
                        // when when somebody has screwed with setTimeout but no I.E. maddness
                        return cachedClearTimeout(marker);
                    } catch (e) {
                        try {
                            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
                            return cachedClearTimeout.call(null, marker);
                        } catch (e) {
                            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
                            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
                            return cachedClearTimeout.call(this, marker);
                        }
                    }



                }
                var queue = [];
                var draining = false;
                var currentQueue;
                var queueIndex = -1;

                function cleanUpNextTick() {
                    if (!draining || !currentQueue) {
                        return;
                    }
                    draining = false;
                    if (currentQueue.length) {
                        queue = currentQueue.concat(queue);
                    } else {
                        queueIndex = -1;
                    }
                    if (queue.length) {
                        drainQueue();
                    }
                }

                function drainQueue() {
                    if (draining) {
                        return;
                    }
                    var timeout = runTimeout(cleanUpNextTick);
                    draining = true;

                    var len = queue.length;
                    while (len) {
                        currentQueue = queue;
                        queue = [];
                        while (++queueIndex < len) {
                            if (currentQueue) {
                                currentQueue[queueIndex].run();
                            }
                        }
                        queueIndex = -1;
                        len = queue.length;
                    }
                    currentQueue = null;
                    draining = false;
                    runClearTimeout(timeout);
                }

                process.nextTick = function(fun) {
                    var args = new Array(arguments.length - 1);
                    if (arguments.length > 1) {
                        for (var i = 1; i < arguments.length; i++) {
                            args[i - 1] = arguments[i];
                        }
                    }
                    queue.push(new Item(fun, args));
                    if (queue.length === 1 && !draining) {
                        runTimeout(drainQueue);
                    }
                };

                // v8 likes predictible objects
                function Item(fun, array) {
                    this.fun = fun;
                    this.array = array;
                }
                Item.prototype.run = function() {
                    this.fun.apply(null, this.array);
                };
                process.title = 'browser';
                process.browser = true;
                process.env = {};
                process.argv = [];
                process.version = ''; // empty string to avoid regexp issues
                process.versions = {};

                function noop() {}

                process.on = noop;
                process.addListener = noop;
                process.once = noop;
                process.off = noop;
                process.removeListener = noop;
                process.removeAllListeners = noop;
                process.emit = noop;
                process.prependListener = noop;
                process.prependOnceListener = noop;

                process.listeners = function(name) {
                    return []
                }

                process.binding = function(name) {
                    throw new Error('process.binding is not supported');
                };

                process.cwd = function() {
                    return '/'
                };
                process.chdir = function(dir) {
                    throw new Error('process.chdir is not supported');
                };
                process.umask = function() {
                    return 0;
                };

            }, {}],
            63: [function(require, module, exports) {
                (function(U, X) {
                    "object" === typeof exports && "undefined" !== typeof module ? module.exports = X() : "function" === typeof define && define.amd ? define(X) : U.createREGL = X()
                })(this, function() {
                    function U(a, b) {
                        this.id = Eb++;
                        this.type = a;
                        this.data = b
                    }

                    function X(a) {
                        if (0 === a.length) return [];
                        var b = a.charAt(0),
                            c = a.charAt(a.length - 1);
                        if (1 < a.length && b === c && ('"' === b || "'" === b)) return ['"' + a.substr(1, a.length - 2).replace(/\\/g, "\\\\").replace(/"/g, '\\"') + '"'];
                        if (b = /\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a)) return X(a.substr(0,
                            b.index)).concat(X(b[1])).concat(X(a.substr(b.index + b[0].length)));
                        b = a.split(".");
                        if (1 === b.length) return ['"' + a.replace(/\\/g, "\\\\").replace(/"/g, '\\"') + '"'];
                        a = [];
                        for (c = 0; c < b.length; ++c) a = a.concat(X(b[c]));
                        return a
                    }

                    function cb(a) {
                        return "[" + X(a).join("][") + "]"
                    }

                    function db(a, b) {
                        if ("function" === typeof a) return new U(0, a);
                        if ("number" === typeof a || "boolean" === typeof a) return new U(5, a);
                        if (Array.isArray(a)) return new U(6, a.map(function(a, e) {
                            return db(a, b + "[" + e + "]")
                        }));
                        if (a instanceof U) return a
                    }

                    function Fb() {
                        var a = {
                                "": 0
                            },
                            b = [""];
                        return {
                            id: function(c) {
                                var e = a[c];
                                if (e) return e;
                                e = a[c] = b.length;
                                b.push(c);
                                return e
                            },
                            str: function(a) {
                                return b[a]
                            }
                        }
                    }

                    function Gb(a, b, c) {
                        function e() {
                            var b = window.innerWidth,
                                e = window.innerHeight;
                            a !== document.body && (e = a.getBoundingClientRect(), b = e.right - e.left, e = e.bottom - e.top);
                            f.width = c * b;
                            f.height = c * e;
                            A(f.style, {
                                width: b + "px",
                                height: e + "px"
                            })
                        }
                        var f = document.createElement("canvas");
                        A(f.style, {
                            border: 0,
                            margin: 0,
                            padding: 0,
                            top: 0,
                            left: 0
                        });
                        a.appendChild(f);
                        a === document.body && (f.style.position = "absolute",
                            A(a.style, {
                                margin: 0,
                                padding: 0
                            }));
                        var d;
                        a !== document.body && "function" === typeof ResizeObserver ? (d = new ResizeObserver(function() {
                            setTimeout(e)
                        }), d.observe(a)) : window.addEventListener("resize", e, !1);
                        e();
                        return {
                            canvas: f,
                            onDestroy: function() {
                                d ? d.disconnect() : window.removeEventListener("resize", e);
                                a.removeChild(f)
                            }
                        }
                    }

                    function Hb(a, b) {
                        function c(c) {
                            try {
                                return a.getContext(c, b)
                            } catch (f) {
                                return null
                            }
                        }
                        return c("webgl") || c("experimental-webgl") || c("webgl-experimental")
                    }

                    function eb(a) {
                        return "string" === typeof a ?
                            a.split() : a
                    }

                    function fb(a) {
                        return "string" === typeof a ? document.querySelector(a) : a
                    }

                    function Ib(a) {
                        var b = a || {},
                            c, e, f, d;
                        a = {};
                        var p = [],
                            n = [],
                            u = "undefined" === typeof window ? 1 : window.devicePixelRatio,
                            t = !1,
                            w = function(a) {},
                            k = function() {};
                        "string" === typeof b ? c = document.querySelector(b) : "object" === typeof b && ("string" === typeof b.nodeName && "function" === typeof b.appendChild && "function" === typeof b.getBoundingClientRect ? c = b : "function" === typeof b.drawArrays || "function" === typeof b.drawElements ? (d = b, f = d.canvas) : ("gl" in
                            b ? d = b.gl : "canvas" in b ? f = fb(b.canvas) : "container" in b && (e = fb(b.container)), "attributes" in b && (a = b.attributes), "extensions" in b && (p = eb(b.extensions)), "optionalExtensions" in b && (n = eb(b.optionalExtensions)), "onDone" in b && (w = b.onDone), "profile" in b && (t = !!b.profile), "pixelRatio" in b && (u = +b.pixelRatio)));
                        c && ("canvas" === c.nodeName.toLowerCase() ? f = c : e = c);
                        if (!d) {
                            if (!f) {
                                c = Gb(e || document.body, w, u);
                                if (!c) return null;
                                f = c.canvas;
                                k = c.onDestroy
                            }
                            void 0 === a.premultipliedAlpha && (a.premultipliedAlpha = !0);
                            d = Hb(f, a)
                        }
                        return d ? {
                            gl: d,
                            canvas: f,
                            container: e,
                            extensions: p,
                            optionalExtensions: n,
                            pixelRatio: u,
                            profile: t,
                            onDone: w,
                            onDestroy: k
                        } : (k(), w("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"), null)
                    }

                    function Jb(a, b) {
                        function c(b) {
                            b = b.toLowerCase();
                            var c;
                            try {
                                c = e[b] = a.getExtension(b)
                            } catch (f) {}
                            return !!c
                        }
                        for (var e = {}, f = 0; f < b.extensions.length; ++f) {
                            var d = b.extensions[f];
                            if (!c(d)) return b.onDestroy(), b.onDone('"' + d + '" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),
                                null
                        }
                        b.optionalExtensions.forEach(c);
                        return {
                            extensions: e,
                            restore: function() {
                                Object.keys(e).forEach(function(a) {
                                    if (e[a] && !c(a)) throw Error("(regl): error restoring extension " + a);
                                })
                            }
                        }
                    }

                    function J(a, b) {
                        for (var c = Array(a), e = 0; e < a; ++e) c[e] = b(e);
                        return c
                    }

                    function gb(a) {
                        var b, c;
                        b = (65535 < a) << 4;
                        a >>>= b;
                        c = (255 < a) << 3;
                        a >>>= c;
                        b |= c;
                        c = (15 < a) << 2;
                        a >>>= c;
                        b |= c;
                        c = (3 < a) << 1;
                        return b | c | a >>> c >> 1
                    }

                    function hb() {
                        function a(a) {
                            a: {
                                for (var b = 16; 268435456 >= b; b *= 16)
                                    if (a <= b) {
                                        a = b;
                                        break a
                                    }
                                a = 0
                            }
                            b = c[gb(a) >> 2];
                            return 0 < b.length ? b.pop() : new ArrayBuffer(a)
                        }

                        function b(a) {
                            c[gb(a.byteLength) >> 2].push(a)
                        }
                        var c = J(8, function() {
                            return []
                        });
                        return {
                            alloc: a,
                            free: b,
                            allocType: function(b, c) {
                                var d = null;
                                switch (b) {
                                    case 5120:
                                        d = new Int8Array(a(c), 0, c);
                                        break;
                                    case 5121:
                                        d = new Uint8Array(a(c), 0, c);
                                        break;
                                    case 5122:
                                        d = new Int16Array(a(2 * c), 0, c);
                                        break;
                                    case 5123:
                                        d = new Uint16Array(a(2 * c), 0, c);
                                        break;
                                    case 5124:
                                        d = new Int32Array(a(4 * c), 0, c);
                                        break;
                                    case 5125:
                                        d = new Uint32Array(a(4 * c), 0, c);
                                        break;
                                    case 5126:
                                        d = new Float32Array(a(4 * c), 0, c);
                                        break;
                                    default:
                                        return null
                                }
                                return d.length !==
                                    c ? d.subarray(0, c) : d
                            },
                            freeType: function(a) {
                                b(a.buffer)
                            }
                        }
                    }

                    function da(a) {
                        return !!a && "object" === typeof a && Array.isArray(a.shape) && Array.isArray(a.stride) && "number" === typeof a.offset && a.shape.length === a.stride.length && (Array.isArray(a.data) || M(a.data))
                    }

                    function ib(a, b, c, e, f, d) {
                        for (var p = 0; p < b; ++p)
                            for (var n = a[p], u = 0; u < c; ++u)
                                for (var t = n[u], w = 0; w < e; ++w) f[d++] = t[w]
                    }

                    function jb(a, b, c, e, f) {
                        for (var d = 1, p = c + 1; p < b.length; ++p) d *= b[p];
                        var n = b[c];
                        if (4 === b.length - c) {
                            var u = b[c + 1],
                                t = b[c + 2];
                            b = b[c + 3];
                            for (p = 0; p < n; ++p) ib(a[p],
                                u, t, b, e, f), f += d
                        } else
                            for (p = 0; p < n; ++p) jb(a[p], b, c + 1, e, f), f += d
                    }

                    function Fa(a) {
                        return Ga[Object.prototype.toString.call(a)] | 0
                    }

                    function kb(a, b) {
                        for (var c = 0; c < b.length; ++c) a[c] = b[c]
                    }

                    function lb(a, b, c, e, f, d, p) {
                        for (var n = 0, u = 0; u < c; ++u)
                            for (var t = 0; t < e; ++t) a[n++] = b[f * u + d * t + p]
                    }

                    function Kb(a, b, c, e) {
                        function f(b) {
                            this.id = u++;
                            this.buffer = a.createBuffer();
                            this.type = b;
                            this.usage = 35044;
                            this.byteLength = 0;
                            this.dimension = 1;
                            this.dtype = 5121;
                            this.persistentData = null;
                            c.profile && (this.stats = {
                                size: 0
                            })
                        }

                        function d(b, c, l) {
                            b.byteLength =
                                c.byteLength;
                            a.bufferData(b.type, c, l)
                        }

                        function p(a, b, c, h, g, q) {
                            a.usage = c;
                            if (Array.isArray(b)) {
                                if (a.dtype = h || 5126, 0 < b.length)
                                    if (Array.isArray(b[0])) {
                                        g = mb(b);
                                        for (var r = h = 1; r < g.length; ++r) h *= g[r];
                                        a.dimension = h;
                                        b = Sa(b, g, a.dtype);
                                        d(a, b, c);
                                        q ? a.persistentData = b : E.freeType(b)
                                    } else "number" === typeof b[0] ? (a.dimension = g, g = E.allocType(a.dtype, b.length), kb(g, b), d(a, g, c), q ? a.persistentData = g : E.freeType(g)) : M(b[0]) && (a.dimension = b[0].length, a.dtype = h || Fa(b[0]) || 5126, b = Sa(b, [b.length, b[0].length], a.dtype), d(a, b, c),
                                        q ? a.persistentData = b : E.freeType(b))
                            } else if (M(b)) a.dtype = h || Fa(b), a.dimension = g, d(a, b, c), q && (a.persistentData = new Uint8Array(new Uint8Array(b.buffer)));
                            else if (da(b)) {
                                g = b.shape;
                                var m = b.stride,
                                    r = b.offset,
                                    e = 0,
                                    f = 0,
                                    t = 0,
                                    n = 0;
                                1 === g.length ? (e = g[0], f = 1, t = m[0], n = 0) : 2 === g.length && (e = g[0], f = g[1], t = m[0], n = m[1]);
                                a.dtype = h || Fa(b.data) || 5126;
                                a.dimension = f;
                                g = E.allocType(a.dtype, e * f);
                                lb(g, b.data, e, f, t, n, r);
                                d(a, g, c);
                                q ? a.persistentData = g : E.freeType(g)
                            } else b instanceof ArrayBuffer && (a.dtype = 5121, a.dimension = g, d(a, b,
                                c), q && (a.persistentData = new Uint8Array(new Uint8Array(b))))
                        }

                        function n(c) {
                            b.bufferCount--;
                            e(c);
                            a.deleteBuffer(c.buffer);
                            c.buffer = null;
                            delete t[c.id]
                        }
                        var u = 0,
                            t = {};
                        f.prototype.bind = function() {
                            a.bindBuffer(this.type, this.buffer)
                        };
                        f.prototype.destroy = function() {
                            n(this)
                        };
                        var w = [];
                        c.profile && (b.getTotalBufferSize = function() {
                            var a = 0;
                            Object.keys(t).forEach(function(b) {
                                a += t[b].stats.size
                            });
                            return a
                        });
                        return {
                            create: function(k, e, d, h) {
                                function g(b) {
                                    var m = 35044,
                                        k = null,
                                        e = 0,
                                        d = 0,
                                        f = 1;
                                    Array.isArray(b) || M(b) || da(b) ||
                                        b instanceof ArrayBuffer ? k = b : "number" === typeof b ? e = b | 0 : b && ("data" in b && (k = b.data), "usage" in b && (m = ob[b.usage]), "type" in b && (d = Ia[b.type]), "dimension" in b && (f = b.dimension | 0), "length" in b && (e = b.length | 0));
                                    q.bind();
                                    k ? p(q, k, m, d, f, h) : (e && a.bufferData(q.type, e, m), q.dtype = d || 5121, q.usage = m, q.dimension = f, q.byteLength = e);
                                    c.profile && (q.stats.size = q.byteLength * ha[q.dtype]);
                                    return g
                                }
                                b.bufferCount++;
                                var q = new f(e);
                                t[q.id] = q;
                                d || g(k);
                                g._reglType = "buffer";
                                g._buffer = q;
                                g.subdata = function(b, c) {
                                    var k = (c || 0) | 0,
                                        e;
                                    q.bind();
                                    if (M(b) || b instanceof ArrayBuffer) a.bufferSubData(q.type, k, b);
                                    else if (Array.isArray(b)) {
                                        if (0 < b.length)
                                            if ("number" === typeof b[0]) {
                                                var h = E.allocType(q.dtype, b.length);
                                                kb(h, b);
                                                a.bufferSubData(q.type, k, h);
                                                E.freeType(h)
                                            } else if (Array.isArray(b[0]) || M(b[0])) e = mb(b), h = Sa(b, e, q.dtype), a.bufferSubData(q.type, k, h), E.freeType(h)
                                    } else if (da(b)) {
                                        e = b.shape;
                                        var d = b.stride,
                                            f = h = 0,
                                            l = 0,
                                            O = 0;
                                        1 === e.length ? (h = e[0], f = 1, l = d[0], O = 0) : 2 === e.length && (h = e[0], f = e[1], l = d[0], O = d[1]);
                                        e = Array.isArray(b.data) ? q.dtype : Fa(b.data);
                                        e = E.allocType(e,
                                            h * f);
                                        lb(e, b.data, h, f, l, O, b.offset);
                                        a.bufferSubData(q.type, k, e);
                                        E.freeType(e)
                                    }
                                    return g
                                };
                                c.profile && (g.stats = q.stats);
                                g.destroy = function() {
                                    n(q)
                                };
                                return g
                            },
                            createStream: function(a, b) {
                                var c = w.pop();
                                c || (c = new f(a));
                                c.bind();
                                p(c, b, 35040, 0, 1, !1);
                                return c
                            },
                            destroyStream: function(a) {
                                w.push(a)
                            },
                            clear: function() {
                                S(t).forEach(n);
                                w.forEach(n)
                            },
                            getBuffer: function(a) {
                                return a && a._buffer instanceof f ? a._buffer : null
                            },
                            restore: function() {
                                S(t).forEach(function(b) {
                                    b.buffer = a.createBuffer();
                                    a.bindBuffer(b.type, b.buffer);
                                    a.bufferData(b.type, b.persistentData || b.byteLength, b.usage)
                                })
                            },
                            _initBuffer: p
                        }
                    }

                    function Lb(a, b, c, e) {
                        function f(a) {
                            this.id = u++;
                            n[this.id] = this;
                            this.buffer = a;
                            this.primType = 4;
                            this.type = this.vertCount = 0
                        }

                        function d(e, d, f, h, g, q, r) {
                            e.buffer.bind();
                            var m;
                            d ? ((m = r) || M(d) && (!da(d) || M(d.data)) || (m = b.oes_element_index_uint ? 5125 : 5123), c._initBuffer(e.buffer, d, f, m, 3)) : (a.bufferData(34963, q, f), e.buffer.dtype = m || 5121, e.buffer.usage = f, e.buffer.dimension = 3, e.buffer.byteLength = q);
                            m = r;
                            if (!r) {
                                switch (e.buffer.dtype) {
                                    case 5121:
                                    case 5120:
                                        m =
                                            5121;
                                        break;
                                    case 5123:
                                    case 5122:
                                        m = 5123;
                                        break;
                                    case 5125:
                                    case 5124:
                                        m = 5125
                                }
                                e.buffer.dtype = m
                            }
                            e.type = m;
                            d = g;
                            0 > d && (d = e.buffer.byteLength, 5123 === m ? d >>= 1 : 5125 === m && (d >>= 2));
                            e.vertCount = d;
                            d = h;
                            0 > h && (d = 4, h = e.buffer.dimension, 1 === h && (d = 0), 2 === h && (d = 1), 3 === h && (d = 4));
                            e.primType = d
                        }

                        function p(a) {
                            e.elementsCount--;
                            delete n[a.id];
                            a.buffer.destroy();
                            a.buffer = null
                        }
                        var n = {},
                            u = 0,
                            t = {
                                uint8: 5121,
                                uint16: 5123
                            };
                        b.oes_element_index_uint && (t.uint32 = 5125);
                        f.prototype.bind = function() {
                            this.buffer.bind()
                        };
                        var w = [];
                        return {
                            create: function(a,
                                b) {
                                function l(a) {
                                    if (a)
                                        if ("number" === typeof a) h(a), g.primType = 4, g.vertCount = a | 0, g.type = 5121;
                                        else {
                                            var b = null,
                                                c = 35044,
                                                e = -1,
                                                f = -1,
                                                k = 0,
                                                n = 0;
                                            if (Array.isArray(a) || M(a) || da(a)) b = a;
                                            else if ("data" in a && (b = a.data), "usage" in a && (c = ob[a.usage]), "primitive" in a && (e = Ta[a.primitive]), "count" in a && (f = a.count | 0), "type" in a && (n = t[a.type]), "length" in a) k = a.length | 0;
                                            else if (k = f, 5123 === n || 5122 === n) k *= 2;
                                            else if (5125 === n || 5124 === n) k *= 4;
                                            d(g, b, c, e, f, k, n)
                                        }
                                    else h(), g.primType = 4, g.vertCount = 0, g.type = 5121;
                                    return l
                                }
                                var h = c.create(null,
                                        34963, !0),
                                    g = new f(h._buffer);
                                e.elementsCount++;
                                l(a);
                                l._reglType = "elements";
                                l._elements = g;
                                l.subdata = function(a, b) {
                                    h.subdata(a, b);
                                    return l
                                };
                                l.destroy = function() {
                                    p(g)
                                };
                                return l
                            },
                            createStream: function(a) {
                                var b = w.pop();
                                b || (b = new f(c.create(null, 34963, !0, !1)._buffer));
                                d(b, a, 35040, -1, -1, 0, 0);
                                return b
                            },
                            destroyStream: function(a) {
                                w.push(a)
                            },
                            getElements: function(a) {
                                return "function" === typeof a && a._elements instanceof f ? a._elements : null
                            },
                            clear: function() {
                                S(n).forEach(p)
                            }
                        }
                    }

                    function pb(a) {
                        for (var b = E.allocType(5123,
                                a.length), c = 0; c < a.length; ++c)
                            if (isNaN(a[c])) b[c] = 65535;
                            else if (Infinity === a[c]) b[c] = 31744;
                        else if (-Infinity === a[c]) b[c] = 64512;
                        else {
                            qb[0] = a[c];
                            var e = Mb[0],
                                f = e >>> 31 << 15,
                                d = (e << 1 >>> 24) - 127,
                                e = e >> 13 & 1023;
                            b[c] = -24 > d ? f : -14 > d ? f + (e + 1024 >> -14 - d) : 15 < d ? f + 31744 : f + (d + 15 << 10) + e
                        }
                        return b
                    }

                    function ma(a) {
                        return Array.isArray(a) || M(a)
                    }

                    function na(a) {
                        return "[object " + a + "]"
                    }

                    function rb(a) {
                        return Array.isArray(a) && (0 === a.length || "number" === typeof a[0])
                    }

                    function sb(a) {
                        return Array.isArray(a) && 0 !== a.length && ma(a[0]) ? !0 : !1
                    }

                    function ea(a) {
                        return Object.prototype.toString.call(a)
                    }

                    function Ua(a) {
                        if (!a) return !1;
                        var b = ea(a);
                        return 0 <= Nb.indexOf(b) ? !0 : rb(a) || sb(a) || da(a)
                    }

                    function tb(a, b) {
                        36193 === a.type ? (a.data = pb(b), E.freeType(b)) : a.data = b
                    }

                    function Ja(a, b, c, e, f, d) {
                        a = "undefined" !== typeof F[a] ? F[a] : Q[a] * wa[b];
                        d && (a *= 6);
                        if (f) {
                            for (e = 0; 1 <= c;) e += a * c * c, c /= 2;
                            return e
                        }
                        return a * c * e
                    }

                    function Ob(a, b, c, e, f, d, p) {
                        function n() {
                            this.format = this.internalformat = 6408;
                            this.type = 5121;
                            this.flipY = this.premultiplyAlpha = this.compressed = !1;
                            this.unpackAlignment =
                                1;
                            this.colorSpace = 37444;
                            this.channels = this.height = this.width = 0
                        }

                        function u(a, b) {
                            a.internalformat = b.internalformat;
                            a.format = b.format;
                            a.type = b.type;
                            a.compressed = b.compressed;
                            a.premultiplyAlpha = b.premultiplyAlpha;
                            a.flipY = b.flipY;
                            a.unpackAlignment = b.unpackAlignment;
                            a.colorSpace = b.colorSpace;
                            a.width = b.width;
                            a.height = b.height;
                            a.channels = b.channels
                        }

                        function t(a, b) {
                            if ("object" === typeof b && b) {
                                "premultiplyAlpha" in b && (a.premultiplyAlpha = b.premultiplyAlpha);
                                "flipY" in b && (a.flipY = b.flipY);
                                "alignment" in b && (a.unpackAlignment =
                                    b.alignment);
                                "colorSpace" in b && (a.colorSpace = Pb[b.colorSpace]);
                                "type" in b && (a.type = N[b.type]);
                                var c = a.width,
                                    g = a.height,
                                    e = a.channels,
                                    d = !1;
                                "shape" in b ? (c = b.shape[0], g = b.shape[1], 3 === b.shape.length && (e = b.shape[2], d = !0)) : ("radius" in b && (c = g = b.radius), "width" in b && (c = b.width), "height" in b && (g = b.height), "channels" in b && (e = b.channels, d = !0));
                                a.width = c | 0;
                                a.height = g | 0;
                                a.channels = e | 0;
                                c = !1;
                                "format" in b && (c = b.format, g = a.internalformat = C[c], a.format = P[g], c in N && !("type" in b) && (a.type = N[c]), c in v && (a.compressed = !0), c = !0);
                                !d && c ? a.channels = Q[a.format] : d && !c && a.channels !== Ma[a.format] && (a.format = a.internalformat = Ma[a.channels])
                            }
                        }

                        function w(b) {
                            a.pixelStorei(37440, b.flipY);
                            a.pixelStorei(37441, b.premultiplyAlpha);
                            a.pixelStorei(37443, b.colorSpace);
                            a.pixelStorei(3317, b.unpackAlignment)
                        }

                        function k() {
                            n.call(this);
                            this.yOffset = this.xOffset = 0;
                            this.data = null;
                            this.needsFree = !1;
                            this.element = null;
                            this.needsCopy = !1
                        }

                        function B(a, b) {
                            var c = null;
                            Ua(b) ? c = b : b && (t(a, b), "x" in b && (a.xOffset = b.x | 0), "y" in b && (a.yOffset = b.y | 0), Ua(b.data) &&
                                (c = b.data));
                            if (b.copy) {
                                var g = f.viewportWidth,
                                    e = f.viewportHeight;
                                a.width = a.width || g - a.xOffset;
                                a.height = a.height || e - a.yOffset;
                                a.needsCopy = !0
                            } else if (!c) a.width = a.width || 1, a.height = a.height || 1, a.channels = a.channels || 4;
                            else if (M(c)) a.channels = a.channels || 4, a.data = c, "type" in b || 5121 !== a.type || (a.type = Ga[Object.prototype.toString.call(c)] | 0);
                            else if (rb(c)) {
                                a.channels = a.channels || 4;
                                g = c;
                                e = g.length;
                                switch (a.type) {
                                    case 5121:
                                    case 5123:
                                    case 5125:
                                    case 5126:
                                        e = E.allocType(a.type, e);
                                        e.set(g);
                                        a.data = e;
                                        break;
                                    case 36193:
                                        a.data =
                                            pb(g)
                                }
                                a.alignment = 1;
                                a.needsFree = !0
                            } else if (da(c)) {
                                g = c.data;
                                Array.isArray(g) || 5121 !== a.type || (a.type = Ga[Object.prototype.toString.call(g)] | 0);
                                var e = c.shape,
                                    d = c.stride,
                                    h, r, m, q;
                                3 === e.length ? (m = e[2], q = d[2]) : q = m = 1;
                                h = e[0];
                                r = e[1];
                                e = d[0];
                                d = d[1];
                                a.alignment = 1;
                                a.width = h;
                                a.height = r;
                                a.channels = m;
                                a.format = a.internalformat = Ma[m];
                                a.needsFree = !0;
                                h = q;
                                c = c.offset;
                                m = a.width;
                                q = a.height;
                                r = a.channels;
                                for (var x = E.allocType(36193 === a.type ? 5126 : a.type, m * q * r), I = 0, ja = 0; ja < q; ++ja)
                                    for (var ka = 0; ka < m; ++ka)
                                        for (var Va = 0; Va < r; ++Va) x[I++] =
                                            g[e * ka + d * ja + h * Va + c];
                                tb(a, x)
                            } else if (ea(c) === Wa || ea(c) === Xa || ea(c) === vb) ea(c) === Wa || ea(c) === Xa ? a.element = c : a.element = c.canvas, a.width = a.element.width, a.height = a.element.height, a.channels = 4;
                            else if (ea(c) === wb) a.element = c, a.width = c.width, a.height = c.height, a.channels = 4;
                            else if (ea(c) === xb) a.element = c, a.width = c.naturalWidth, a.height = c.naturalHeight, a.channels = 4;
                            else if (ea(c) === yb) a.element = c, a.width = c.videoWidth, a.height = c.videoHeight, a.channels = 4;
                            else if (sb(c)) {
                                g = a.width || c[0].length;
                                e = a.height || c.length;
                                d = a.channels;
                                d = ma(c[0][0]) ? d || c[0][0].length : d || 1;
                                h = Oa.shape(c);
                                m = 1;
                                for (q = 0; q < h.length; ++q) m *= h[q];
                                m = E.allocType(36193 === a.type ? 5126 : a.type, m);
                                Oa.flatten(c, h, "", m);
                                tb(a, m);
                                a.alignment = 1;
                                a.width = g;
                                a.height = e;
                                a.channels = d;
                                a.format = a.internalformat = Ma[d];
                                a.needsFree = !0
                            }
                        }

                        function l(b, c, g, d, h) {
                            var m = b.element,
                                f = b.data,
                                r = b.internalformat,
                                q = b.format,
                                l = b.type,
                                x = b.width,
                                I = b.height;
                            w(b);
                            m ? a.texSubImage2D(c, h, g, d, q, l, m) : b.compressed ? a.compressedTexSubImage2D(c, h, g, d, r, x, I, f) : b.needsCopy ? (e(), a.copyTexSubImage2D(c,
                                h, g, d, b.xOffset, b.yOffset, x, I)) : a.texSubImage2D(c, h, g, d, x, I, q, l, f)
                        }

                        function h() {
                            return J.pop() || new k
                        }

                        function g(a) {
                            a.needsFree && E.freeType(a.data);
                            k.call(a);
                            J.push(a)
                        }

                        function q() {
                            n.call(this);
                            this.genMipmaps = !1;
                            this.mipmapHint = 4352;
                            this.mipmask = 0;
                            this.images = Array(16)
                        }

                        function r(a, b, c) {
                            var g = a.images[0] = h();
                            a.mipmask = 1;
                            g.width = a.width = b;
                            g.height = a.height = c;
                            g.channels = a.channels = 4
                        }

                        function m(a, b) {
                            var c = null;
                            if (Ua(b)) c = a.images[0] = h(), u(c, a), B(c, b), a.mipmask = 1;
                            else if (t(a, b), Array.isArray(b.mipmap))
                                for (var g =
                                        b.mipmap, e = 0; e < g.length; ++e) c = a.images[e] = h(), u(c, a), c.width >>= e, c.height >>= e, B(c, g[e]), a.mipmask |= 1 << e;
                            else c = a.images[0] = h(), u(c, a), B(c, b), a.mipmask = 1;
                            u(a, a.images[0])
                        }

                        function z(b, c) {
                            for (var g = b.images, d = 0; d < g.length && g[d]; ++d) {
                                var h = g[d],
                                    m = c,
                                    f = d,
                                    r = h.element,
                                    q = h.data,
                                    l = h.internalformat,
                                    x = h.format,
                                    I = h.type,
                                    ja = h.width,
                                    ka = h.height;
                                w(h);
                                r ? a.texImage2D(m, f, x, x, I, r) : h.compressed ? a.compressedTexImage2D(m, f, l, ja, ka, 0, q) : h.needsCopy ? (e(), a.copyTexImage2D(m, f, x, h.xOffset, h.yOffset, ja, ka, 0)) : a.texImage2D(m,
                                    f, x, ja, ka, 0, x, I, q || null)
                            }
                        }

                        function Ha() {
                            var a = L.pop() || new q;
                            n.call(a);
                            for (var b = a.mipmask = 0; 16 > b; ++b) a.images[b] = null;
                            return a
                        }

                        function nb(a) {
                            for (var b = a.images, c = 0; c < b.length; ++c) b[c] && g(b[c]), b[c] = null;
                            L.push(a)
                        }

                        function Z() {
                            this.magFilter = this.minFilter = 9728;
                            this.wrapT = this.wrapS = 33071;
                            this.anisotropic = 1;
                            this.genMipmaps = !1;
                            this.mipmapHint = 4352
                        }

                        function G(a, b) {
                            "min" in b && (a.minFilter = R[b.min], 0 <= Qb.indexOf(a.minFilter) && !("faces" in b) && (a.genMipmaps = !0));
                            "mag" in b && (a.magFilter = V[b.mag]);
                            var c =
                                a.wrapS,
                                g = a.wrapT;
                            if ("wrap" in b) {
                                var e = b.wrap;
                                "string" === typeof e ? c = g = la[e] : Array.isArray(e) && (c = la[e[0]], g = la[e[1]])
                            } else "wrapS" in b && (c = la[b.wrapS]), "wrapT" in b && (g = la[b.wrapT]);
                            a.wrapS = c;
                            a.wrapT = g;
                            "anisotropic" in b && (a.anisotropic = b.anisotropic);
                            if ("mipmap" in b) {
                                c = !1;
                                switch (typeof b.mipmap) {
                                    case "string":
                                        a.mipmapHint = y[b.mipmap];
                                        c = a.genMipmaps = !0;
                                        break;
                                    case "boolean":
                                        c = a.genMipmaps = b.mipmap;
                                        break;
                                    case "object":
                                        a.genMipmaps = !1, c = !0
                                }!c || "min" in b || (a.minFilter = 9984)
                            }
                        }

                        function H(c, g) {
                            a.texParameteri(g,
                                10241, c.minFilter);
                            a.texParameteri(g, 10240, c.magFilter);
                            a.texParameteri(g, 10242, c.wrapS);
                            a.texParameteri(g, 10243, c.wrapT);
                            b.ext_texture_filter_anisotropic && a.texParameteri(g, 34046, c.anisotropic);
                            c.genMipmaps && (a.hint(33170, c.mipmapHint), a.generateMipmap(g))
                        }

                        function O(b) {
                            n.call(this);
                            this.mipmask = 0;
                            this.internalformat = 6408;
                            this.id = Y++;
                            this.refCount = 1;
                            this.target = b;
                            this.texture = a.createTexture();
                            this.unit = -1;
                            this.bindCount = 0;
                            this.texInfo = new Z;
                            p.profile && (this.stats = {
                                size: 0
                            })
                        }

                        function xa(b) {
                            a.activeTexture(33984);
                            a.bindTexture(b.target, b.texture)
                        }

                        function ya() {
                            var b = W[0];
                            b ? a.bindTexture(b.target, b.texture) : a.bindTexture(3553, null)
                        }

                        function D(b) {
                            var c = b.texture,
                                g = b.unit,
                                e = b.target;
                            0 <= g && (a.activeTexture(33984 + g), a.bindTexture(e, null), W[g] = null);
                            a.deleteTexture(c);
                            b.texture = null;
                            b.params = null;
                            b.pixels = null;
                            b.refCount = 0;
                            delete ia[b.id];
                            d.textureCount--
                        }
                        var y = {
                                "don't care": 4352,
                                "dont care": 4352,
                                nice: 4354,
                                fast: 4353
                            },
                            la = {
                                repeat: 10497,
                                clamp: 33071,
                                mirror: 33648
                            },
                            V = {
                                nearest: 9728,
                                linear: 9729
                            },
                            R = A({
                                mipmap: 9987,
                                "nearest mipmap nearest": 9984,
                                "linear mipmap nearest": 9985,
                                "nearest mipmap linear": 9986,
                                "linear mipmap linear": 9987
                            }, V),
                            Pb = {
                                none: 0,
                                browser: 37444
                            },
                            N = {
                                uint8: 5121,
                                rgba4: 32819,
                                rgb565: 33635,
                                "rgb5 a1": 32820
                            },
                            C = {
                                alpha: 6406,
                                luminance: 6409,
                                "luminance alpha": 6410,
                                rgb: 6407,
                                rgba: 6408,
                                rgba4: 32854,
                                "rgb5 a1": 32855,
                                rgb565: 36194
                            },
                            v = {};
                        b.ext_srgb && (C.srgb = 35904, C.srgba = 35906);
                        b.oes_texture_float && (N.float32 = N["float"] = 5126);
                        b.oes_texture_half_float && (N.float16 = N["half float"] = 36193);
                        b.webgl_depth_texture && (A(C, {
                                depth: 6402,
                                "depth stencil": 34041
                            }),
                            A(N, {
                                uint16: 5123,
                                uint32: 5125,
                                "depth stencil": 34042
                            }));
                        b.webgl_compressed_texture_s3tc && A(v, {
                            "rgb s3tc dxt1": 33776,
                            "rgba s3tc dxt1": 33777,
                            "rgba s3tc dxt3": 33778,
                            "rgba s3tc dxt5": 33779
                        });
                        b.webgl_compressed_texture_atc && A(v, {
                            "rgb atc": 35986,
                            "rgba atc explicit alpha": 35987,
                            "rgba atc interpolated alpha": 34798
                        });
                        b.webgl_compressed_texture_pvrtc && A(v, {
                            "rgb pvrtc 4bppv1": 35840,
                            "rgb pvrtc 2bppv1": 35841,
                            "rgba pvrtc 4bppv1": 35842,
                            "rgba pvrtc 2bppv1": 35843
                        });
                        b.webgl_compressed_texture_etc1 && (v["rgb etc1"] = 36196);
                        var F = Array.prototype.slice.call(a.getParameter(34467));
                        Object.keys(v).forEach(function(a) {
                            var b = v[a];
                            0 <= F.indexOf(b) && (C[a] = b)
                        });
                        var ta = Object.keys(C);
                        c.textureFormats = ta;
                        var aa = [];
                        Object.keys(C).forEach(function(a) {
                            aa[C[a]] = a
                        });
                        var K = [];
                        Object.keys(N).forEach(function(a) {
                            K[N[a]] = a
                        });
                        var fa = [];
                        Object.keys(V).forEach(function(a) {
                            fa[V[a]] = a
                        });
                        var Da = [];
                        Object.keys(R).forEach(function(a) {
                            Da[R[a]] = a
                        });
                        var ua = [];
                        Object.keys(la).forEach(function(a) {
                            ua[la[a]] = a
                        });
                        var P = ta.reduce(function(a, c) {
                                var g = C[c];
                                6409 === g || 6406 === g || 6409 === g || 6410 === g || 6402 === g || 34041 === g || b.ext_srgb && (35904 === g || 35906 === g) ? a[g] = g : 32855 === g || 0 <= c.indexOf("rgba") ? a[g] = 6408 : a[g] = 6407;
                                return a
                            }, {}),
                            J = [],
                            L = [],
                            Y = 0,
                            ia = {},
                            ga = c.maxTextureUnits,
                            W = Array(ga).map(function() {
                                return null
                            });
                        A(O.prototype, {
                            bind: function() {
                                this.bindCount += 1;
                                var b = this.unit;
                                if (0 > b) {
                                    for (var c = 0; c < ga; ++c) {
                                        var g = W[c];
                                        if (g) {
                                            if (0 < g.bindCount) continue;
                                            g.unit = -1
                                        }
                                        W[c] = this;
                                        b = c;
                                        break
                                    }
                                    p.profile && d.maxTextureUnits < b + 1 && (d.maxTextureUnits = b + 1);
                                    this.unit = b;
                                    a.activeTexture(33984 +
                                        b);
                                    a.bindTexture(this.target, this.texture)
                                }
                                return b
                            },
                            unbind: function() {
                                --this.bindCount
                            },
                            decRef: function() {
                                0 >= --this.refCount && D(this)
                            }
                        });
                        p.profile && (d.getTotalTextureSize = function() {
                            var a = 0;
                            Object.keys(ia).forEach(function(b) {
                                a += ia[b].stats.size
                            });
                            return a
                        });
                        return {
                            create2D: function(b, c) {
                                function e(a, b) {
                                    var c = f.texInfo;
                                    Z.call(c);
                                    var g = Ha();
                                    "number" === typeof a ? "number" === typeof b ? r(g, a | 0, b | 0) : r(g, a | 0, a | 0) : a ? (G(c, a), m(g, a)) : r(g, 1, 1);
                                    c.genMipmaps && (g.mipmask = (g.width << 1) - 1);
                                    f.mipmask = g.mipmask;
                                    u(f,
                                        g);
                                    f.internalformat = g.internalformat;
                                    e.width = g.width;
                                    e.height = g.height;
                                    xa(f);
                                    z(g, 3553);
                                    H(c, 3553);
                                    ya();
                                    nb(g);
                                    p.profile && (f.stats.size = Ja(f.internalformat, f.type, g.width, g.height, c.genMipmaps, !1));
                                    e.format = aa[f.internalformat];
                                    e.type = K[f.type];
                                    e.mag = fa[c.magFilter];
                                    e.min = Da[c.minFilter];
                                    e.wrapS = ua[c.wrapS];
                                    e.wrapT = ua[c.wrapT];
                                    return e
                                }
                                var f = new O(3553);
                                ia[f.id] = f;
                                d.textureCount++;
                                e(b, c);
                                e.subimage = function(a, b, c, d) {
                                    b |= 0;
                                    c |= 0;
                                    d |= 0;
                                    var m = h();
                                    u(m, f);
                                    m.width = 0;
                                    m.height = 0;
                                    B(m, a);
                                    m.width = m.width || (f.width >>
                                        d) - b;
                                    m.height = m.height || (f.height >> d) - c;
                                    xa(f);
                                    l(m, 3553, b, c, d);
                                    ya();
                                    g(m);
                                    return e
                                };
                                e.resize = function(b, c) {
                                    var g = b | 0,
                                        d = c | 0 || g;
                                    if (g === f.width && d === f.height) return e;
                                    e.width = f.width = g;
                                    e.height = f.height = d;
                                    xa(f);
                                    for (var h = 0; f.mipmask >> h; ++h) {
                                        var m = g >> h,
                                            x = d >> h;
                                        if (!m || !x) break;
                                        a.texImage2D(3553, h, f.format, m, x, 0, f.format, f.type, null)
                                    }
                                    ya();
                                    p.profile && (f.stats.size = Ja(f.internalformat, f.type, g, d, !1, !1));
                                    return e
                                };
                                e._reglType = "texture2d";
                                e._texture = f;
                                p.profile && (e.stats = f.stats);
                                e.destroy = function() {
                                    f.decRef()
                                };
                                return e
                            },
                            createCube: function(b, c, e, f, q, n) {
                                function k(a, b, c, g, e, d) {
                                    var f, ca = y.texInfo;
                                    Z.call(ca);
                                    for (f = 0; 6 > f; ++f) D[f] = Ha();
                                    if ("number" === typeof a || !a)
                                        for (a = a | 0 || 1, f = 0; 6 > f; ++f) r(D[f], a, a);
                                    else if ("object" === typeof a)
                                        if (b) m(D[0], a), m(D[1], b), m(D[2], c), m(D[3], g), m(D[4], e), m(D[5], d);
                                        else if (G(ca, a), t(y, a), "faces" in a)
                                        for (a = a.faces, f = 0; 6 > f; ++f) u(D[f], y), m(D[f], a[f]);
                                    else
                                        for (f = 0; 6 > f; ++f) m(D[f], a);
                                    u(y, D[0]);
                                    y.mipmask = ca.genMipmaps ? (D[0].width << 1) - 1 : D[0].mipmask;
                                    y.internalformat = D[0].internalformat;
                                    k.width =
                                        D[0].width;
                                    k.height = D[0].height;
                                    xa(y);
                                    for (f = 0; 6 > f; ++f) z(D[f], 34069 + f);
                                    H(ca, 34067);
                                    ya();
                                    p.profile && (y.stats.size = Ja(y.internalformat, y.type, k.width, k.height, ca.genMipmaps, !0));
                                    k.format = aa[y.internalformat];
                                    k.type = K[y.type];
                                    k.mag = fa[ca.magFilter];
                                    k.min = Da[ca.minFilter];
                                    k.wrapS = ua[ca.wrapS];
                                    k.wrapT = ua[ca.wrapT];
                                    for (f = 0; 6 > f; ++f) nb(D[f]);
                                    return k
                                }
                                var y = new O(34067);
                                ia[y.id] = y;
                                d.cubeCount++;
                                var D = Array(6);
                                k(b, c, e, f, q, n);
                                k.subimage = function(a, b, c, e, f) {
                                    c |= 0;
                                    e |= 0;
                                    f |= 0;
                                    var d = h();
                                    u(d, y);
                                    d.width = 0;
                                    d.height = 0;
                                    B(d, b);
                                    d.width = d.width || (y.width >> f) - c;
                                    d.height = d.height || (y.height >> f) - e;
                                    xa(y);
                                    l(d, 34069 + a, c, e, f);
                                    ya();
                                    g(d);
                                    return k
                                };
                                k.resize = function(b) {
                                    b |= 0;
                                    if (b !== y.width) {
                                        k.width = y.width = b;
                                        k.height = y.height = b;
                                        xa(y);
                                        for (var c = 0; 6 > c; ++c)
                                            for (var g = 0; y.mipmask >> g; ++g) a.texImage2D(34069 + c, g, y.format, b >> g, b >> g, 0, y.format, y.type, null);
                                        ya();
                                        p.profile && (y.stats.size = Ja(y.internalformat, y.type, k.width, k.height, !1, !0));
                                        return k
                                    }
                                };
                                k._reglType = "textureCube";
                                k._texture = y;
                                p.profile && (k.stats = y.stats);
                                k.destroy = function() {
                                    y.decRef()
                                };
                                return k
                            },
                            clear: function() {
                                for (var b = 0; b < ga; ++b) a.activeTexture(33984 + b), a.bindTexture(3553, null), W[b] = null;
                                S(ia).forEach(D);
                                d.cubeCount = 0;
                                d.textureCount = 0
                            },
                            getTexture: function(a) {
                                return null
                            },
                            restore: function() {
                                for (var b = 0; b < ga; ++b) {
                                    var c = W[b];
                                    c && (c.bindCount = 0, c.unit = -1, W[b] = null)
                                }
                                S(ia).forEach(function(b) {
                                    b.texture = a.createTexture();
                                    a.bindTexture(b.target, b.texture);
                                    for (var c = 0; 32 > c; ++c)
                                        if (0 !== (b.mipmask & 1 << c))
                                            if (3553 === b.target) a.texImage2D(3553, c, b.internalformat, b.width >> c, b.height >> c, 0, b.internalformat,
                                                b.type, null);
                                            else
                                                for (var g = 0; 6 > g; ++g) a.texImage2D(34069 + g, c, b.internalformat, b.width >> c, b.height >> c, 0, b.internalformat, b.type, null);
                                    H(b.texInfo, b.target)
                                })
                            },
                            refresh: function() {
                                for (var b = 0; b < ga; ++b) {
                                    var c = W[b];
                                    c && (c.bindCount = 0, c.unit = -1, W[b] = null);
                                    a.activeTexture(33984 + b);
                                    a.bindTexture(3553, null);
                                    a.bindTexture(34067, null)
                                }
                            }
                        }
                    }

                    function Rb(a, b, c, e, f, d) {
                        function p(a, b, c) {
                            this.target = a;
                            this.texture = b;
                            this.renderbuffer = c;
                            var g = a = 0;
                            b ? (a = b.width, g = b.height) : c && (a = c.width, g = c.height);
                            this.width = a;
                            this.height =
                                g
                        }

                        function n(a) {
                            a && (a.texture && a.texture._texture.decRef(), a.renderbuffer && a.renderbuffer._renderbuffer.decRef())
                        }

                        function u(a, b, c) {
                            a && (a.texture ? a.texture._texture.refCount += 1 : a.renderbuffer._renderbuffer.refCount += 1)
                        }

                        function t(b, c) {
                            c && (c.texture ? a.framebufferTexture2D(36160, b, c.target, c.texture._texture.texture, 0) : a.framebufferRenderbuffer(36160, b, 36161, c.renderbuffer._renderbuffer.renderbuffer))
                        }

                        function w(a) {
                            var b = 3553,
                                c = null,
                                g = null,
                                e = a;
                            "object" === typeof a && (e = a.data, "target" in a && (b = a.target |
                                0));
                            a = e._reglType;
                            "texture2d" === a ? c = e : "textureCube" === a ? c = e : "renderbuffer" === a && (g = e, b = 36161);
                            return new p(b, c, g)
                        }

                        function k(a, b, c, g, d) {
                            if (c) return a = e.create2D({
                                width: a,
                                height: b,
                                format: g,
                                type: d
                            }), a._texture.refCount = 0, new p(3553, a, null);
                            a = f.create({
                                width: a,
                                height: b,
                                format: g
                            });
                            a._renderbuffer.refCount = 0;
                            return new p(36161, null, a)
                        }

                        function B(a) {
                            return a && (a.texture || a.renderbuffer)
                        }

                        function l(a, b, c) {
                            a && (a.texture ? a.texture.resize(b, c) : a.renderbuffer && a.renderbuffer.resize(b, c), a.width = b, a.height = c)
                        }

                        function h() {
                            this.id = G++;
                            H[this.id] = this;
                            this.framebuffer = a.createFramebuffer();
                            this.height = this.width = 0;
                            this.colorAttachments = [];
                            this.depthStencilAttachment = this.stencilAttachment = this.depthAttachment = null
                        }

                        function g(a) {
                            a.colorAttachments.forEach(n);
                            n(a.depthAttachment);
                            n(a.stencilAttachment);
                            n(a.depthStencilAttachment)
                        }

                        function q(b) {
                            a.deleteFramebuffer(b.framebuffer);
                            b.framebuffer = null;
                            d.framebufferCount--;
                            delete H[b.id]
                        }

                        function r(b) {
                            var g;
                            a.bindFramebuffer(36160, b.framebuffer);
                            var e = b.colorAttachments;
                            for (g = 0; g < e.length; ++g) t(36064 + g, e[g]);
                            for (g = e.length; g < c.maxColorAttachments; ++g) a.framebufferTexture2D(36160, 36064 + g, 3553, null, 0);
                            a.framebufferTexture2D(36160, 33306, 3553, null, 0);
                            a.framebufferTexture2D(36160, 36096, 3553, null, 0);
                            a.framebufferTexture2D(36160, 36128, 3553, null, 0);
                            t(36096, b.depthAttachment);
                            t(36128, b.stencilAttachment);
                            t(33306, b.depthStencilAttachment);
                            a.checkFramebufferStatus(36160);
                            a.isContextLost();
                            a.bindFramebuffer(36160, z.next ? z.next.framebuffer : null);
                            z.cur = z.next;
                            a.getError()
                        }

                        function m(a,
                            b) {
                            function c(a, b) {
                                var f, d = 0,
                                    h = 0,
                                    m = !0,
                                    q = !0;
                                f = null;
                                var l = !0,
                                    n = "rgba",
                                    t = "uint8",
                                    p = 1,
                                    G = null,
                                    fa = null,
                                    z = null,
                                    O = !1;
                                if ("number" === typeof a) d = a | 0, h = b | 0 || d;
                                else if (a) {
                                    "shape" in a ? (h = a.shape, d = h[0], h = h[1]) : ("radius" in a && (d = h = a.radius), "width" in a && (d = a.width), "height" in a && (h = a.height));
                                    if ("color" in a || "colors" in a) f = a.color || a.colors, Array.isArray(f);
                                    if (!f) {
                                        "colorCount" in a && (p = a.colorCount | 0);
                                        "colorTexture" in a && (l = !!a.colorTexture, n = "rgba4");
                                        if ("colorType" in a && (t = a.colorType, !l))
                                            if ("half float" === t || "float16" ===
                                                t) n = "rgba16f";
                                            else if ("float" === t || "float32" === t) n = "rgba32f";
                                        "colorFormat" in a && (n = a.colorFormat, 0 <= Ha.indexOf(n) ? l = !0 : 0 <= v.indexOf(n) && (l = !1))
                                    }
                                    if ("depthTexture" in a || "depthStencilTexture" in a) O = !(!a.depthTexture && !a.depthStencilTexture);
                                    "depth" in a && ("boolean" === typeof a.depth ? m = a.depth : (G = a.depth, q = !1));
                                    "stencil" in a && ("boolean" === typeof a.stencil ? q = a.stencil : (fa = a.stencil, m = !1));
                                    "depthStencil" in a && ("boolean" === typeof a.depthStencil ? m = q = a.depthStencil : (z = a.depthStencil, q = m = !1))
                                } else d = h = 1;
                                var P =
                                    null,
                                    Z = null,
                                    H = null,
                                    A = null;
                                if (Array.isArray(f)) P = f.map(w);
                                else if (f) P = [w(f)];
                                else
                                    for (P = Array(p), f = 0; f < p; ++f) P[f] = k(d, h, l, n, t);
                                d = d || P[0].width;
                                h = h || P[0].height;
                                G ? Z = w(G) : m && !q && (Z = k(d, h, O, "depth", "uint32"));
                                fa ? H = w(fa) : q && !m && (H = k(d, h, !1, "stencil", "uint8"));
                                z ? A = w(z) : !G && !fa && q && m && (A = k(d, h, O, "depth stencil", "depth stencil"));
                                m = null;
                                for (f = 0; f < P.length; ++f) u(P[f], d, h), P[f] && P[f].texture && (q = Ya[P[f].texture._texture.format] * Pa[P[f].texture._texture.type], null === m && (m = q));
                                u(Z, d, h);
                                u(H, d, h);
                                u(A, d, h);
                                g(e);
                                e.width = d;
                                e.height = h;
                                e.colorAttachments = P;
                                e.depthAttachment = Z;
                                e.stencilAttachment = H;
                                e.depthStencilAttachment = A;
                                c.color = P.map(B);
                                c.depth = B(Z);
                                c.stencil = B(H);
                                c.depthStencil = B(A);
                                c.width = e.width;
                                c.height = e.height;
                                r(e);
                                return c
                            }
                            var e = new h;
                            d.framebufferCount++;
                            c(a, b);
                            return A(c, {
                                resize: function(a, b) {
                                    var g = Math.max(a | 0, 1),
                                        f = Math.max(b | 0 || g, 1);
                                    if (g === e.width && f === e.height) return c;
                                    for (var d = e.colorAttachments, h = 0; h < d.length; ++h) l(d[h], g, f);
                                    l(e.depthAttachment, g, f);
                                    l(e.stencilAttachment, g, f);
                                    l(e.depthStencilAttachment,
                                        g, f);
                                    e.width = c.width = g;
                                    e.height = c.height = f;
                                    r(e);
                                    return c
                                },
                                _reglType: "framebuffer",
                                _framebuffer: e,
                                destroy: function() {
                                    q(e);
                                    g(e)
                                },
                                use: function(a) {
                                    z.setFBO({
                                        framebuffer: c
                                    }, a)
                                }
                            })
                        }
                        var z = {
                                cur: null,
                                next: null,
                                dirty: !1,
                                setFBO: null
                            },
                            Ha = ["rgba"],
                            v = ["rgba4", "rgb565", "rgb5 a1"];
                        b.ext_srgb && v.push("srgba");
                        b.ext_color_buffer_half_float && v.push("rgba16f", "rgb16f");
                        b.webgl_color_buffer_float && v.push("rgba32f");
                        var Z = ["uint8"];
                        b.oes_texture_half_float && Z.push("half float", "float16");
                        b.oes_texture_float && Z.push("float",
                            "float32");
                        var G = 0,
                            H = {};
                        return A(z, {
                            getFramebuffer: function(a) {
                                return "function" === typeof a && "framebuffer" === a._reglType && (a = a._framebuffer, a instanceof h) ? a : null
                            },
                            create: m,
                            createCube: function(a) {
                                function b(a) {
                                    var g, f = {
                                            color: null
                                        },
                                        d = 0,
                                        h = null;
                                    g = "rgba";
                                    var q = "uint8",
                                        r = 1;
                                    if ("number" === typeof a) d = a | 0;
                                    else if (a) {
                                        "shape" in a ? d = a.shape[0] : ("radius" in a && (d = a.radius | 0), "width" in a ? d = a.width | 0 : "height" in a && (d = a.height | 0));
                                        if ("color" in a || "colors" in a) h = a.color || a.colors, Array.isArray(h);
                                        h || ("colorCount" in
                                            a && (r = a.colorCount | 0), "colorType" in a && (q = a.colorType), "colorFormat" in a && (g = a.colorFormat));
                                        "depth" in a && (f.depth = a.depth);
                                        "stencil" in a && (f.stencil = a.stencil);
                                        "depthStencil" in a && (f.depthStencil = a.depthStencil)
                                    } else d = 1;
                                    if (h)
                                        if (Array.isArray(h))
                                            for (a = [], g = 0; g < h.length; ++g) a[g] = h[g];
                                        else a = [h];
                                    else
                                        for (a = Array(r), h = {
                                                radius: d,
                                                format: g,
                                                type: q
                                            }, g = 0; g < r; ++g) a[g] = e.createCube(h);
                                    f.color = Array(a.length);
                                    for (g = 0; g < a.length; ++g) r = a[g], d = d || r.width, f.color[g] = {
                                        target: 34069,
                                        data: a[g]
                                    };
                                    for (g = 0; 6 > g; ++g) {
                                        for (r =
                                            0; r < a.length; ++r) f.color[r].target = 34069 + g;
                                        0 < g && (f.depth = c[0].depth, f.stencil = c[0].stencil, f.depthStencil = c[0].depthStencil);
                                        if (c[g]) c[g](f);
                                        else c[g] = m(f)
                                    }
                                    return A(b, {
                                        width: d,
                                        height: d,
                                        color: a
                                    })
                                }
                                var c = Array(6);
                                b(a);
                                return A(b, {
                                    faces: c,
                                    resize: function(a) {
                                        var g = a | 0;
                                        if (g === b.width) return b;
                                        var e = b.color;
                                        for (a = 0; a < e.length; ++a) e[a].resize(g);
                                        for (a = 0; 6 > a; ++a) c[a].resize(g);
                                        b.width = b.height = g;
                                        return b
                                    },
                                    _reglType: "framebufferCube",
                                    destroy: function() {
                                        c.forEach(function(a) {
                                            a.destroy()
                                        })
                                    }
                                })
                            },
                            clear: function() {
                                S(H).forEach(q)
                            },
                            restore: function() {
                                z.cur = null;
                                z.next = null;
                                z.dirty = !0;
                                S(H).forEach(function(b) {
                                    b.framebuffer = a.createFramebuffer();
                                    r(b)
                                })
                            }
                        })
                    }

                    function Za() {
                        this.w = this.z = this.y = this.x = this.state = 0;
                        this.buffer = null;
                        this.size = 0;
                        this.normalized = !1;
                        this.type = 5126;
                        this.divisor = this.stride = this.offset = 0
                    }

                    function Sb(a, b, c, e, f) {
                        function d(a) {
                            if (a !== h.currentVAO) {
                                var c = b.oes_vertex_array_object;
                                a ? c.bindVertexArrayOES(a.vao) : c.bindVertexArrayOES(null);
                                h.currentVAO = a
                            }
                        }

                        function p(c) {
                            if (c !== h.currentVAO) {
                                if (c) c.bindAttrs();
                                else
                                    for (var e =
                                            b.angle_instanced_arrays, f = 0; f < k.length; ++f) {
                                        var d = k[f];
                                        d.buffer ? (a.enableVertexAttribArray(f), a.vertexAttribPointer(f, d.size, d.type, d.normalized, d.stride, d.offfset), e && d.divisor && e.vertexAttribDivisorANGLE(f, d.divisor)) : (a.disableVertexAttribArray(f), a.vertexAttrib4f(f, d.x, d.y, d.z, d.w))
                                    }
                                h.currentVAO = c
                            }
                        }

                        function n() {
                            S(l).forEach(function(a) {
                                a.destroy()
                            })
                        }

                        function u() {
                            this.id = ++B;
                            this.attributes = [];
                            var a = b.oes_vertex_array_object;
                            this.vao = a ? a.createVertexArrayOES() : null;
                            l[this.id] = this;
                            this.buffers = []
                        }

                        function t() {
                            b.oes_vertex_array_object && S(l).forEach(function(a) {
                                a.refresh()
                            })
                        }
                        var w = c.maxAttributes,
                            k = Array(w);
                        for (c = 0; c < w; ++c) k[c] = new Za;
                        var B = 0,
                            l = {},
                            h = {
                                Record: Za,
                                scope: {},
                                state: k,
                                currentVAO: null,
                                targetVAO: null,
                                restore: b.oes_vertex_array_object ? t : function() {},
                                createVAO: function(a) {
                                    function b(a) {
                                        var g = {},
                                            e = c.attributes;
                                        e.length = a.length;
                                        for (var d = 0; d < a.length; ++d) {
                                            var h = a[d],
                                                k = e[d] = new Za,
                                                l = h.data || h;
                                            if (Array.isArray(l) || M(l) || da(l)) {
                                                var n;
                                                c.buffers[d] && (n = c.buffers[d], M(l) && n._buffer.byteLength >=
                                                    l.byteLength ? n.subdata(l) : (n.destroy(), c.buffers[d] = null));
                                                c.buffers[d] || (n = c.buffers[d] = f.create(h, 34962, !1, !0));
                                                k.buffer = f.getBuffer(n);
                                                k.size = k.buffer.dimension | 0;
                                                k.normalized = !1;
                                                k.type = k.buffer.dtype;
                                                k.offset = 0;
                                                k.stride = 0;
                                                k.divisor = 0;
                                                k.state = 1;
                                                g[d] = 1
                                            } else f.getBuffer(h) ? (k.buffer = f.getBuffer(h), k.size = k.buffer.dimension | 0, k.normalized = !1, k.type = k.buffer.dtype, k.offset = 0, k.stride = 0, k.divisor = 0, k.state = 1) : f.getBuffer(h.buffer) ? (k.buffer = f.getBuffer(h.buffer), k.size = (+h.size || k.buffer.dimension) |
                                                0, k.normalized = !!h.normalized || !1, k.type = "type" in h ? Ia[h.type] : k.buffer.dtype, k.offset = (h.offset || 0) | 0, k.stride = (h.stride || 0) | 0, k.divisor = (h.divisor || 0) | 0, k.state = 1) : "x" in h && (k.x = +h.x || 0, k.y = +h.y || 0, k.z = +h.z || 0, k.w = +h.w || 0, k.state = 2)
                                        }
                                        for (a = 0; a < c.buffers.length; ++a) !g[a] && c.buffers[a] && (c.buffers[a].destroy(), c.buffers[a] = null);
                                        c.refresh();
                                        return b
                                    }
                                    var c = new u;
                                    e.vaoCount += 1;
                                    b.destroy = function() {
                                        for (var a = 0; a < c.buffers.length; ++a) c.buffers[a] && c.buffers[a].destroy();
                                        c.buffers.length = 0;
                                        c.destroy()
                                    };
                                    b._vao = c;
                                    b._reglType = "vao";
                                    return b(a)
                                },
                                getVAO: function(a) {
                                    return "function" === typeof a && a._vao ? a._vao : null
                                },
                                destroyBuffer: function(b) {
                                    for (var c = 0; c < k.length; ++c) {
                                        var e = k[c];
                                        e.buffer === b && (a.disableVertexAttribArray(c), e.buffer = null)
                                    }
                                },
                                setVAO: b.oes_vertex_array_object ? d : p,
                                clear: b.oes_vertex_array_object ? n : function() {}
                            };
                        u.prototype.bindAttrs = function() {
                            for (var c = b.angle_instanced_arrays, e = this.attributes, f = 0; f < e.length; ++f) {
                                var d = e[f];
                                d.buffer ? (a.enableVertexAttribArray(f), a.bindBuffer(34962, d.buffer.buffer),
                                    a.vertexAttribPointer(f, d.size, d.type, d.normalized, d.stride, d.offset), c && d.divisor && c.vertexAttribDivisorANGLE(f, d.divisor)) : (a.disableVertexAttribArray(f), a.vertexAttrib4f(f, d.x, d.y, d.z, d.w))
                            }
                            for (c = e.length; c < w; ++c) a.disableVertexAttribArray(c)
                        };
                        u.prototype.refresh = function() {
                            var a = b.oes_vertex_array_object;
                            a && (a.bindVertexArrayOES(this.vao), this.bindAttrs(), h.currentVAO = this)
                        };
                        u.prototype.destroy = function() {
                            if (this.vao) {
                                var a = b.oes_vertex_array_object;
                                this === h.currentVAO && (h.currentVAO = null, a.bindVertexArrayOES(null));
                                a.deleteVertexArrayOES(this.vao);
                                this.vao = null
                            }
                            l[this.id] && (delete l[this.id], --e.vaoCount)
                        };
                        return h
                    }

                    function Tb(a, b, c, e) {
                        function f(a, b, c, e) {
                            this.name = a;
                            this.id = b;
                            this.location = c;
                            this.info = e
                        }

                        function d(a, b) {
                            for (var c = 0; c < a.length; ++c)
                                if (a[c].id === b.id) {
                                    a[c].location = b.location;
                                    return
                                }
                            a.push(b)
                        }

                        function p(c, g, e) {
                            e = 35632 === c ? t : w;
                            var d = e[g];
                            if (!d) {
                                var f = b.str(g),
                                    d = a.createShader(c);
                                a.shaderSource(d, f);
                                a.compileShader(d);
                                e[g] = d
                            }
                            return d
                        }

                        function n(a, b) {
                            this.id = l++;
                            this.fragId = a;
                            this.vertId = b;
                            this.program =
                                null;
                            this.uniforms = [];
                            this.attributes = [];
                            this.refCount = 1;
                            e.profile && (this.stats = {
                                uniformsCount: 0,
                                attributesCount: 0
                            })
                        }

                        function u(c, g, k) {
                            var l;
                            l = p(35632, c.fragId);
                            var m = p(35633, c.vertId);
                            g = c.program = a.createProgram();
                            a.attachShader(g, l);
                            a.attachShader(g, m);
                            if (k)
                                for (l = 0; l < k.length; ++l) m = k[l], a.bindAttribLocation(g, m[0], m[1]);
                            a.linkProgram(g);
                            m = a.getProgramParameter(g, 35718);
                            e.profile && (c.stats.uniformsCount = m);
                            var n = c.uniforms;
                            for (l = 0; l < m; ++l)
                                if (k = a.getActiveUniform(g, l))
                                    if (1 < k.size)
                                        for (var t = 0; t < k.size; ++t) {
                                            var u =
                                                k.name.replace("[0]", "[" + t + "]");
                                            d(n, new f(u, b.id(u), a.getUniformLocation(g, u), k))
                                        } else d(n, new f(k.name, b.id(k.name), a.getUniformLocation(g, k.name), k));
                            m = a.getProgramParameter(g, 35721);
                            e.profile && (c.stats.attributesCount = m);
                            c = c.attributes;
                            for (l = 0; l < m; ++l)(k = a.getActiveAttrib(g, l)) && d(c, new f(k.name, b.id(k.name), a.getAttribLocation(g, k.name), k))
                        }
                        var t = {},
                            w = {},
                            k = {},
                            B = [],
                            l = 0;
                        e.profile && (c.getMaxUniformsCount = function() {
                            var a = 0;
                            B.forEach(function(b) {
                                b.stats.uniformsCount > a && (a = b.stats.uniformsCount)
                            });
                            return a
                        }, c.getMaxAttributesCount = function() {
                            var a = 0;
                            B.forEach(function(b) {
                                b.stats.attributesCount > a && (a = b.stats.attributesCount)
                            });
                            return a
                        });
                        return {
                            clear: function() {
                                var b = a.deleteShader.bind(a);
                                S(t).forEach(b);
                                t = {};
                                S(w).forEach(b);
                                w = {};
                                B.forEach(function(b) {
                                    a.deleteProgram(b.program)
                                });
                                B.length = 0;
                                k = {};
                                c.shaderCount = 0
                            },
                            program: function(b, e, d, f) {
                                var l = k[e];
                                l || (l = k[e] = {});
                                var p = l[b];
                                if (p && (p.refCount++, !f)) return p;
                                var v = new n(e, b);
                                c.shaderCount++;
                                u(v, d, f);
                                p || (l[b] = v);
                                B.push(v);
                                return A(v, {
                                    destroy: function() {
                                        v.refCount--;
                                        if (0 >= v.refCount) {
                                            a.deleteProgram(v.program);
                                            var b = B.indexOf(v);
                                            B.splice(b, 1);
                                            c.shaderCount--
                                        }
                                        0 >= l[v.vertId].refCount && (a.deleteShader(w[v.vertId]), delete w[v.vertId], delete k[v.fragId][v.vertId]);
                                        Object.keys(k[v.fragId]).length || (a.deleteShader(t[v.fragId]), delete t[v.fragId], delete k[v.fragId])
                                    }
                                })
                            },
                            restore: function() {
                                t = {};
                                w = {};
                                for (var a = 0; a < B.length; ++a) u(B[a], null, B[a].attributes.map(function(a) {
                                    return [a.location, a.name]
                                }))
                            },
                            shader: p,
                            frag: -1,
                            vert: -1
                        }
                    }

                    function Ub(a, b, c, e, f, d, p) {
                        function n(d) {
                            var f;
                            f = null === b.next ? 5121 : b.next.colorAttachments[0].texture._texture.type;
                            var k = 0,
                                n = 0,
                                l = e.framebufferWidth,
                                h = e.framebufferHeight,
                                g = null;
                            M(d) ? g = d : d && (k = d.x | 0, n = d.y | 0, l = (d.width || e.framebufferWidth - k) | 0, h = (d.height || e.framebufferHeight - n) | 0, g = d.data || null);
                            c();
                            d = l * h * 4;
                            g || (5121 === f ? g = new Uint8Array(d) : 5126 === f && (g = g || new Float32Array(d)));
                            a.pixelStorei(3333, 4);
                            a.readPixels(k, n, l, h, 6408, f, g);
                            return g
                        }

                        function u(a) {
                            var c;
                            b.setFBO({
                                framebuffer: a.framebuffer
                            }, function() {
                                c = n(a)
                            });
                            return c
                        }
                        return function(a) {
                            return a &&
                                "framebuffer" in a ? u(a) : n(a)
                        }
                    }

                    function za(a) {
                        return Array.prototype.slice.call(a)
                    }

                    function Aa(a) {
                        return za(a).join("")
                    }

                    function Vb() {
                        function a() {
                            var a = [],
                                b = [];
                            return A(function() {
                                a.push.apply(a, za(arguments))
                            }, {
                                def: function() {
                                    var d = "v" + c++;
                                    b.push(d);
                                    0 < arguments.length && (a.push(d, "="), a.push.apply(a, za(arguments)), a.push(";"));
                                    return d
                                },
                                toString: function() {
                                    return Aa([0 < b.length ? "var " + b.join(",") + ";" : "", Aa(a)])
                                }
                            })
                        }

                        function b() {
                            function b(a, e) {
                                d(a, e, "=", c.def(a, e), ";")
                            }
                            var c = a(),
                                d = a(),
                                e = c.toString,
                                f = d.toString;
                            return A(function() {
                                c.apply(c, za(arguments))
                            }, {
                                def: c.def,
                                entry: c,
                                exit: d,
                                save: b,
                                set: function(a, d, e) {
                                    b(a, d);
                                    c(a, d, "=", e, ";")
                                },
                                toString: function() {
                                    return e() + f()
                                }
                            })
                        }
                        var c = 0,
                            e = [],
                            f = [],
                            d = a(),
                            p = {};
                        return {
                            global: d,
                            link: function(a) {
                                for (var b = 0; b < f.length; ++b)
                                    if (f[b] === a) return e[b];
                                b = "g" + c++;
                                e.push(b);
                                f.push(a);
                                return b
                            },
                            block: a,
                            proc: function(a, c) {
                                function d() {
                                    var a = "a" + e.length;
                                    e.push(a);
                                    return a
                                }
                                var e = [];
                                c = c || 0;
                                for (var f = 0; f < c; ++f) d();
                                var f = b(),
                                    B = f.toString;
                                return p[a] = A(f, {
                                    arg: d,
                                    toString: function() {
                                        return Aa(["function(",
                                            e.join(), "){", B(), "}"
                                        ])
                                    }
                                })
                            },
                            scope: b,
                            cond: function() {
                                var a = Aa(arguments),
                                    c = b(),
                                    d = b(),
                                    e = c.toString,
                                    f = d.toString;
                                return A(c, {
                                    then: function() {
                                        c.apply(c, za(arguments));
                                        return this
                                    },
                                    "else": function() {
                                        d.apply(d, za(arguments));
                                        return this
                                    },
                                    toString: function() {
                                        var b = f();
                                        b && (b = "else{" + b + "}");
                                        return Aa(["if(", a, "){", e(), "}", b])
                                    }
                                })
                            },
                            compile: function() {
                                var a = ['"use strict";', d, "return {"];
                                Object.keys(p).forEach(function(b) {
                                    a.push('"', b, '":', p[b].toString(), ",")
                                });
                                a.push("}");
                                var b = Aa(a).replace(/;/g, ";\n").replace(/}/g,
                                    "}\n").replace(/{/g, "{\n");
                                return Function.apply(null, e.concat(b)).apply(null, f)
                            }
                        }
                    }

                    function Qa(a) {
                        return Array.isArray(a) || M(a) || da(a)
                    }

                    function zb(a) {
                        return a.sort(function(a, c) {
                            return "viewport" === a ? -1 : "viewport" === c ? 1 : a < c ? -1 : 1
                        })
                    }

                    function K(a, b, c, e) {
                        this.thisDep = a;
                        this.contextDep = b;
                        this.propDep = c;
                        this.append = e
                    }

                    function sa(a) {
                        return a && !(a.thisDep || a.contextDep || a.propDep)
                    }

                    function v(a) {
                        return new K(!1, !1, !1, a)
                    }

                    function L(a, b) {
                        var c = a.type;
                        if (0 === c) return c = a.data.length, new K(!0, 1 <= c, 2 <= c, b);
                        if (4 ===
                            c) return c = a.data, new K(c.thisDep, c.contextDep, c.propDep, b);
                        if (5 === c) return new K(!1, !1, !1, b);
                        if (6 === c) {
                            for (var e = c = !1, f = !1, d = 0; d < a.data.length; ++d) {
                                var p = a.data[d];
                                1 === p.type ? f = !0 : 2 === p.type ? e = !0 : 3 === p.type ? c = !0 : 0 === p.type ? (c = !0, p = p.data, 1 <= p && (e = !0), 2 <= p && (f = !0)) : 4 === p.type && (c = c || p.data.thisDep, e = e || p.data.contextDep, f = f || p.data.propDep)
                            }
                            return new K(c, e, f, b)
                        }
                        return new K(3 === c, 2 === c, 1 === c, b)
                    }

                    function Wb(a, b, c, e, f, d, p, n, u, t, w, k, B, l, h) {
                        function g(a) {
                            return a.replace(".", "_")
                        }

                        function q(a, b, c) {
                            var d =
                                g(a);
                            La.push(a);
                            Ca[d] = pa[d] = !!c;
                            qa[d] = b
                        }

                        function r(a, b, c) {
                            var d = g(a);
                            La.push(a);
                            Array.isArray(c) ? (pa[d] = c.slice(), Ca[d] = c.slice()) : pa[d] = Ca[d] = c;
                            ra[d] = b
                        }

                        function m() {
                            var a = Vb(),
                                c = a.link,
                                d = a.global;
                            a.id = na++;
                            a.batchId = "0";
                            var e = c(ub),
                                f = a.shared = {
                                    props: "a0"
                                };
                            Object.keys(ub).forEach(function(a) {
                                f[a] = d.def(e, ".", a)
                            });
                            var g = a.next = {},
                                h = a.current = {};
                            Object.keys(ra).forEach(function(a) {
                                Array.isArray(pa[a]) && (g[a] = d.def(f.next, ".", a), h[a] = d.def(f.current, ".", a))
                            });
                            var ba = a.constants = {};
                            Object.keys(Na).forEach(function(a) {
                                ba[a] =
                                    d.def(JSON.stringify(Na[a]))
                            });
                            a.invoke = function(b, d) {
                                switch (d.type) {
                                    case 0:
                                        var e = ["this", f.context, f.props, a.batchId];
                                        return b.def(c(d.data), ".call(", e.slice(0, Math.max(d.data.length + 1, 4)), ")");
                                    case 1:
                                        return b.def(f.props, d.data);
                                    case 2:
                                        return b.def(f.context, d.data);
                                    case 3:
                                        return b.def("this", d.data);
                                    case 4:
                                        return d.data.append(a, b), d.data.ref;
                                    case 5:
                                        return d.data.toString();
                                    case 6:
                                        return d.data.map(function(c) {
                                            return a.invoke(b, c)
                                        })
                                }
                            };
                            a.attribCache = {};
                            var va = {};
                            a.scopeAttrib = function(a) {
                                a = b.id(a);
                                if (a in va) return va[a];
                                var d = t.scope[a];
                                d || (d = t.scope[a] = new ga);
                                return va[a] = c(d)
                            };
                            return a
                        }

                        function z(a) {
                            var b = a["static"];
                            a = a.dynamic;
                            var c;
                            if ("profile" in b) {
                                var d = !!b.profile;
                                c = v(function(a, b) {
                                    return d
                                });
                                c.enable = d
                            } else if ("profile" in a) {
                                var e = a.profile;
                                c = L(e, function(a, b) {
                                    return a.invoke(b, e)
                                })
                            }
                            return c
                        }

                        function E(a, b) {
                            var c = a["static"],
                                d = a.dynamic;
                            if ("framebuffer" in c) {
                                var e = c.framebuffer;
                                return e ? (e = n.getFramebuffer(e), v(function(a, b) {
                                    var c = a.link(e),
                                        d = a.shared;
                                    b.set(d.framebuffer, ".next",
                                        c);
                                    d = d.context;
                                    b.set(d, ".framebufferWidth", c + ".width");
                                    b.set(d, ".framebufferHeight", c + ".height");
                                    return c
                                })) : v(function(a, b) {
                                    var c = a.shared;
                                    b.set(c.framebuffer, ".next", "null");
                                    c = c.context;
                                    b.set(c, ".framebufferWidth", c + ".drawingBufferWidth");
                                    b.set(c, ".framebufferHeight", c + ".drawingBufferHeight");
                                    return "null"
                                })
                            }
                            if ("framebuffer" in d) {
                                var f = d.framebuffer;
                                return L(f, function(a, b) {
                                    var c = a.invoke(b, f),
                                        d = a.shared,
                                        e = d.framebuffer,
                                        c = b.def(e, ".getFramebuffer(", c, ")");
                                    b.set(e, ".next", c);
                                    d = d.context;
                                    b.set(d, ".framebufferWidth",
                                        c + "?" + c + ".width:" + d + ".drawingBufferWidth");
                                    b.set(d, ".framebufferHeight", c + "?" + c + ".height:" + d + ".drawingBufferHeight");
                                    return c
                                })
                            }
                            return null
                        }

                        function F(a, b, c) {
                            function d(a) {
                                if (a in e) {
                                    var c = e[a];
                                    a = !0;
                                    var g = c.x | 0,
                                        x = c.y | 0,
                                        h, k;
                                    "width" in c ? h = c.width | 0 : a = !1;
                                    "height" in c ? k = c.height | 0 : a = !1;
                                    return new K(!a && b && b.thisDep, !a && b && b.contextDep, !a && b && b.propDep, function(a, b) {
                                        var d = a.shared.context,
                                            e = h;
                                        "width" in c || (e = b.def(d, ".", "framebufferWidth", "-", g));
                                        var f = k;
                                        "height" in c || (f = b.def(d, ".", "framebufferHeight",
                                            "-", x));
                                        return [g, x, e, f]
                                    })
                                }
                                if (a in f) {
                                    var ca = f[a];
                                    a = L(ca, function(a, b) {
                                        var c = a.invoke(b, ca),
                                            d = a.shared.context,
                                            e = b.def(c, ".x|0"),
                                            f = b.def(c, ".y|0"),
                                            g = b.def('"width" in ', c, "?", c, ".width|0:", "(", d, ".", "framebufferWidth", "-", e, ")"),
                                            c = b.def('"height" in ', c, "?", c, ".height|0:", "(", d, ".", "framebufferHeight", "-", f, ")");
                                        return [e, f, g, c]
                                    });
                                    b && (a.thisDep = a.thisDep || b.thisDep, a.contextDep = a.contextDep || b.contextDep, a.propDep = a.propDep || b.propDep);
                                    return a
                                }
                                return b ? new K(b.thisDep, b.contextDep, b.propDep, function(a,
                                    b) {
                                    var c = a.shared.context;
                                    return [0, 0, b.def(c, ".", "framebufferWidth"), b.def(c, ".", "framebufferHeight")]
                                }) : null
                            }
                            var e = a["static"],
                                f = a.dynamic;
                            if (a = d("viewport")) {
                                var g = a;
                                a = new K(a.thisDep, a.contextDep, a.propDep, function(a, b) {
                                    var c = g.append(a, b),
                                        d = a.shared.context;
                                    b.set(d, ".viewportWidth", c[2]);
                                    b.set(d, ".viewportHeight", c[3]);
                                    return c
                                })
                            }
                            return {
                                viewport: a,
                                scissor_box: d("scissor.box")
                            }
                        }

                        function Z(a, b) {
                            var c = a["static"];
                            if ("string" === typeof c.frag && "string" === typeof c.vert) {
                                if (0 < Object.keys(b.dynamic).length) return null;
                                var c = b["static"],
                                    d = Object.keys(c);
                                if (0 < d.length && "number" === typeof c[d[0]]) {
                                    for (var e = [], f = 0; f < d.length; ++f) e.push([c[d[f]] | 0, d[f]]);
                                    return e
                                }
                            }
                            return null
                        }

                        function G(a, c, d) {
                            function e(a) {
                                if (a in f) {
                                    var c = b.id(f[a]);
                                    a = v(function() {
                                        return c
                                    });
                                    a.id = c;
                                    return a
                                }
                                if (a in g) {
                                    var d = g[a];
                                    return L(d, function(a, b) {
                                        var c = a.invoke(b, d);
                                        return b.def(a.shared.strings, ".id(", c, ")")
                                    })
                                }
                                return null
                            }
                            var f = a["static"],
                                g = a.dynamic,
                                h = e("frag"),
                                ba = e("vert"),
                                va = null;
                            sa(h) && sa(ba) ? (va = w.program(ba.id, h.id, null, d), a = v(function(a,
                                b) {
                                return a.link(va)
                            })) : a = new K(h && h.thisDep || ba && ba.thisDep, h && h.contextDep || ba && ba.contextDep, h && h.propDep || ba && ba.propDep, function(a, b) {
                                var c = a.shared.shader,
                                    d;
                                d = h ? h.append(a, b) : b.def(c, ".", "frag");
                                var e;
                                e = ba ? ba.append(a, b) : b.def(c, ".", "vert");
                                return b.def(c + ".program(" + e + "," + d + ")")
                            });
                            return {
                                frag: h,
                                vert: ba,
                                progVar: a,
                                program: va
                            }
                        }

                        function H(a, b) {
                            function c(a, b) {
                                if (a in e) {
                                    var d = e[a] | 0;
                                    return v(function(a, c) {
                                        b && (a.OFFSET = d);
                                        return d
                                    })
                                }
                                if (a in f) {
                                    var x = f[a];
                                    return L(x, function(a, c) {
                                        var d = a.invoke(c,
                                            x);
                                        b && (a.OFFSET = d);
                                        return d
                                    })
                                }
                                return b && g ? v(function(a, b) {
                                    a.OFFSET = "0";
                                    return 0
                                }) : null
                            }
                            var e = a["static"],
                                f = a.dynamic,
                                g = function() {
                                    if ("elements" in e) {
                                        var a = e.elements;
                                        Qa(a) ? a = d.getElements(d.create(a, !0)) : a && (a = d.getElements(a));
                                        var b = v(function(b, c) {
                                            if (a) {
                                                var d = b.link(a);
                                                return b.ELEMENTS = d
                                            }
                                            return b.ELEMENTS = null
                                        });
                                        b.value = a;
                                        return b
                                    }
                                    if ("elements" in f) {
                                        var c = f.elements;
                                        return L(c, function(a, b) {
                                            var d = a.shared,
                                                e = d.isBufferArgs,
                                                d = d.elements,
                                                f = a.invoke(b, c),
                                                g = b.def("null"),
                                                e = b.def(e, "(", f, ")"),
                                                f = a.cond(e).then(g,
                                                    "=", d, ".createStream(", f, ");")["else"](g, "=", d, ".getElements(", f, ");");
                                            b.entry(f);
                                            b.exit(a.cond(e).then(d, ".destroyStream(", g, ");"));
                                            return a.ELEMENTS = g
                                        })
                                    }
                                    return null
                                }(),
                                h = c("offset", !0);
                            return {
                                elements: g,
                                primitive: function() {
                                    if ("primitive" in e) {
                                        var a = e.primitive;
                                        return v(function(b, c) {
                                            return Ta[a]
                                        })
                                    }
                                    if ("primitive" in f) {
                                        var b = f.primitive;
                                        return L(b, function(a, c) {
                                            var d = a.constants.primTypes,
                                                e = a.invoke(c, b);
                                            return c.def(d, "[", e, "]")
                                        })
                                    }
                                    return g ? sa(g) ? g.value ? v(function(a, b) {
                                            return b.def(a.ELEMENTS, ".primType")
                                        }) :
                                        v(function() {
                                            return 4
                                        }) : new K(g.thisDep, g.contextDep, g.propDep, function(a, b) {
                                            var c = a.ELEMENTS;
                                            return b.def(c, "?", c, ".primType:", 4)
                                        }) : null
                                }(),
                                count: function() {
                                    if ("count" in e) {
                                        var a = e.count | 0;
                                        return v(function() {
                                            return a
                                        })
                                    }
                                    if ("count" in f) {
                                        var b = f.count;
                                        return L(b, function(a, c) {
                                            return a.invoke(c, b)
                                        })
                                    }
                                    return g ? sa(g) ? g ? h ? new K(h.thisDep, h.contextDep, h.propDep, function(a, b) {
                                            return b.def(a.ELEMENTS, ".vertCount-", a.OFFSET)
                                        }) : v(function(a, b) {
                                            return b.def(a.ELEMENTS, ".vertCount")
                                        }) : v(function() {
                                            return -1
                                        }) :
                                        new K(g.thisDep || h.thisDep, g.contextDep || h.contextDep, g.propDep || h.propDep, function(a, b) {
                                            var c = a.ELEMENTS;
                                            return a.OFFSET ? b.def(c, "?", c, ".vertCount-", a.OFFSET, ":-1") : b.def(c, "?", c, ".vertCount:-1")
                                        }) : null
                                }(),
                                instances: c("instances", !1),
                                offset: h
                            }
                        }

                        function O(a, b) {
                            var c = a["static"],
                                d = a.dynamic,
                                e = {};
                            La.forEach(function(a) {
                                function b(g, x) {
                                    if (a in c) {
                                        var h = g(c[a]);
                                        e[f] = v(function() {
                                            return h
                                        })
                                    } else if (a in d) {
                                        var I = d[a];
                                        e[f] = L(I, function(a, b) {
                                            return x(a, b, a.invoke(b, I))
                                        })
                                    }
                                }
                                var f = g(a);
                                switch (a) {
                                    case "cull.enable":
                                    case "blend.enable":
                                    case "dither":
                                    case "stencil.enable":
                                    case "depth.enable":
                                    case "scissor.enable":
                                    case "polygonOffset.enable":
                                    case "sample.alpha":
                                    case "sample.enable":
                                    case "depth.mask":
                                        return b(function(a) {
                                                return a
                                            },
                                            function(a, b, c) {
                                                return c
                                            });
                                    case "depth.func":
                                        return b(function(a) {
                                            return ab[a]
                                        }, function(a, b, c) {
                                            return b.def(a.constants.compareFuncs, "[", c, "]")
                                        });
                                    case "depth.range":
                                        return b(function(a) {
                                            return a
                                        }, function(a, b, c) {
                                            a = b.def("+", c, "[0]");
                                            b = b.def("+", c, "[1]");
                                            return [a, b]
                                        });
                                    case "blend.func":
                                        return b(function(a) {
                                            return [Ea["srcRGB" in a ? a.srcRGB : a.src], Ea["dstRGB" in a ? a.dstRGB : a.dst], Ea["srcAlpha" in a ? a.srcAlpha : a.src], Ea["dstAlpha" in a ? a.dstAlpha : a.dst]]
                                        }, function(a, b, c) {
                                            function d(a, e) {
                                                return b.def('"',
                                                    a, e, '" in ', c, "?", c, ".", a, e, ":", c, ".", a)
                                            }
                                            a = a.constants.blendFuncs;
                                            var e = d("src", "RGB"),
                                                f = d("dst", "RGB"),
                                                e = b.def(a, "[", e, "]"),
                                                g = b.def(a, "[", d("src", "Alpha"), "]"),
                                                f = b.def(a, "[", f, "]");
                                            a = b.def(a, "[", d("dst", "Alpha"), "]");
                                            return [e, f, g, a]
                                        });
                                    case "blend.equation":
                                        return b(function(a) {
                                            if ("string" === typeof a) return [W[a], W[a]];
                                            if ("object" === typeof a) return [W[a.rgb], W[a.alpha]]
                                        }, function(a, b, c) {
                                            var d = a.constants.blendEquations,
                                                e = b.def(),
                                                f = b.def();
                                            a = a.cond("typeof ", c, '==="string"');
                                            a.then(e, "=", f, "=", d, "[",
                                                c, "];");
                                            a["else"](e, "=", d, "[", c, ".rgb];", f, "=", d, "[", c, ".alpha];");
                                            b(a);
                                            return [e, f]
                                        });
                                    case "blend.color":
                                        return b(function(a) {
                                            return J(4, function(b) {
                                                return +a[b]
                                            })
                                        }, function(a, b, c) {
                                            return J(4, function(a) {
                                                return b.def("+", c, "[", a, "]")
                                            })
                                        });
                                    case "stencil.mask":
                                        return b(function(a) {
                                            return a | 0
                                        }, function(a, b, c) {
                                            return b.def(c, "|0")
                                        });
                                    case "stencil.func":
                                        return b(function(a) {
                                            return [ab[a.cmp || "keep"], a.ref || 0, "mask" in a ? a.mask : -1]
                                        }, function(a, b, c) {
                                            a = b.def('"cmp" in ', c, "?", a.constants.compareFuncs, "[", c, ".cmp]",
                                                ":", 7680);
                                            var d = b.def(c, ".ref|0");
                                            b = b.def('"mask" in ', c, "?", c, ".mask|0:-1");
                                            return [a, d, b]
                                        });
                                    case "stencil.opFront":
                                    case "stencil.opBack":
                                        return b(function(b) {
                                            return ["stencil.opBack" === a ? 1029 : 1028, Ra[b.fail || "keep"], Ra[b.zfail || "keep"], Ra[b.zpass || "keep"]]
                                        }, function(b, c, d) {
                                            function e(a) {
                                                return c.def('"', a, '" in ', d, "?", f, "[", d, ".", a, "]:", 7680)
                                            }
                                            var f = b.constants.stencilOps;
                                            return ["stencil.opBack" === a ? 1029 : 1028, e("fail"), e("zfail"), e("zpass")]
                                        });
                                    case "polygonOffset.offset":
                                        return b(function(a) {
                                            return [a.factor |
                                                0, a.units | 0
                                            ]
                                        }, function(a, b, c) {
                                            a = b.def(c, ".factor|0");
                                            b = b.def(c, ".units|0");
                                            return [a, b]
                                        });
                                    case "cull.face":
                                        return b(function(a) {
                                            var b = 0;
                                            "front" === a ? b = 1028 : "back" === a && (b = 1029);
                                            return b
                                        }, function(a, b, c) {
                                            return b.def(c, '==="front"?', 1028, ":", 1029)
                                        });
                                    case "lineWidth":
                                        return b(function(a) {
                                            return a
                                        }, function(a, b, c) {
                                            return c
                                        });
                                    case "frontFace":
                                        return b(function(a) {
                                            return Ab[a]
                                        }, function(a, b, c) {
                                            return b.def(c + '==="cw"?2304:2305')
                                        });
                                    case "colorMask":
                                        return b(function(a) {
                                                return a.map(function(a) {
                                                    return !!a
                                                })
                                            },
                                            function(a, b, c) {
                                                return J(4, function(a) {
                                                    return "!!" + c + "[" + a + "]"
                                                })
                                            });
                                    case "sample.coverage":
                                        return b(function(a) {
                                            return ["value" in a ? a.value : 1, !!a.invert]
                                        }, function(a, b, c) {
                                            a = b.def('"value" in ', c, "?+", c, ".value:1");
                                            b = b.def("!!", c, ".invert");
                                            return [a, b]
                                        })
                                }
                            });
                            return e
                        }

                        function M(a, b) {
                            var c = a["static"],
                                d = a.dynamic,
                                e = {};
                            Object.keys(c).forEach(function(a) {
                                var b = c[a],
                                    d;
                                if ("number" === typeof b || "boolean" === typeof b) d = v(function() {
                                    return b
                                });
                                else if ("function" === typeof b) {
                                    var f = b._reglType;
                                    if ("texture2d" === f ||
                                        "textureCube" === f) d = v(function(a) {
                                        return a.link(b)
                                    });
                                    else if ("framebuffer" === f || "framebufferCube" === f) d = v(function(a) {
                                        return a.link(b.color[0])
                                    })
                                } else ma(b) && (d = v(function(a) {
                                    return a.global.def("[", J(b.length, function(a) {
                                        return b[a]
                                    }), "]")
                                }));
                                d.value = b;
                                e[a] = d
                            });
                            Object.keys(d).forEach(function(a) {
                                var b = d[a];
                                e[a] = L(b, function(a, c) {
                                    return a.invoke(c, b)
                                })
                            });
                            return e
                        }

                        function S(a, c) {
                            var d = a["static"],
                                e = a.dynamic,
                                g = {};
                            Object.keys(d).forEach(function(a) {
                                var c = d[a],
                                    e = b.id(a),
                                    x = new ga;
                                if (Qa(c)) x.state = 1,
                                    x.buffer = f.getBuffer(f.create(c, 34962, !1, !0)), x.type = 0;
                                else {
                                    var h = f.getBuffer(c);
                                    if (h) x.state = 1, x.buffer = h, x.type = 0;
                                    else if ("constant" in c) {
                                        var I = c.constant;
                                        x.buffer = "null";
                                        x.state = 2;
                                        "number" === typeof I ? x.x = I : Ba.forEach(function(a, b) {
                                            b < I.length && (x[a] = I[b])
                                        })
                                    } else {
                                        var h = Qa(c.buffer) ? f.getBuffer(f.create(c.buffer, 34962, !1, !0)) : f.getBuffer(c.buffer),
                                            k = c.offset | 0,
                                            l = c.stride | 0,
                                            m = c.size | 0,
                                            ka = !!c.normalized,
                                            n = 0;
                                        "type" in c && (n = Ia[c.type]);
                                        c = c.divisor | 0;
                                        x.buffer = h;
                                        x.state = 1;
                                        x.size = m;
                                        x.normalized = ka;
                                        x.type =
                                            n || h.dtype;
                                        x.offset = k;
                                        x.stride = l;
                                        x.divisor = c
                                    }
                                }
                                g[a] = v(function(a, b) {
                                    var c = a.attribCache;
                                    if (e in c) return c[e];
                                    var d = {
                                        isStream: !1
                                    };
                                    Object.keys(x).forEach(function(a) {
                                        d[a] = x[a]
                                    });
                                    x.buffer && (d.buffer = a.link(x.buffer), d.type = d.type || d.buffer + ".dtype");
                                    return c[e] = d
                                })
                            });
                            Object.keys(e).forEach(function(a) {
                                var b = e[a];
                                g[a] = L(b, function(a, c) {
                                    function d(a) {
                                        c(h[a], "=", e, ".", a, "|0;")
                                    }
                                    var e = a.invoke(c, b),
                                        f = a.shared,
                                        g = a.constants,
                                        x = f.isBufferArgs,
                                        f = f.buffer,
                                        h = {
                                            isStream: c.def(!1)
                                        },
                                        I = new ga;
                                    I.state = 1;
                                    Object.keys(I).forEach(function(a) {
                                        h[a] =
                                            c.def("" + I[a])
                                    });
                                    var k = h.buffer,
                                        l = h.type;
                                    c("if(", x, "(", e, ")){", h.isStream, "=true;", k, "=", f, ".createStream(", 34962, ",", e, ");", l, "=", k, ".dtype;", "}else{", k, "=", f, ".getBuffer(", e, ");", "if(", k, "){", l, "=", k, ".dtype;", '}else if("constant" in ', e, "){", h.state, "=", 2, ";", "if(typeof " + e + '.constant === "number"){', h[Ba[0]], "=", e, ".constant;", Ba.slice(1).map(function(a) {
                                            return h[a]
                                        }).join("="), "=0;", "}else{", Ba.map(function(a, b) {
                                            return h[a] + "=" + e + ".constant.length>" + b + "?" + e + ".constant[" + b + "]:0;"
                                        }).join(""), "}}else{",
                                        "if(", x, "(", e, ".buffer)){", k, "=", f, ".createStream(", 34962, ",", e, ".buffer);", "}else{", k, "=", f, ".getBuffer(", e, ".buffer);", "}", l, '="type" in ', e, "?", g.glTypes, "[", e, ".type]:", k, ".dtype;", h.normalized, "=!!", e, ".normalized;");
                                    d("size");
                                    d("offset");
                                    d("stride");
                                    d("divisor");
                                    c("}}");
                                    c.exit("if(", h.isStream, "){", f, ".destroyStream(", k, ");", "}");
                                    return h
                                })
                            });
                            return g
                        }

                        function D(a, b) {
                            var c = a["static"],
                                d = a.dynamic;
                            if ("vao" in c) {
                                var e = c.vao;
                                null !== e && null === t.getVAO(e) && (e = t.createVAO(e));
                                return v(function(a) {
                                    return a.link(t.getVAO(e))
                                })
                            }
                            if ("vao" in
                                d) {
                                var f = d.vao;
                                return L(f, function(a, b) {
                                    var c = a.invoke(b, f);
                                    return b.def(a.shared.vao + ".getVAO(" + c + ")")
                                })
                            }
                            return null
                        }

                        function y(a) {
                            var b = a["static"],
                                c = a.dynamic,
                                d = {};
                            Object.keys(b).forEach(function(a) {
                                var c = b[a];
                                d[a] = v(function(a, b) {
                                    return "number" === typeof c || "boolean" === typeof c ? "" + c : a.link(c)
                                })
                            });
                            Object.keys(c).forEach(function(a) {
                                var b = c[a];
                                d[a] = L(b, function(a, c) {
                                    return a.invoke(c, b)
                                })
                            });
                            return d
                        }

                        function la(a, b, d, e, f) {
                            function h(a) {
                                var b = m[a];
                                b && ($a[a] = b)
                            }
                            var k = Z(a, b),
                                l = E(a, f),
                                m = F(a, l, f),
                                n = H(a,
                                    f),
                                $a = O(a, f),
                                p = G(a, f, k);
                            h("viewport");
                            h(g("scissor.box"));
                            var q = 0 < Object.keys($a).length,
                                l = {
                                    framebuffer: l,
                                    draw: n,
                                    shader: p,
                                    state: $a,
                                    dirty: q,
                                    scopeVAO: null,
                                    drawVAO: null,
                                    useVAO: !1,
                                    attributes: {}
                                };
                            l.profile = z(a, f);
                            l.uniforms = M(d, f);
                            l.drawVAO = l.scopeVAO = D(a, f);
                            if (!l.drawVAO && p.program && !k && c.angle_instanced_arrays) {
                                var r = !0;
                                a = p.program.attributes.map(function(a) {
                                    a = b["static"][a];
                                    r = r && !!a;
                                    return a
                                });
                                if (r && 0 < a.length) {
                                    var w = t.getVAO(t.createVAO(a));
                                    l.drawVAO = new K(null, null, null, function(a, b) {
                                        return a.link(w)
                                    });
                                    l.useVAO = !0
                                }
                            }
                            k ? l.useVAO = !0 : l.attributes = S(b, f);
                            l.context = y(e, f);
                            return l
                        }

                        function V(a, b, c) {
                            var d = a.shared.context,
                                e = a.scope();
                            Object.keys(c).forEach(function(f) {
                                b.save(d, "." + f);
                                var g = c[f].append(a, b);
                                Array.isArray(g) ? e(d, ".", f, "=[", g.join(), "];") : e(d, ".", f, "=", g, ";")
                            });
                            b(e)
                        }

                        function R(a, b, c, d) {
                            var e = a.shared,
                                f = e.gl,
                                g = e.framebuffer,
                                h;
                            Ka && (h = b.def(e.extensions, ".webgl_draw_buffers"));
                            var k = a.constants,
                                e = k.drawBuffer,
                                k = k.backBuffer;
                            a = c ? c.append(a, b) : b.def(g, ".next");
                            d || b("if(", a, "!==", g, ".cur){");
                            b("if(",
                                a, "){", f, ".bindFramebuffer(", 36160, ",", a, ".framebuffer);");
                            Ka && b(h, ".drawBuffersWEBGL(", e, "[", a, ".colorAttachments.length]);");
                            b("}else{", f, ".bindFramebuffer(", 36160, ",null);");
                            Ka && b(h, ".drawBuffersWEBGL(", k, ");");
                            b("}", g, ".cur=", a, ";");
                            d || b("}")
                        }

                        function T(a, b, c) {
                            var d = a.shared,
                                e = d.gl,
                                f = a.current,
                                h = a.next,
                                k = d.current,
                                l = d.next,
                                m = a.cond(k, ".dirty");
                            La.forEach(function(b) {
                                b = g(b);
                                if (!(b in c.state)) {
                                    var d, I;
                                    if (b in h) {
                                        d = h[b];
                                        I = f[b];
                                        var n = J(pa[b].length, function(a) {
                                            return m.def(d, "[", a, "]")
                                        });
                                        m(a.cond(n.map(function(a,
                                            b) {
                                            return a + "!==" + I + "[" + b + "]"
                                        }).join("||")).then(e, ".", ra[b], "(", n, ");", n.map(function(a, b) {
                                            return I + "[" + b + "]=" + a
                                        }).join(";"), ";"))
                                    } else d = m.def(l, ".", b), n = a.cond(d, "!==", k, ".", b), m(n), b in qa ? n(a.cond(d).then(e, ".enable(", qa[b], ");")["else"](e, ".disable(", qa[b], ");"), k, ".", b, "=", d, ";") : n(e, ".", ra[b], "(", d, ");", k, ".", b, "=", d, ";")
                                }
                            });
                            0 === Object.keys(c.state).length && m(k, ".dirty=false;");
                            b(m)
                        }

                        function N(a, b, c, d) {
                            var e = a.shared,
                                f = a.current,
                                g = e.current,
                                h = e.gl;
                            zb(Object.keys(c)).forEach(function(e) {
                                var k =
                                    c[e];
                                if (!d || d(k)) {
                                    var l = k.append(a, b);
                                    if (qa[e]) {
                                        var m = qa[e];
                                        sa(k) ? l ? b(h, ".enable(", m, ");") : b(h, ".disable(", m, ");") : b(a.cond(l).then(h, ".enable(", m, ");")["else"](h, ".disable(", m, ");"));
                                        b(g, ".", e, "=", l, ";")
                                    } else if (ma(l)) {
                                        var n = f[e];
                                        b(h, ".", ra[e], "(", l, ");", l.map(function(a, b) {
                                            return n + "[" + b + "]=" + a
                                        }).join(";"), ";")
                                    } else b(h, ".", ra[e], "(", l, ");", g, ".", e, "=", l, ";")
                                }
                            })
                        }

                        function C(a, b) {
                            oa && (a.instancing = b.def(a.shared.extensions, ".angle_instanced_arrays"))
                        }

                        function Q(a, b, c, d, e) {
                            function f() {
                                return "undefined" ===
                                    typeof performance ? "Date.now()" : "performance.now()"
                            }

                            function g(a) {
                                r = b.def();
                                a(r, "=", f(), ";");
                                "string" === typeof e ? a(n, ".count+=", e, ";") : a(n, ".count++;");
                                l && (d ? (t = b.def(), a(t, "=", q, ".getNumPendingQueries();")) : a(q, ".beginQuery(", n, ");"))
                            }

                            function h(a) {
                                a(n, ".cpuTime+=", f(), "-", r, ";");
                                l && (d ? a(q, ".pushScopeStats(", t, ",", q, ".getNumPendingQueries(),", n, ");") : a(q, ".endQuery();"))
                            }

                            function k(a) {
                                var c = b.def(p, ".profile");
                                b(p, ".profile=", a, ";");
                                b.exit(p, ".profile=", c, ";")
                            }
                            var m = a.shared,
                                n = a.stats,
                                p = m.current,
                                q = m.timer;
                            c = c.profile;
                            var r, t;
                            if (c) {
                                if (sa(c)) {
                                    c.enable ? (g(b), h(b.exit), k("true")) : k("false");
                                    return
                                }
                                c = c.append(a, b);
                                k(c)
                            } else c = b.def(p, ".profile");
                            m = a.block();
                            g(m);
                            b("if(", c, "){", m, "}");
                            a = a.block();
                            h(a);
                            b.exit("if(", c, "){", a, "}")
                        }

                        function U(a, b, c, d, e) {
                            function f(a) {
                                switch (a) {
                                    case 35664:
                                    case 35667:
                                    case 35671:
                                        return 2;
                                    case 35665:
                                    case 35668:
                                    case 35672:
                                        return 3;
                                    case 35666:
                                    case 35669:
                                    case 35673:
                                        return 4;
                                    default:
                                        return 1
                                }
                            }

                            function g(c, d, e) {
                                function f() {
                                    b("if(!", n, ".buffer){", l, ".enableVertexAttribArray(",
                                        m, ");}");
                                    var c = e.type,
                                        g;
                                    g = e.size ? b.def(e.size, "||", d) : d;
                                    b("if(", n, ".type!==", c, "||", n, ".size!==", g, "||", q.map(function(a) {
                                        return n + "." + a + "!==" + e[a]
                                    }).join("||"), "){", l, ".bindBuffer(", 34962, ",", ja, ".buffer);", l, ".vertexAttribPointer(", [m, g, c, e.normalized, e.stride, e.offset], ");", n, ".type=", c, ";", n, ".size=", g, ";", q.map(function(a) {
                                        return n + "." + a + "=" + e[a] + ";"
                                    }).join(""), "}");
                                    oa && (c = e.divisor, b("if(", n, ".divisor!==", c, "){", a.instancing, ".vertexAttribDivisorANGLE(", [m, c], ");", n, ".divisor=", c, ";}"))
                                }

                                function k() {
                                    b("if(",
                                        n, ".buffer){", l, ".disableVertexAttribArray(", m, ");", n, ".buffer=null;", "}if(", Ba.map(function(a, b) {
                                            return n + "." + a + "!==" + p[b]
                                        }).join("||"), "){", l, ".vertexAttrib4f(", m, ",", p, ");", Ba.map(function(a, b) {
                                            return n + "." + a + "=" + p[b] + ";"
                                        }).join(""), "}")
                                }
                                var l = h.gl,
                                    m = b.def(c, ".location"),
                                    n = b.def(h.attributes, "[", m, "]");
                                c = e.state;
                                var ja = e.buffer,
                                    p = [e.x, e.y, e.z, e.w],
                                    q = ["buffer", "normalized", "offset", "stride"];
                                1 === c ? f() : 2 === c ? k() : (b("if(", c, "===", 1, "){"), f(), b("}else{"), k(), b("}"))
                            }
                            var h = a.shared;
                            d.forEach(function(d) {
                                var h =
                                    d.name,
                                    k = c.attributes[h],
                                    l;
                                if (k) {
                                    if (!e(k)) return;
                                    l = k.append(a, b)
                                } else {
                                    if (!e(Bb)) return;
                                    var m = a.scopeAttrib(h);
                                    l = {};
                                    Object.keys(new ga).forEach(function(a) {
                                        l[a] = b.def(m, ".", a)
                                    })
                                }
                                g(a.link(d), f(d.info.type), l)
                            })
                        }

                        function ta(a, c, d, e, f) {
                            for (var g = a.shared, h = g.gl, k, l = 0; l < e.length; ++l) {
                                var m = e[l],
                                    n = m.name,
                                    p = m.info.type,
                                    q = d.uniforms[n],
                                    m = a.link(m) + ".location",
                                    r;
                                if (q) {
                                    if (!f(q)) continue;
                                    if (sa(q)) {
                                        n = q.value;
                                        if (35678 === p || 35680 === p) p = a.link(n._texture || n.color[0]._texture), c(h, ".uniform1i(", m, ",", p + ".bind());"),
                                            c.exit(p, ".unbind();");
                                        else if (35674 === p || 35675 === p || 35676 === p) n = a.global.def("new Float32Array([" + Array.prototype.slice.call(n) + "])"), q = 2, 35675 === p ? q = 3 : 35676 === p && (q = 4), c(h, ".uniformMatrix", q, "fv(", m, ",false,", n, ");");
                                        else {
                                            switch (p) {
                                                case 5126:
                                                    k = "1f";
                                                    break;
                                                case 35664:
                                                    k = "2f";
                                                    break;
                                                case 35665:
                                                    k = "3f";
                                                    break;
                                                case 35666:
                                                    k = "4f";
                                                    break;
                                                case 35670:
                                                    k = "1i";
                                                    break;
                                                case 5124:
                                                    k = "1i";
                                                    break;
                                                case 35671:
                                                    k = "2i";
                                                    break;
                                                case 35667:
                                                    k = "2i";
                                                    break;
                                                case 35672:
                                                    k = "3i";
                                                    break;
                                                case 35668:
                                                    k = "3i";
                                                    break;
                                                case 35673:
                                                    k = "4i";
                                                    break;
                                                case 35669:
                                                    k =
                                                        "4i"
                                            }
                                            c(h, ".uniform", k, "(", m, ",", ma(n) ? Array.prototype.slice.call(n) : n, ");")
                                        }
                                        continue
                                    } else r = q.append(a, c)
                                } else {
                                    if (!f(Bb)) continue;
                                    r = c.def(g.uniforms, "[", b.id(n), "]")
                                }
                                35678 === p ? c("if(", r, "&&", r, '._reglType==="framebuffer"){', r, "=", r, ".color[0];", "}") : 35680 === p && c("if(", r, "&&", r, '._reglType==="framebufferCube"){', r, "=", r, ".color[0];", "}");
                                n = 1;
                                switch (p) {
                                    case 35678:
                                    case 35680:
                                        p = c.def(r, "._texture");
                                        c(h, ".uniform1i(", m, ",", p, ".bind());");
                                        c.exit(p, ".unbind();");
                                        continue;
                                    case 5124:
                                    case 35670:
                                        k = "1i";
                                        break;
                                    case 35667:
                                    case 35671:
                                        k = "2i";
                                        n = 2;
                                        break;
                                    case 35668:
                                    case 35672:
                                        k = "3i";
                                        n = 3;
                                        break;
                                    case 35669:
                                    case 35673:
                                        k = "4i";
                                        n = 4;
                                        break;
                                    case 5126:
                                        k = "1f";
                                        break;
                                    case 35664:
                                        k = "2f";
                                        n = 2;
                                        break;
                                    case 35665:
                                        k = "3f";
                                        n = 3;
                                        break;
                                    case 35666:
                                        k = "4f";
                                        n = 4;
                                        break;
                                    case 35674:
                                        k = "Matrix2fv";
                                        break;
                                    case 35675:
                                        k = "Matrix3fv";
                                        break;
                                    case 35676:
                                        k = "Matrix4fv"
                                }
                                c(h, ".uniform", k, "(", m, ",");
                                if ("M" === k.charAt(0)) {
                                    var m = Math.pow(p - 35674 + 2, 2),
                                        t = a.global.def("new Float32Array(", m, ")");
                                    Array.isArray(r) ? c("false,(", J(m, function(a) {
                                            return t + "[" + a + "]=" + r[a]
                                        }),
                                        ",", t, ")") : c("false,(Array.isArray(", r, ")||", r, " instanceof Float32Array)?", r, ":(", J(m, function(a) {
                                        return t + "[" + a + "]=" + r + "[" + a + "]"
                                    }), ",", t, ")")
                                } else 1 < n ? c(J(n, function(a) {
                                    return Array.isArray(r) ? r[a] : r + "[" + a + "]"
                                })) : c(r);
                                c(");")
                            }
                        }

                        function aa(a, b, c, d) {
                            function e(f) {
                                var g = m[f];
                                return g ? g.contextDep && d.contextDynamic || g.propDep ? g.append(a, c) : g.append(a, b) : b.def(l, ".", f)
                            }

                            function f() {
                                function a() {
                                    c(w, ".drawElementsInstancedANGLE(", [p, q, u, r + "<<((" + u + "-5121)>>1)", t], ");")
                                }

                                function b() {
                                    c(w, ".drawArraysInstancedANGLE(", [p, r, q, t], ");")
                                }
                                n ? B ? a() : (c("if(", n, "){"), a(), c("}else{"), b(), c("}")) : b()
                            }

                            function g() {
                                function a() {
                                    c(k + ".drawElements(" + [p, q, u, r + "<<((" + u + "-5121)>>1)"] + ");")
                                }

                                function b() {
                                    c(k + ".drawArrays(" + [p, r, q] + ");")
                                }
                                n ? B ? a() : (c("if(", n, "){"), a(), c("}else{"), b(), c("}")) : b()
                            }
                            var h = a.shared,
                                k = h.gl,
                                l = h.draw,
                                m = d.draw,
                                n = function() {
                                    var e = m.elements,
                                        f = b;
                                    if (e) {
                                        if (e.contextDep && d.contextDynamic || e.propDep) f = c;
                                        e = e.append(a, f)
                                    } else e = f.def(l, ".", "elements");
                                    e && f("if(" + e + ")" + k + ".bindBuffer(34963," + e + ".buffer.buffer);");
                                    return e
                                }(),
                                p = e("primitive"),
                                r = e("offset"),
                                q = function() {
                                    var e = m.count,
                                        f = b;
                                    if (e) {
                                        if (e.contextDep && d.contextDynamic || e.propDep) f = c;
                                        e = e.append(a, f)
                                    } else e = f.def(l, ".", "count");
                                    return e
                                }();
                            if ("number" === typeof q) {
                                if (0 === q) return
                            } else c("if(", q, "){"), c.exit("}");
                            var t, w;
                            oa && (t = e("instances"), w = a.instancing);
                            var u = n + ".type",
                                B = m.elements && sa(m.elements);
                            oa && ("number" !== typeof t || 0 <= t) ? "string" === typeof t ? (c("if(", t, ">0){"), f(), c("}else if(", t, "<0){"), g(), c("}")) : f() : g()
                        }

                        function X(a, b, c, d, e) {
                            b = m();
                            e = b.proc("body", e);
                            oa && (b.instancing = e.def(b.shared.extensions, ".angle_instanced_arrays"));
                            a(b, e, c, d);
                            return b.compile().body
                        }

                        function fa(a, b, c, d) {
                            C(a, b);
                            c.useVAO ? c.drawVAO ? b(a.shared.vao, ".setVAO(", c.drawVAO.append(a, b), ");") : b(a.shared.vao, ".setVAO(", a.shared.vao, ".targetVAO);") : (b(a.shared.vao, ".setVAO(null);"), U(a, b, c, d.attributes, function() {
                                return !0
                            }));
                            ta(a, b, c, d.uniforms, function() {
                                return !0
                            });
                            aa(a, b, b, c)
                        }

                        function Da(a, b) {
                            var c = a.proc("draw", 1);
                            C(a, c);
                            V(a, c, b.context);
                            R(a, c, b.framebuffer);
                            T(a, c, b);
                            N(a, c, b.state);
                            Q(a, c, b, !1, !0);
                            var d = b.shader.progVar.append(a, c);
                            c(a.shared.gl, ".useProgram(", d, ".program);");
                            if (b.shader.program) fa(a, c, b, b.shader.program);
                            else {
                                c(a.shared.vao, ".setVAO(null);");
                                var e = a.global.def("{}"),
                                    f = c.def(d, ".id"),
                                    g = c.def(e, "[", f, "]");
                                c(a.cond(g).then(g, ".call(this,a0);")["else"](g, "=", e, "[", f, "]=", a.link(function(c) {
                                    return X(fa, a, b, c, 1)
                                }), "(", d, ");", g, ".call(this,a0);"))
                            }
                            0 < Object.keys(b.state).length && c(a.shared.current, ".dirty=true;")
                        }

                        function ua(a, b, c, d) {
                            function e() {
                                return !0
                            }
                            a.batchId =
                                "a1";
                            C(a, b);
                            U(a, b, c, d.attributes, e);
                            ta(a, b, c, d.uniforms, e);
                            aa(a, b, b, c)
                        }

                        function P(a, b, c, d) {
                            function e(a) {
                                return a.contextDep && g || a.propDep
                            }

                            function f(a) {
                                return !e(a)
                            }
                            C(a, b);
                            var g = c.contextDep,
                                h = b.def(),
                                k = b.def();
                            a.shared.props = k;
                            a.batchId = h;
                            var l = a.scope(),
                                m = a.scope();
                            b(l.entry, "for(", h, "=0;", h, "<", "a1", ";++", h, "){", k, "=", "a0", "[", h, "];", m, "}", l.exit);
                            c.needsContext && V(a, m, c.context);
                            c.needsFramebuffer && R(a, m, c.framebuffer);
                            N(a, m, c.state, e);
                            c.profile && e(c.profile) && Q(a, m, c, !1, !0);
                            d ? (c.useVAO ? c.drawVAO ?
                                e(c.drawVAO) ? m(a.shared.vao, ".setVAO(", c.drawVAO.append(a, m), ");") : l(a.shared.vao, ".setVAO(", c.drawVAO.append(a, l), ");") : l(a.shared.vao, ".setVAO(", a.shared.vao, ".targetVAO);") : (l(a.shared.vao, ".setVAO(null);"), U(a, l, c, d.attributes, f), U(a, m, c, d.attributes, e)), ta(a, l, c, d.uniforms, f), ta(a, m, c, d.uniforms, e), aa(a, l, m, c)) : (b = a.global.def("{}"), d = c.shader.progVar.append(a, m), k = m.def(d, ".id"), l = m.def(b, "[", k, "]"), m(a.shared.gl, ".useProgram(", d, ".program);", "if(!", l, "){", l, "=", b, "[", k, "]=", a.link(function(b) {
                                return X(ua,
                                    a, c, b, 2)
                            }), "(", d, ");}", l, ".call(this,a0[", h, "],", h, ");"))
                        }

                        function da(a, b) {
                            function c(a) {
                                return a.contextDep && e || a.propDep
                            }
                            var d = a.proc("batch", 2);
                            a.batchId = "0";
                            C(a, d);
                            var e = !1,
                                f = !0;
                            Object.keys(b.context).forEach(function(a) {
                                e = e || b.context[a].propDep
                            });
                            e || (V(a, d, b.context), f = !1);
                            var g = b.framebuffer,
                                h = !1;
                            g ? (g.propDep ? e = h = !0 : g.contextDep && e && (h = !0), h || R(a, d, g)) : R(a, d, null);
                            b.state.viewport && b.state.viewport.propDep && (e = !0);
                            T(a, d, b);
                            N(a, d, b.state, function(a) {
                                return !c(a)
                            });
                            b.profile && c(b.profile) || Q(a,
                                d, b, !1, "a1");
                            b.contextDep = e;
                            b.needsContext = f;
                            b.needsFramebuffer = h;
                            f = b.shader.progVar;
                            if (f.contextDep && e || f.propDep) P(a, d, b, null);
                            else if (f = f.append(a, d), d(a.shared.gl, ".useProgram(", f, ".program);"), b.shader.program) P(a, d, b, b.shader.program);
                            else {
                                d(a.shared.vao, ".setVAO(null);");
                                var g = a.global.def("{}"),
                                    h = d.def(f, ".id"),
                                    k = d.def(g, "[", h, "]");
                                d(a.cond(k).then(k, ".call(this,a0,a1);")["else"](k, "=", g, "[", h, "]=", a.link(function(c) {
                                    return X(P, a, b, c, 2)
                                }), "(", f, ");", k, ".call(this,a0,a1);"))
                            }
                            0 < Object.keys(b.state).length &&
                                d(a.shared.current, ".dirty=true;")
                        }

                        function ea(a, c) {
                            function d(b) {
                                var g = c.shader[b];
                                g && e.set(f.shader, "." + b, g.append(a, e))
                            }
                            var e = a.proc("scope", 3);
                            a.batchId = "a2";
                            var f = a.shared,
                                g = f.current;
                            V(a, e, c.context);
                            c.framebuffer && c.framebuffer.append(a, e);
                            zb(Object.keys(c.state)).forEach(function(b) {
                                var d = c.state[b].append(a, e);
                                ma(d) ? d.forEach(function(c, d) {
                                    e.set(a.next[b], "[" + d + "]", c)
                                }) : e.set(f.next, "." + b, d)
                            });
                            Q(a, e, c, !0, !0);
                            ["elements", "offset", "count", "instances", "primitive"].forEach(function(b) {
                                var d =
                                    c.draw[b];
                                d && e.set(f.draw, "." + b, "" + d.append(a, e))
                            });
                            Object.keys(c.uniforms).forEach(function(d) {
                                var g = c.uniforms[d].append(a, e);
                                Array.isArray(g) && (g = "[" + g.join() + "]");
                                e.set(f.uniforms, "[" + b.id(d) + "]", g)
                            });
                            Object.keys(c.attributes).forEach(function(b) {
                                var d = c.attributes[b].append(a, e),
                                    f = a.scopeAttrib(b);
                                Object.keys(new ga).forEach(function(a) {
                                    e.set(f, "." + a, d[a])
                                })
                            });
                            c.scopeVAO && e.set(f.vao, ".targetVAO", c.scopeVAO.append(a, e));
                            d("vert");
                            d("frag");
                            0 < Object.keys(c.state).length && (e(g, ".dirty=true;"),
                                e.exit(g, ".dirty=true;"));
                            e("a1(", a.shared.context, ",a0,", a.batchId, ");")
                        }

                        function ha(a) {
                            if ("object" === typeof a && !ma(a)) {
                                for (var b = Object.keys(a), c = 0; c < b.length; ++c)
                                    if (Y.isDynamic(a[b[c]])) return !0;
                                return !1
                            }
                        }

                        function ia(a, b, c) {
                            function d(a, b) {
                                g.forEach(function(c) {
                                    var d = e[c];
                                    Y.isDynamic(d) && (d = a.invoke(b, d), b(m, ".", c, "=", d, ";"))
                                })
                            }
                            var e = b["static"][c];
                            if (e && ha(e)) {
                                var f = a.global,
                                    g = Object.keys(e),
                                    h = !1,
                                    k = !1,
                                    l = !1,
                                    m = a.global.def("{}");
                                g.forEach(function(b) {
                                    var c = e[b];
                                    if (Y.isDynamic(c)) "function" === typeof c &&
                                        (c = e[b] = Y.unbox(c)), b = L(c, null), h = h || b.thisDep, l = l || b.propDep, k = k || b.contextDep;
                                    else {
                                        f(m, ".", b, "=");
                                        switch (typeof c) {
                                            case "number":
                                                f(c);
                                                break;
                                            case "string":
                                                f('"', c, '"');
                                                break;
                                            case "object":
                                                Array.isArray(c) && f("[", c.join(), "]");
                                                break;
                                            default:
                                                f(a.link(c))
                                        }
                                        f(";")
                                    }
                                });
                                b.dynamic[c] = new Y.DynamicVariable(4, {
                                    thisDep: h,
                                    contextDep: k,
                                    propDep: l,
                                    ref: m,
                                    append: d
                                });
                                delete b["static"][c]
                            }
                        }
                        var ga = t.Record,
                            W = {
                                add: 32774,
                                subtract: 32778,
                                "reverse subtract": 32779
                            };
                        c.ext_blend_minmax && (W.min = 32775, W.max = 32776);
                        var oa = c.angle_instanced_arrays,
                            Ka = c.webgl_draw_buffers,
                            pa = {
                                dirty: !0,
                                profile: h.profile
                            },
                            Ca = {},
                            La = [],
                            qa = {},
                            ra = {};
                        q("dither", 3024);
                        q("blend.enable", 3042);
                        r("blend.color", "blendColor", [0, 0, 0, 0]);
                        r("blend.equation", "blendEquationSeparate", [32774, 32774]);
                        r("blend.func", "blendFuncSeparate", [1, 0, 1, 0]);
                        q("depth.enable", 2929, !0);
                        r("depth.func", "depthFunc", 513);
                        r("depth.range", "depthRange", [0, 1]);
                        r("depth.mask", "depthMask", !0);
                        r("colorMask", "colorMask", [!0, !0, !0, !0]);
                        q("cull.enable", 2884);
                        r("cull.face", "cullFace", 1029);
                        r("frontFace", "frontFace",
                            2305);
                        r("lineWidth", "lineWidth", 1);
                        q("polygonOffset.enable", 32823);
                        r("polygonOffset.offset", "polygonOffset", [0, 0]);
                        q("sample.alpha", 32926);
                        q("sample.enable", 32928);
                        r("sample.coverage", "sampleCoverage", [1, !1]);
                        q("stencil.enable", 2960);
                        r("stencil.mask", "stencilMask", -1);
                        r("stencil.func", "stencilFunc", [519, 0, -1]);
                        r("stencil.opFront", "stencilOpSeparate", [1028, 7680, 7680, 7680]);
                        r("stencil.opBack", "stencilOpSeparate", [1029, 7680, 7680, 7680]);
                        q("scissor.enable", 3089);
                        r("scissor.box", "scissor", [0, 0, a.drawingBufferWidth,
                            a.drawingBufferHeight
                        ]);
                        r("viewport", "viewport", [0, 0, a.drawingBufferWidth, a.drawingBufferHeight]);
                        var ub = {
                                gl: a,
                                context: B,
                                strings: b,
                                next: Ca,
                                current: pa,
                                draw: k,
                                elements: d,
                                buffer: f,
                                shader: w,
                                attributes: t.state,
                                vao: t,
                                uniforms: u,
                                framebuffer: n,
                                extensions: c,
                                timer: l,
                                isBufferArgs: Qa
                            },
                            Na = {
                                primTypes: Ta,
                                compareFuncs: ab,
                                blendFuncs: Ea,
                                blendEquations: W,
                                stencilOps: Ra,
                                glTypes: Ia,
                                orientationType: Ab
                            };
                        Ka && (Na.backBuffer = [1029], Na.drawBuffer = J(e.maxDrawbuffers, function(a) {
                            return 0 === a ? [0] : J(a, function(a) {
                                return 36064 + a
                            })
                        }));
                        var na = 0;
                        return {
                            next: Ca,
                            current: pa,
                            procs: function() {
                                var a = m(),
                                    b = a.proc("poll"),
                                    d = a.proc("refresh"),
                                    f = a.block();
                                b(f);
                                d(f);
                                var g = a.shared,
                                    h = g.gl,
                                    k = g.next,
                                    l = g.current;
                                f(l, ".dirty=false;");
                                R(a, b);
                                R(a, d, null, !0);
                                var n;
                                oa && (n = a.link(oa));
                                c.oes_vertex_array_object && d(a.link(c.oes_vertex_array_object), ".bindVertexArrayOES(null);");
                                for (var p = 0; p < e.maxAttributes; ++p) {
                                    var q = d.def(g.attributes, "[", p, "]"),
                                        r = a.cond(q, ".buffer");
                                    r.then(h, ".enableVertexAttribArray(", p, ");", h, ".bindBuffer(", 34962, ",", q, ".buffer.buffer);",
                                        h, ".vertexAttribPointer(", p, ",", q, ".size,", q, ".type,", q, ".normalized,", q, ".stride,", q, ".offset);")["else"](h, ".disableVertexAttribArray(", p, ");", h, ".vertexAttrib4f(", p, ",", q, ".x,", q, ".y,", q, ".z,", q, ".w);", q, ".buffer=null;");
                                    d(r);
                                    oa && d(n, ".vertexAttribDivisorANGLE(", p, ",", q, ".divisor);")
                                }
                                d(a.shared.vao, ".currentVAO=null;", a.shared.vao, ".setVAO(", a.shared.vao, ".targetVAO);");
                                Object.keys(qa).forEach(function(c) {
                                    var e = qa[c],
                                        g = f.def(k, ".", c),
                                        m = a.block();
                                    m("if(", g, "){", h, ".enable(", e, ")}else{", h, ".disable(",
                                        e, ")}", l, ".", c, "=", g, ";");
                                    d(m);
                                    b("if(", g, "!==", l, ".", c, "){", m, "}")
                                });
                                Object.keys(ra).forEach(function(c) {
                                    var e = ra[c],
                                        g = pa[c],
                                        m, n, p = a.block();
                                    p(h, ".", e, "(");
                                    ma(g) ? (e = g.length, m = a.global.def(k, ".", c), n = a.global.def(l, ".", c), p(J(e, function(a) {
                                        return m + "[" + a + "]"
                                    }), ");", J(e, function(a) {
                                        return n + "[" + a + "]=" + m + "[" + a + "];"
                                    }).join("")), b("if(", J(e, function(a) {
                                        return m + "[" + a + "]!==" + n + "[" + a + "]"
                                    }).join("||"), "){", p, "}")) : (m = f.def(k, ".", c), n = f.def(l, ".", c), p(m, ");", l, ".", c, "=", m, ";"), b("if(", m, "!==", n, "){", p, "}"));
                                    d(p)
                                });
                                return a.compile()
                            }(),
                            compile: function(a, b, c, d, e) {
                                var f = m();
                                f.stats = f.link(e);
                                Object.keys(b["static"]).forEach(function(a) {
                                    ia(f, b, a)
                                });
                                Xb.forEach(function(b) {
                                    ia(f, a, b)
                                });
                                var g = la(a, b, c, d, f);
                                Da(f, g);
                                ea(f, g);
                                da(f, g);
                                return A(f.compile(), {
                                    destroy: function() {
                                        g.shader.program.destroy()
                                    }
                                })
                            }
                        }
                    }

                    function Cb(a, b) {
                        for (var c = 0; c < a.length; ++c)
                            if (a[c] === b) return c;
                        return -1
                    }
                    var A = function(a, b) {
                            for (var c = Object.keys(b), e = 0; e < c.length; ++e) a[c[e]] = b[c[e]];
                            return a
                        },
                        Eb = 0,
                        Y = {
                            DynamicVariable: U,
                            define: function(a,
                                b) {
                                return new U(a, cb(b + ""))
                            },
                            isDynamic: function(a) {
                                return "function" === typeof a && !a._reglType || a instanceof U
                            },
                            unbox: db,
                            accessor: cb
                        },
                        bb = {
                            next: "function" === typeof requestAnimationFrame ? function(a) {
                                return requestAnimationFrame(a)
                            } : function(a) {
                                return setTimeout(a, 16)
                            },
                            cancel: "function" === typeof cancelAnimationFrame ? function(a) {
                                return cancelAnimationFrame(a)
                            } : clearTimeout
                        },
                        Db = "undefined" !== typeof performance && performance.now ? function() {
                            return performance.now()
                        } : function() {
                            return +new Date
                        },
                        E = hb();
                    E.zero =
                        hb();
                    var Yb = function(a, b) {
                            var c = 1;
                            b.ext_texture_filter_anisotropic && (c = a.getParameter(34047));
                            var e = 1,
                                f = 1;
                            b.webgl_draw_buffers && (e = a.getParameter(34852), f = a.getParameter(36063));
                            var d = !!b.oes_texture_float;
                            if (d) {
                                d = a.createTexture();
                                a.bindTexture(3553, d);
                                a.texImage2D(3553, 0, 6408, 1, 1, 0, 6408, 5126, null);
                                var p = a.createFramebuffer();
                                a.bindFramebuffer(36160, p);
                                a.framebufferTexture2D(36160, 36064, 3553, d, 0);
                                a.bindTexture(3553, null);
                                if (36053 !== a.checkFramebufferStatus(36160)) d = !1;
                                else {
                                    a.viewport(0, 0, 1, 1);
                                    a.clearColor(1,
                                        0, 0, 1);
                                    a.clear(16384);
                                    var n = E.allocType(5126, 4);
                                    a.readPixels(0, 0, 1, 1, 6408, 5126, n);
                                    a.getError() ? d = !1 : (a.deleteFramebuffer(p), a.deleteTexture(d), d = 1 === n[0]);
                                    E.freeType(n)
                                }
                            }
                            n = !0;
                            "undefined" !== typeof navigator && (/MSIE/.test(navigator.userAgent) || /Trident\//.test(navigator.appVersion) || /Edge/.test(navigator.userAgent)) || (n = a.createTexture(), p = E.allocType(5121, 36), a.activeTexture(33984), a.bindTexture(34067, n), a.texImage2D(34069, 0, 6408, 3, 3, 0, 6408, 5121, p), E.freeType(p), a.bindTexture(34067, null), a.deleteTexture(n),
                                n = !a.getError());
                            return {
                                colorBits: [a.getParameter(3410), a.getParameter(3411), a.getParameter(3412), a.getParameter(3413)],
                                depthBits: a.getParameter(3414),
                                stencilBits: a.getParameter(3415),
                                subpixelBits: a.getParameter(3408),
                                extensions: Object.keys(b).filter(function(a) {
                                    return !!b[a]
                                }),
                                maxAnisotropic: c,
                                maxDrawbuffers: e,
                                maxColorAttachments: f,
                                pointSizeDims: a.getParameter(33901),
                                lineWidthDims: a.getParameter(33902),
                                maxViewportDims: a.getParameter(3386),
                                maxCombinedTextureUnits: a.getParameter(35661),
                                maxCubeMapSize: a.getParameter(34076),
                                maxRenderbufferSize: a.getParameter(34024),
                                maxTextureUnits: a.getParameter(34930),
                                maxTextureSize: a.getParameter(3379),
                                maxAttributes: a.getParameter(34921),
                                maxVertexUniforms: a.getParameter(36347),
                                maxVertexTextureUnits: a.getParameter(35660),
                                maxVaryingVectors: a.getParameter(36348),
                                maxFragmentUniforms: a.getParameter(36349),
                                glsl: a.getParameter(35724),
                                renderer: a.getParameter(7937),
                                vendor: a.getParameter(7936),
                                version: a.getParameter(7938),
                                readFloat: d,
                                npotTextureCube: n
                            }
                        },
                        M = function(a) {
                            return a instanceof Uint8Array ||
                                a instanceof Uint16Array || a instanceof Uint32Array || a instanceof Int8Array || a instanceof Int16Array || a instanceof Int32Array || a instanceof Float32Array || a instanceof Float64Array || a instanceof Uint8ClampedArray
                        },
                        S = function(a) {
                            return Object.keys(a).map(function(b) {
                                return a[b]
                            })
                        },
                        Oa = {
                            shape: function(a) {
                                for (var b = []; a.length; a = a[0]) b.push(a.length);
                                return b
                            },
                            flatten: function(a, b, c, e) {
                                var f = 1;
                                if (b.length)
                                    for (var d = 0; d < b.length; ++d) f *= b[d];
                                else f = 0;
                                c = e || E.allocType(c, f);
                                switch (b.length) {
                                    case 0:
                                        break;
                                    case 1:
                                        e =
                                            b[0];
                                        for (b = 0; b < e; ++b) c[b] = a[b];
                                        break;
                                    case 2:
                                        e = b[0];
                                        b = b[1];
                                        for (d = f = 0; d < e; ++d)
                                            for (var p = a[d], n = 0; n < b; ++n) c[f++] = p[n];
                                        break;
                                    case 3:
                                        ib(a, b[0], b[1], b[2], c, 0);
                                        break;
                                    default:
                                        jb(a, b, 0, c, 0)
                                }
                                return c
                            }
                        },
                        Ga = {
                            "[object Int8Array]": 5120,
                            "[object Int16Array]": 5122,
                            "[object Int32Array]": 5124,
                            "[object Uint8Array]": 5121,
                            "[object Uint8ClampedArray]": 5121,
                            "[object Uint16Array]": 5123,
                            "[object Uint32Array]": 5125,
                            "[object Float32Array]": 5126,
                            "[object Float64Array]": 5121,
                            "[object ArrayBuffer]": 5121
                        },
                        Ia = {
                            int8: 5120,
                            int16: 5122,
                            int32: 5124,
                            uint8: 5121,
                            uint16: 5123,
                            uint32: 5125,
                            "float": 5126,
                            float32: 5126
                        },
                        ob = {
                            dynamic: 35048,
                            stream: 35040,
                            "static": 35044
                        },
                        Sa = Oa.flatten,
                        mb = Oa.shape,
                        ha = [];
                    ha[5120] = 1;
                    ha[5122] = 2;
                    ha[5124] = 4;
                    ha[5121] = 1;
                    ha[5123] = 2;
                    ha[5125] = 4;
                    ha[5126] = 4;
                    var Ta = {
                            points: 0,
                            point: 0,
                            lines: 1,
                            line: 1,
                            triangles: 4,
                            triangle: 4,
                            "line loop": 2,
                            "line strip": 3,
                            "triangle strip": 5,
                            "triangle fan": 6
                        },
                        qb = new Float32Array(1),
                        Mb = new Uint32Array(qb.buffer),
                        Qb = [9984, 9986, 9985, 9987],
                        Ma = [0, 6409, 6410, 6407, 6408],
                        Q = {};
                    Q[6409] = Q[6406] = Q[6402] = 1;
                    Q[34041] =
                        Q[6410] = 2;
                    Q[6407] = Q[35904] = 3;
                    Q[6408] = Q[35906] = 4;
                    var Wa = na("HTMLCanvasElement"),
                        Xa = na("OffscreenCanvas"),
                        vb = na("CanvasRenderingContext2D"),
                        wb = na("ImageBitmap"),
                        xb = na("HTMLImageElement"),
                        yb = na("HTMLVideoElement"),
                        Nb = Object.keys(Ga).concat([Wa, Xa, vb, wb, xb, yb]),
                        wa = [];
                    wa[5121] = 1;
                    wa[5126] = 4;
                    wa[36193] = 2;
                    wa[5123] = 2;
                    wa[5125] = 4;
                    var F = [];
                    F[32854] = 2;
                    F[32855] = 2;
                    F[36194] = 2;
                    F[34041] = 4;
                    F[33776] = .5;
                    F[33777] = .5;
                    F[33778] = 1;
                    F[33779] = 1;
                    F[35986] = .5;
                    F[35987] = 1;
                    F[34798] = 1;
                    F[35840] = .5;
                    F[35841] = .25;
                    F[35842] = .5;
                    F[35843] = .25;
                    F[36196] = .5;
                    var T = [];
                    T[32854] = 2;
                    T[32855] = 2;
                    T[36194] = 2;
                    T[33189] = 2;
                    T[36168] = 1;
                    T[34041] = 4;
                    T[35907] = 4;
                    T[34836] = 16;
                    T[34842] = 8;
                    T[34843] = 6;
                    var Zb = function(a, b, c, e, f) {
                            function d(a) {
                                this.id = t++;
                                this.refCount = 1;
                                this.renderbuffer = a;
                                this.format = 32854;
                                this.height = this.width = 0;
                                f.profile && (this.stats = {
                                    size: 0
                                })
                            }

                            function p(b) {
                                var c = b.renderbuffer;
                                a.bindRenderbuffer(36161, null);
                                a.deleteRenderbuffer(c);
                                b.renderbuffer = null;
                                b.refCount = 0;
                                delete w[b.id];
                                e.renderbufferCount--
                            }
                            var n = {
                                rgba4: 32854,
                                rgb565: 36194,
                                "rgb5 a1": 32855,
                                depth: 33189,
                                stencil: 36168,
                                "depth stencil": 34041
                            };
                            b.ext_srgb && (n.srgba = 35907);
                            b.ext_color_buffer_half_float && (n.rgba16f = 34842, n.rgb16f = 34843);
                            b.webgl_color_buffer_float && (n.rgba32f = 34836);
                            var u = [];
                            Object.keys(n).forEach(function(a) {
                                u[n[a]] = a
                            });
                            var t = 0,
                                w = {};
                            d.prototype.decRef = function() {
                                0 >= --this.refCount && p(this)
                            };
                            f.profile && (e.getTotalRenderbufferSize = function() {
                                var a = 0;
                                Object.keys(w).forEach(function(b) {
                                    a += w[b].stats.size
                                });
                                return a
                            });
                            return {
                                create: function(b, c) {
                                    function l(b, c) {
                                        var d = 0,
                                            e = 0,
                                            k = 32854;
                                        "object" === typeof b && b ? ("shape" in b ? (e = b.shape, d = e[0] | 0, e = e[1] | 0) : ("radius" in b && (d = e = b.radius | 0), "width" in b && (d = b.width | 0), "height" in b && (e = b.height | 0)), "format" in b && (k = n[b.format])) : "number" === typeof b ? (d = b | 0, e = "number" === typeof c ? c | 0 : d) : b || (d = e = 1);
                                        if (d !== h.width || e !== h.height || k !== h.format) return l.width = h.width = d, l.height = h.height = e, h.format = k, a.bindRenderbuffer(36161, h.renderbuffer), a.renderbufferStorage(36161, k, d, e), f.profile && (h.stats.size = T[h.format] * h.width * h.height), l.format = u[h.format],
                                            l
                                    }
                                    var h = new d(a.createRenderbuffer());
                                    w[h.id] = h;
                                    e.renderbufferCount++;
                                    l(b, c);
                                    l.resize = function(b, c) {
                                        var d = b | 0,
                                            e = c | 0 || d;
                                        if (d === h.width && e === h.height) return l;
                                        l.width = h.width = d;
                                        l.height = h.height = e;
                                        a.bindRenderbuffer(36161, h.renderbuffer);
                                        a.renderbufferStorage(36161, h.format, d, e);
                                        f.profile && (h.stats.size = T[h.format] * h.width * h.height);
                                        return l
                                    };
                                    l._reglType = "renderbuffer";
                                    l._renderbuffer = h;
                                    f.profile && (l.stats = h.stats);
                                    l.destroy = function() {
                                        h.decRef()
                                    };
                                    return l
                                },
                                clear: function() {
                                    S(w).forEach(p)
                                },
                                restore: function() {
                                    S(w).forEach(function(b) {
                                        b.renderbuffer =
                                            a.createRenderbuffer();
                                        a.bindRenderbuffer(36161, b.renderbuffer);
                                        a.renderbufferStorage(36161, b.format, b.width, b.height)
                                    });
                                    a.bindRenderbuffer(36161, null)
                                }
                            }
                        },
                        Ya = [];
                    Ya[6408] = 4;
                    Ya[6407] = 3;
                    var Pa = [];
                    Pa[5121] = 1;
                    Pa[5126] = 4;
                    Pa[36193] = 2;
                    var Ba = ["x", "y", "z", "w"],
                        Xb = "blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),
                        Ea = {
                            0: 0,
                            1: 1,
                            zero: 0,
                            one: 1,
                            "src color": 768,
                            "one minus src color": 769,
                            "src alpha": 770,
                            "one minus src alpha": 771,
                            "dst color": 774,
                            "one minus dst color": 775,
                            "dst alpha": 772,
                            "one minus dst alpha": 773,
                            "constant color": 32769,
                            "one minus constant color": 32770,
                            "constant alpha": 32771,
                            "one minus constant alpha": 32772,
                            "src alpha saturate": 776
                        },
                        ab = {
                            never: 512,
                            less: 513,
                            "<": 513,
                            equal: 514,
                            "=": 514,
                            "==": 514,
                            "===": 514,
                            lequal: 515,
                            "<=": 515,
                            greater: 516,
                            ">": 516,
                            notequal: 517,
                            "!=": 517,
                            "!==": 517,
                            gequal: 518,
                            ">=": 518,
                            always: 519
                        },
                        Ra = {
                            0: 0,
                            zero: 0,
                            keep: 7680,
                            replace: 7681,
                            increment: 7682,
                            decrement: 7683,
                            "increment wrap": 34055,
                            "decrement wrap": 34056,
                            invert: 5386
                        },
                        Ab = {
                            cw: 2304,
                            ccw: 2305
                        },
                        Bb = new K(!1, !1, !1, function() {}),
                        $b = function(a, b) {
                            function c() {
                                this.endQueryIndex = this.startQueryIndex = -1;
                                this.sum = 0;
                                this.stats = null
                            }

                            function e(a, b, d) {
                                var e = p.pop() || new c;
                                e.startQueryIndex = a;
                                e.endQueryIndex = b;
                                e.sum = 0;
                                e.stats = d;
                                n.push(e)
                            }
                            if (!b.ext_disjoint_timer_query) return null;
                            var f = [],
                                d = [],
                                p = [],
                                n = [],
                                u = [],
                                t = [];
                            return {
                                beginQuery: function(a) {
                                    var c = f.pop() || b.ext_disjoint_timer_query.createQueryEXT();
                                    b.ext_disjoint_timer_query.beginQueryEXT(35007, c);
                                    d.push(c);
                                    e(d.length -
                                        1, d.length, a)
                                },
                                endQuery: function() {
                                    b.ext_disjoint_timer_query.endQueryEXT(35007)
                                },
                                pushScopeStats: e,
                                update: function() {
                                    var a, c;
                                    a = d.length;
                                    if (0 !== a) {
                                        t.length = Math.max(t.length, a + 1);
                                        u.length = Math.max(u.length, a + 1);
                                        u[0] = 0;
                                        var e = t[0] = 0;
                                        for (c = a = 0; c < d.length; ++c) {
                                            var l = d[c];
                                            b.ext_disjoint_timer_query.getQueryObjectEXT(l, 34919) ? (e += b.ext_disjoint_timer_query.getQueryObjectEXT(l, 34918), f.push(l)) : d[a++] = l;
                                            u[c + 1] = e;
                                            t[c + 1] = a
                                        }
                                        d.length = a;
                                        for (c = a = 0; c < n.length; ++c) {
                                            var e = n[c],
                                                h = e.startQueryIndex,
                                                l = e.endQueryIndex;
                                            e.sum += u[l] - u[h];
                                            h = t[h];
                                            l = t[l];
                                            l === h ? (e.stats.gpuTime += e.sum / 1E6, p.push(e)) : (e.startQueryIndex = h, e.endQueryIndex = l, n[a++] = e)
                                        }
                                        n.length = a
                                    }
                                },
                                getNumPendingQueries: function() {
                                    return d.length
                                },
                                clear: function() {
                                    f.push.apply(f, d);
                                    for (var a = 0; a < f.length; a++) b.ext_disjoint_timer_query.deleteQueryEXT(f[a]);
                                    d.length = 0;
                                    f.length = 0
                                },
                                restore: function() {
                                    d.length = 0;
                                    f.length = 0
                                }
                            }
                        };
                    return function(a) {
                        function b() {
                            if (0 === C.length) z && z.update(), aa = null;
                            else {
                                aa = bb.next(b);
                                w();
                                for (var a = C.length - 1; 0 <= a; --a) {
                                    var c = C[a];
                                    c &&
                                        c(G, null, 0)
                                }
                                l.flush();
                                z && z.update()
                            }
                        }

                        function c() {
                            !aa && 0 < C.length && (aa = bb.next(b))
                        }

                        function e() {
                            aa && (bb.cancel(b), aa = null)
                        }

                        function f(a) {
                            a.preventDefault();
                            e();
                            S.forEach(function(a) {
                                a()
                            })
                        }

                        function d(a) {
                            l.getError();
                            g.restore();
                            D.restore();
                            O.restore();
                            y.restore();
                            L.restore();
                            V.restore();
                            J.restore();
                            z && z.restore();
                            R.procs.refresh();
                            c();
                            T.forEach(function(a) {
                                a()
                            })
                        }

                        function p(a) {
                            function b(a, c) {
                                var d = {},
                                    e = {};
                                Object.keys(a).forEach(function(b) {
                                    var f = a[b];
                                    if (Y.isDynamic(f)) e[b] = Y.unbox(f, b);
                                    else {
                                        if (c &&
                                            Array.isArray(f))
                                            for (var g = 0; g < f.length; ++g)
                                                if (Y.isDynamic(f[g])) {
                                                    e[b] = Y.unbox(f, b);
                                                    return
                                                }
                                        d[b] = f
                                    }
                                });
                                return {
                                    dynamic: e,
                                    "static": d
                                }
                            }

                            function c(a) {
                                for (; n.length < a;) n.push(null);
                                return n
                            }
                            var d = b(a.context || {}, !0),
                                e = b(a.uniforms || {}, !0),
                                f = b(a.attributes || {}, !1);
                            a = b(function(a) {
                                function b(a) {
                                    if (a in c) {
                                        var d = c[a];
                                        delete c[a];
                                        Object.keys(d).forEach(function(b) {
                                            c[a + "." + b] = d[b]
                                        })
                                    }
                                }
                                var c = A({}, a);
                                delete c.uniforms;
                                delete c.attributes;
                                delete c.context;
                                delete c.vao;
                                "stencil" in c && c.stencil.op && (c.stencil.opBack =
                                    c.stencil.opFront = c.stencil.op, delete c.stencil.op);
                                b("blend");
                                b("depth");
                                b("cull");
                                b("stencil");
                                b("polygonOffset");
                                b("scissor");
                                b("sample");
                                "vao" in a && (c.vao = a.vao);
                                return c
                            }(a), !1);
                            var g = {
                                    gpuTime: 0,
                                    cpuTime: 0,
                                    count: 0
                                },
                                h = R.compile(a, f, e, d, g),
                                k = h.draw,
                                l = h.batch,
                                m = h.scope,
                                n = [];
                            return A(function(a, b) {
                                var d;
                                if ("function" === typeof a) return m.call(this, null, a, 0);
                                if ("function" === typeof b)
                                    if ("number" === typeof a)
                                        for (d = 0; d < a; ++d) m.call(this, null, b, d);
                                    else if (Array.isArray(a))
                                    for (d = 0; d < a.length; ++d) m.call(this,
                                        a[d], b, d);
                                else return m.call(this, a, b, 0);
                                else if ("number" === typeof a) {
                                    if (0 < a) return l.call(this, c(a | 0), a | 0)
                                } else if (Array.isArray(a)) {
                                    if (a.length) return l.call(this, a, a.length)
                                } else return k.call(this, a)
                            }, {
                                stats: g,
                                destroy: function() {
                                    h.destroy()
                                }
                            })
                        }

                        function n(a, b) {
                            var c = 0;
                            R.procs.poll();
                            var d = b.color;
                            d && (l.clearColor(+d[0] || 0, +d[1] || 0, +d[2] || 0, +d[3] || 0), c |= 16384);
                            "depth" in b && (l.clearDepth(+b.depth), c |= 256);
                            "stencil" in b && (l.clearStencil(b.stencil | 0), c |= 1024);
                            l.clear(c)
                        }

                        function u(a) {
                            C.push(a);
                            c();
                            return {
                                cancel: function() {
                                    function b() {
                                        var a = Cb(C, b);
                                        C[a] = C[C.length - 1];
                                        --C.length;
                                        0 >= C.length && e()
                                    }
                                    var c = Cb(C, a);
                                    C[c] = b
                                }
                            }
                        }

                        function t() {
                            var a = Q.viewport,
                                b = Q.scissor_box;
                            a[0] = a[1] = b[0] = b[1] = 0;
                            G.viewportWidth = G.framebufferWidth = G.drawingBufferWidth = a[2] = b[2] = l.drawingBufferWidth;
                            G.viewportHeight = G.framebufferHeight = G.drawingBufferHeight = a[3] = b[3] = l.drawingBufferHeight
                        }

                        function w() {
                            G.tick += 1;
                            G.time = v();
                            t();
                            R.procs.poll()
                        }

                        function k() {
                            y.refresh();
                            t();
                            R.procs.refresh();
                            z && z.update()
                        }

                        function v() {
                            return (Db() -
                                E) / 1E3
                        }
                        a = Ib(a);
                        if (!a) return null;
                        var l = a.gl,
                            h = l.getContextAttributes();
                        l.isContextLost();
                        var g = Jb(l, a);
                        if (!g) return null;
                        var q = Fb(),
                            r = {
                                vaoCount: 0,
                                bufferCount: 0,
                                elementsCount: 0,
                                framebufferCount: 0,
                                shaderCount: 0,
                                textureCount: 0,
                                cubeCount: 0,
                                renderbufferCount: 0,
                                maxTextureUnits: 0
                            },
                            m = g.extensions,
                            z = $b(l, m),
                            E = Db(),
                            F = l.drawingBufferWidth,
                            K = l.drawingBufferHeight,
                            G = {
                                tick: 0,
                                time: 0,
                                viewportWidth: F,
                                viewportHeight: K,
                                framebufferWidth: F,
                                framebufferHeight: K,
                                drawingBufferWidth: F,
                                drawingBufferHeight: K,
                                pixelRatio: a.pixelRatio
                            },
                            H = Yb(l, m),
                            O = Kb(l, r, a, function(a) {
                                return J.destroyBuffer(a)
                            }),
                            J = Sb(l, m, H, r, O),
                            M = Lb(l, m, O, r),
                            D = Tb(l, q, r, a),
                            y = Ob(l, m, H, function() {
                                R.procs.poll()
                            }, G, r, a),
                            L = Zb(l, m, H, r, a),
                            V = Rb(l, m, H, y, L, r),
                            R = Wb(l, q, m, H, O, M, y, V, {}, J, D, {
                                elements: null,
                                primitive: 4,
                                count: -1,
                                offset: 0,
                                instances: -1
                            }, G, z, a),
                            q = Ub(l, V, R.procs.poll, G, h, m, H),
                            Q = R.next,
                            N = l.canvas,
                            C = [],
                            S = [],
                            T = [],
                            U = [a.onDestroy],
                            aa = null;
                        N && (N.addEventListener("webglcontextlost", f, !1), N.addEventListener("webglcontextrestored", d, !1));
                        var X = V.setFBO = p({
                            framebuffer: Y.define.call(null,
                                1, "framebuffer")
                        });
                        k();
                        h = A(p, {
                            clear: function(a) {
                                if ("framebuffer" in a)
                                    if (a.framebuffer && "framebufferCube" === a.framebuffer_reglType)
                                        for (var b = 0; 6 > b; ++b) X(A({
                                            framebuffer: a.framebuffer.faces[b]
                                        }, a), n);
                                    else X(a, n);
                                else n(null, a)
                            },
                            prop: Y.define.bind(null, 1),
                            context: Y.define.bind(null, 2),
                            "this": Y.define.bind(null, 3),
                            draw: p({}),
                            buffer: function(a) {
                                return O.create(a, 34962, !1, !1)
                            },
                            elements: function(a) {
                                return M.create(a, !1)
                            },
                            texture: y.create2D,
                            cube: y.createCube,
                            renderbuffer: L.create,
                            framebuffer: V.create,
                            framebufferCube: V.createCube,
                            vao: J.createVAO,
                            attributes: h,
                            frame: u,
                            on: function(a, b) {
                                var c;
                                switch (a) {
                                    case "frame":
                                        return u(b);
                                    case "lost":
                                        c = S;
                                        break;
                                    case "restore":
                                        c = T;
                                        break;
                                    case "destroy":
                                        c = U
                                }
                                c.push(b);
                                return {
                                    cancel: function() {
                                        for (var a = 0; a < c.length; ++a)
                                            if (c[a] === b) {
                                                c[a] = c[c.length - 1];
                                                c.pop();
                                                break
                                            }
                                    }
                                }
                            },
                            limits: H,
                            hasExtension: function(a) {
                                return 0 <= H.extensions.indexOf(a.toLowerCase())
                            },
                            read: q,
                            destroy: function() {
                                C.length = 0;
                                e();
                                N && (N.removeEventListener("webglcontextlost", f), N.removeEventListener("webglcontextrestored", d));
                                D.clear();
                                V.clear();
                                L.clear();
                                y.clear();
                                M.clear();
                                O.clear();
                                J.clear();
                                z && z.clear();
                                U.forEach(function(a) {
                                    a()
                                })
                            },
                            _gl: l,
                            _refresh: k,
                            poll: function() {
                                w();
                                z && z.update()
                            },
                            now: v,
                            stats: r
                        });
                        a.onDone(null, h);
                        return h
                    }
                });

            }, {}],
            64: [function(require, module, exports) {
                'use strict'

                /**
                 * Remove a range of items from an array
                 *
                 * @function removeItems
                 * @param {Array<*>} arr The target array
                 * @param {number} startIdx The index to begin removing from (inclusive)
                 * @param {number} removeCount How many items to remove
                 */
                module.exports = function removeItems(arr, startIdx, removeCount) {
                    var i, length = arr.length

                    if (startIdx >= length || removeCount === 0) {
                        return
                    }

                    removeCount = (startIdx + removeCount > length ? length - startIdx : removeCount)

                    var len = length - removeCount

                    for (i = startIdx; i < len; ++i) {
                        arr[i] = arr[i + removeCount]
                    }

                    arr.length = len
                }

            }, {}],
            65: [function(require, module, exports) {
                module.exports = scrollToAnchor

                function scrollToAnchor(anchor, options) {
                    if (anchor) {
                        try {
                            var el = document.querySelector(anchor)
                            if (el) el.scrollIntoView(options)
                        } catch (e) {}
                    }
                }

            }, {}],
            66: [function(require, module, exports) {
                var assert = require('assert')
                var trie = require('./trie')

                module.exports = Wayfarer

                // create a router
                // str -> obj
                function Wayfarer(dft) {
                    if (!(this instanceof Wayfarer)) return new Wayfarer(dft)

                    var _default = (dft || '').replace(/^\//, '')
                    var _trie = trie()

                    emit._trie = _trie
                    emit.on = on
                    emit.emit = emit
                    emit.match = match
                    emit._wayfarer = true

                    return emit

                    // define a route
                    // (str, fn) -> obj
                    function on(route, fn) {
                        assert.equal(typeof route, 'string')
                        assert.equal(typeof fn, 'function')

                        var cb = fn._wayfarer && fn._trie ? fn : proxy
                        route = route || '/'
                        cb.route = route

                        if (cb._wayfarer && cb._trie) {
                            _trie.mount(route, cb._trie.trie)
                        } else {
                            var node = _trie.create(route)
                            node.cb = cb
                        }

                        return emit

                        function proxy() {
                            return fn.apply(this, Array.prototype.slice.call(arguments))
                        }
                    }

                    // match and call a route
                    // (str, obj?) -> null
                    function emit(route) {
                        var matched = match(route)

                        var args = new Array(arguments.length)
                        args[0] = matched.params
                        for (var i = 1; i < args.length; i++) {
                            args[i] = arguments[i]
                        }

                        return matched.cb.apply(matched.cb, args)
                    }

                    function match(route) {
                        assert.notEqual(route, undefined, "'route' must be defined")

                        var matched = _trie.match(route)
                        if (matched && matched.cb) return new Route(matched)

                        var dft = _trie.match(_default)
                        if (dft && dft.cb) return new Route(dft)

                        throw new Error("route '" + route + "' did not match")
                    }

                    function Route(matched) {
                        this.cb = matched.cb
                        this.route = matched.cb.route
                        this.params = matched.params
                    }
                }

            }, {
                "./trie": 67,
                "assert": 3
            }],
            67: [function(require, module, exports) {
                var mutate = require('xtend/mutable')
                var assert = require('assert')
                var xtend = require('xtend')

                module.exports = Trie

                // create a new trie
                // null -> obj
                function Trie() {
                    if (!(this instanceof Trie)) return new Trie()
                    this.trie = {
                        nodes: {}
                    }
                }

                // create a node on the trie at route
                // and return a node
                // str -> null
                Trie.prototype.create = function(route) {
                    assert.equal(typeof route, 'string', 'route should be a string')
                        // strip leading '/' and split routes
                    var routes = route.replace(/^\//, '').split('/')

                    function createNode(index, trie) {
                        var thisRoute = (routes.hasOwnProperty(index) && routes[index])
                        if (thisRoute === false) return trie

                        var node = null
                        if (/^:|^\*/.test(thisRoute)) {
                            // if node is a name match, set name and append to ':' node
                            if (!trie.nodes.hasOwnProperty('$$')) {
                                node = {
                                    nodes: {}
                                }
                                trie.nodes['$$'] = node
                            } else {
                                node = trie.nodes['$$']
                            }

                            if (thisRoute[0] === '*') {
                                trie.wildcard = true
                            }

                            trie.name = thisRoute.replace(/^:|^\*/, '')
                        } else if (!trie.nodes.hasOwnProperty(thisRoute)) {
                            node = {
                                nodes: {}
                            }
                            trie.nodes[thisRoute] = node
                        } else {
                            node = trie.nodes[thisRoute]
                        }

                        // we must recurse deeper
                        return createNode(index + 1, node)
                    }

                    return createNode(0, this.trie)
                }

                // match a route on the trie
                // and return the node
                // str -> obj
                Trie.prototype.match = function(route) {
                    assert.equal(typeof route, 'string', 'route should be a string')

                    var routes = route.replace(/^\//, '').split('/')
                    var params = {}

                    function search(index, trie) {
                        // either there's no match, or we're done searching
                        if (trie === undefined) return undefined
                        var thisRoute = routes[index]
                        if (thisRoute === undefined) return trie

                        if (trie.nodes.hasOwnProperty(thisRoute)) {
                            // match regular routes first
                            return search(index + 1, trie.nodes[thisRoute])
                        } else if (trie.name) {
                            // match named routes
                            try {
                                params[trie.name] = decodeURIComponent(thisRoute)
                            } catch (e) {
                                return search(index, undefined)
                            }
                            return search(index + 1, trie.nodes['$$'])
                        } else if (trie.wildcard) {
                            // match wildcards
                            try {
                                params['wildcard'] = decodeURIComponent(routes.slice(index).join('/'))
                            } catch (e) {
                                return search(index, undefined)
                            }
                            // return early, or else search may keep recursing through the wildcard
                            return trie.nodes['$$']
                        } else {
                            // no matches found
                            return search(index + 1)
                        }
                    }

                    var node = search(0, this.trie)

                    if (!node) return undefined
                    node = xtend(node)
                    node.params = params
                    return node
                }

                // mount a trie onto a node at route
                // (str, obj) -> null
                Trie.prototype.mount = function(route, trie) {
                    assert.equal(typeof route, 'string', 'route should be a string')
                    assert.equal(typeof trie, 'object', 'trie should be a object')

                    var split = route.replace(/^\//, '').split('/')
                    var node = null
                    var key = null

                    if (split.length === 1) {
                        key = split[0]
                        node = this.create(key)
                    } else {
                        var head = split.join('/')
                        key = split[0]
                        node = this.create(head)
                    }

                    mutate(node.nodes, trie.nodes)
                    if (trie.name) node.name = trie.name

                    // delegate properties from '/' to the new node
                    // '/' cannot be reached once mounted
                    if (node.nodes['']) {
                        Object.keys(node.nodes['']).forEach(function(key) {
                            if (key === 'nodes') return
                            node[key] = node.nodes[''][key]
                        })
                        mutate(node.nodes, node.nodes[''].nodes)
                        delete node.nodes[''].nodes
                    }
                }

            }, {
                "assert": 3,
                "xtend": 68,
                "xtend/mutable": 69
            }],
            68: [function(require, module, exports) {
                module.exports = extend

                var hasOwnProperty = Object.prototype.hasOwnProperty;

                function extend() {
                    var target = {}

                    for (var i = 0; i < arguments.length; i++) {
                        var source = arguments[i]

                        for (var key in source) {
                            if (hasOwnProperty.call(source, key)) {
                                target[key] = source[key]
                            }
                        }
                    }

                    return target
                }

            }, {}],
            69: [function(require, module, exports) {
                module.exports = extend

                var hasOwnProperty = Object.prototype.hasOwnProperty;

                function extend(target) {
                    for (var i = 1; i < arguments.length; i++) {
                        var source = arguments[i]

                        for (var key in source) {
                            if (hasOwnProperty.call(source, key)) {
                                target[key] = source[key]
                            }
                        }
                    }

                    return target
                }

            }, {}],
            70: [function(require, module, exports) {
                var colors = {
                    red: [1, 0, 0],
                    yellow: [1, 1, 0],
                    lime: [0, 1, 0],
                    blue: [0, 0, 1],
                    purple: [0.5, 0, 1],
                    gray: [0.5, 0.5, 0.5]
                }

                module.exports = function(state, emitter) {
                    state.colors = ['red', 'yellow', 'lime', 'blue', 'purple']
                    state.brickMesh = {}
                    state.hoverBrickMesh = {}
                    state.hoverBrick = null
                    onclear()
                    emitter.on('clear', onclear)

                    function onclear() {
                        state.brickMesh.positions = []
                        state.brickMesh.cells = []
                        state.brickMesh.colors = []
                        state.brickMesh.ids = []
                        state.brickMesh.depth = true
                        state.hoverBrickMesh.positions = []
                        state.hoverBrickMesh.cells = []
                        state.hoverBrickMesh.colors = []
                        state.hoverBrickMesh.ids = []
                        state.hoverBrickMesh.depth = true
                        var base = {
                            size: [20, 1 / 3, 20],
                            offset: [0, -2 / 3, 0],
                            color: [0.1, 0.5, 0.1],
                            id: 0
                        }
                        createBrick(state.brickMesh, base)
                        state.bricks = [base]
                        emitter.emit('frame')
                    }

                    emitter.on('hover-brick', function(opts) {
                        state.hoverBrickMesh.positions = []
                        state.hoverBrickMesh.colors = []
                        state.hoverBrickMesh.cells = []
                        state.hoverBrickMesh.ids = []
                        state.hoverBrickMesh.depth = !state.ui.remove
                        state.hoverBrick = opts
                        if (opts) {
                            opts.id = state.bricks.length
                            createBrick(state.hoverBrickMesh, opts)
                        }
                    })

                    emitter.on('add-brick', function(opts) {
                        opts.id = state.bricks.length
                        createBrick(state.brickMesh, opts)
                        state.bricks.push(opts)
                    })

                    emitter.on('remove-brick', function(data) {
                        state.bricks.splice(data[3], 1)
                    })

                    emitter.on('rebuild-bricks', function() {
                        state.brickMesh = {
                            positions: [],
                            cells: [],
                            colors: [],
                            ids: []
                        }
                        for (var i = 0; i < state.bricks.length; i++) {
                            var b = state.bricks[i]
                            b.id = i
                            createBrick(state.brickMesh, b)
                        }
                    })
                }

                function createBrick(mesh, opts) {
                    var size = opts.size
                    var offset = [opts.offset[0], opts.offset[1], opts.offset[2]]
                    offset[0] += size[0] % 2 * 0.5
                    offset[2] += size[2] % 2 * 0.5
                    var id = opts.id
                    var k = mesh.positions.length
                    var color = typeof opts.color === 'string' ? colors[opts.color] : opts.color
                    mesh.positions.push(
                        [-1 * size[0] + offset[0] * 2, -1 * size[1] + offset[1] * 2 + 1, -1 * size[2] + offset[2] * 2], [+1 * size[0] + offset[0] * 2, -1 * size[1] + offset[1] * 2 + 1, -1 * size[2] + offset[2] * 2], [+1 * size[0] + offset[0] * 2, -1 * size[1] + offset[1] * 2 + 1, +1 * size[2] + offset[2] * 2], [-1 * size[0] + offset[0] * 2, -1 * size[1] + offset[1] * 2 + 1, +1 * size[2] + offset[2] * 2], [-1 * size[0] + offset[0] * 2, +1 * size[1] + offset[1] * 2 + 1, -1 * size[2] + offset[2] * 2], [+1 * size[0] + offset[0] * 2, +1 * size[1] + offset[1] * 2 + 1, -1 * size[2] + offset[2] * 2], [+1 * size[0] + offset[0] * 2, +1 * size[1] + offset[1] * 2 + 1, +1 * size[2] + offset[2] * 2], [-1 * size[0] + offset[0] * 2, +1 * size[1] + offset[1] * 2 + 1, +1 * size[2] + offset[2] * 2]
                    )
                    for (var i = 0; i < 8; i++) {
                        mesh.colors.push(color)
                        mesh.ids.push(id)
                    }
                    mesh.cells.push(
                        [k + 0, k + 1, k + 2], [k + 0, k + 2, k + 3], [k + 6, k + 5, k + 4], [k + 7, k + 6, k + 4], [k + 4, k + 1, k + 0], [k + 4, k + 5, k + 1], [k + 5, k + 2, k + 1], [k + 5, k + 6, k + 2], [k + 6, k + 3, k + 2], [k + 6, k + 7, k + 3], [k + 7, k + 0, k + 3], [k + 0, k + 7, k + 4]
                    )
                    var n = 12
                    for (var x = 0; x < size[0]; x++) {
                        for (var z = 0; z < size[2]; z++) {
                            var k = mesh.positions.length
                            for (var i = 0; i < n; i++) {
                                var theta = i / n * 2 * Math.PI
                                var px = Math.cos(theta) * 0.8 + x * 2 - (size[0] - 1) + offset[0] * 2
                                var pz = Math.sin(theta) * 0.8 + z * 2 - (size[2] - 1) + offset[2] * 2
                                mesh.positions.push([px, size[1] + 0.4 + offset[1] * 2 + 1, pz])
                                mesh.positions.push([px, size[1] + offset[1] * 2 + 1, pz])
                                mesh.colors.push(color, color)
                                mesh.ids.push(id, id)
                                mesh.cells.push([k + (i + 1) % n * 2, k + i * 2, k])
                                mesh.cells.push([k + i * 2, k + (i + 1) % n * 2, k + i * 2 + 1])
                                mesh.cells.push([k + i * 2 + 1, k + (i + 1) % n * 2, k + (i + 1) % n * 2 + 1])
                            }
                        }
                    }
                    return mesh
                }

            }, {}],
            71: [function(require, module, exports) {
                var mat4 = require('gl-mat4')

                module.exports = function(state, emitter) {
                    state.camera = {
                        projection: new Float32Array(16),
                        view: new Float32Array(16),
                        eye: Float32Array.from([0, 25, -50]),
                        center: Float32Array.from([0, 0, 0]),
                        up: Float32Array.from([0, 1, 0]),
                        distance: 50,
                        theta: 0.78,
                        phi: 0.78
                    }
                    state.uniforms.projection = function(context) {
                        var aspect = context.viewportWidth / context.viewportHeight
                        return mat4.perspective(state.camera.projection, Math.PI / 4, aspect, 0.1, 1000.0)
                    }
                    state.uniforms.view = function(context) {
                        var theta = state.camera.theta,
                            phi = state.camera.phi
                        var d = state.camera.distance
                        state.camera.eye[0] = Math.cos(theta) * Math.sin(phi) * d
                        state.camera.eye[1] = Math.cos(phi) * d
                        state.camera.eye[2] = Math.sin(theta) * Math.sin(phi) * d
                        return mat4.lookAt(state.camera.view,
                            state.camera.eye, state.camera.center, state.camera.up)
                    }
                    emitter.on('mouse', function(cur, prev) {
                        if (cur.type === 'wheel') {
                            state.camera.distance = Math.max(1, Math.min(100,
                                state.camera.distance + cur.deltaY / 10))
                            emitter.emit('frame')
                        } else if (prev && (cur.buttons & 1)) {
                            var dx = cur.clientX - prev.clientX
                            var dy = cur.clientY - prev.clientY
                            state.camera.theta += dx * 0.01
                            state.camera.phi = clamp(
                                0.001, +Math.PI - 0.001,
                                state.camera.phi - dy * 0.01
                            )
                            emitter.emit('frame')
                        }
                    })
                }

                function clamp(a, b, x) {
                    return Math.max(a, Math.min(b, x))
                }

            }, {
                "gl-mat4": 26
            }],
            72: [function(require, module, exports) {
                module.exports = function(state, emitter) {
                    state.ui = {
                        color: 'red',
                        moved: false,
                        brick: [4, 1, 2],
                        remove: false
                    }
                    emitter.on('select-brick', function(size) {
                        state.ui.brick = size
                        emitter.emit('render')
                    })
                    emitter.on('set-color', function(color) {
                        state.ui.color = color
                        state.ui.remove = false
                        state.hoverBrick.color = color
                        emitter.emit('hover-brick', state.hoverBrick)
                        emitter.emit('frame')
                    })
                    emitter.on('toggle-remove', function() {
                        state.ui.remove = !state.ui.remove
                        emitter.emit('render')
                    })
                    emitter.on('rotate-brick', function() {
                        var x = state.ui.brick[0],
                            z = state.ui.brick[2]
                        state.ui.brick[0] = z
                        state.ui.brick[2] = x
                        if (state.hoverBrick) {
                            state.hoverBrick.size = state.ui.brick.slice()
                            emitter.emit('hover-brick', state.hoverBrick)
                        }
                        emitter.emit('render')
                        emitter.emit('frame')
                    })
                    emitter.on('keydown', function(ev) {
                        var m
                        if (ev.code === 'KeyR') emitter.emit('rotate-brick')
                        else if (ev.code === 'KeyD') emitter.emit('toggle-remove')
                        else if (m = /^Digit(\d+)$/.exec(ev.code)) {
                            if (state.colors[m[1]]) {
                                emitter.emit('set-color', state.colors[m[1]])
                                emitter.emit('frame')
                            }
                        }
                    })
                    emitter.on('pick-data', function(data, ev) {
                        if (ev.type === 'mousedown') {
                            state.ui.moved = false
                        } else if (ev.type === 'mouseup' && !state.ui.moved) {
                            if (state.ui.remove) {
                                if (data[3] > 0) {
                                    emitter.emit('remove-brick', data)
                                    emitter.emit('rebuild-bricks')
                                }
                            } else {
                                emitter.emit('add-brick', {
                                    color: state.ui.color,
                                    size: state.ui.brick.slice(),
                                    offset: [data[0], data[1], data[2]]
                                })
                            }
                            emitter.emit('frame')
                        } else if (ev.type === 'mousemove') {
                            if (state.ui.remove) {
                                var b = data[3] > 0 && state.bricks[data[3]]
                                emitter.emit('hover-brick', b ? {
                                    color: 'gray',
                                    size: b.size.slice(),
                                    offset: b.offset
                                } : null)
                            } else {
                                emitter.emit('hover-brick', data[3] >= 0 ? {
                                    color: state.ui.color,
                                    size: state.ui.brick.slice(),
                                    offset: [data[0], data[1], data[2]]
                                } : null)
                            }
                            state.ui.moved = true
                            emitter.emit('frame')
                        }
                    })
                }

            }, {}],
            73: [function(require, module, exports) {
                        var html = require('choo/html')
                        var brickSizes = [
                            [4, 1, 2],
                            [3, 1, 2],
                            [2, 1, 2],
                            [4, 1, 1],
                            [3, 1, 1],
                            [2, 1, 1],
                            [1, 1, 1]
                        ]
                        var fg = {
                            red: 'dark',
                            yellow: 'dark',
                            lime: 'dark',
                            blue: 'light',
                            purple: 'light'
                        }

                        module.exports = function(state, emit) {
                                return html `<body>
    <style>
      canvas {
        position: absolute;
        top: 0px;
        left: 0px;
        bottom: 0px;
        right: 0px;
        z-index: 5;
      }
      .buttons {
        position: absolute;
        top: 4px;
        z-index: 10;
      }
      .buttons button {
        width: 2em;
        height: 2em;
        vertical-align: top;
        margin-right: 8px;
        border: 1px solid #404040;
      }
      .buttons button.toggle.active {
        background-color: #ff80a0;
        color: #808080;
        border-color: #808080;
      }
      .buttons button.color.light {
        color: white;
      }
      .buttons button.color.dark {
        color: black;
      }
      .buttons select {
        height: 2em;
      }
    </style>
    <div class="buttons">
      <button style="display:none" onclick=${rotate} alt="rotate (key: R)" title="rotate (key: R)">
        ${state.ui.brick[0] > state.ui.brick[2] ? '\u21b7' : '\u21b6'}
      </button>
      <button style="display:none" onclick=${toggleRemove}
        alt="toggle remove mode ${state.ui.remove ? 'off' : 'on'} (key: d)"
        title="toggle remove mode ${state.ui.remove ? 'off' : 'on'} (key: d)"
        class="toggle ${state.ui.remove ? 'active' : ''}">X</button>
      <button onclick=${clear} alt="clear" title="clear">\u2205</button>
      ${state.colors.map(function (color,i) {
        return html`<button style="background-color: ${color}"
          class="color ${fg[color]}" alt="${color}" title="${color}"
          onclick=${setColor(color)}>${i}</button>`
      })}
      <select onchange=${selectBrick}>
        ${brickSizes.map(function (size) {
          var selected = state.ui.brick.join(' ') === size.join(' ')
          return html`<option ${selected ? 'selected' : ''}>
            ${size.join(' ')}</option>`
        })}
      </select>
    </div>
    ${state.canvas}
  </body>`
  function setColor (color) {
    return function () { emit('set-color', color) }
  }
  function rotate () { emit('rotate-brick') }
  function toggleRemove () { emit('toggle-remove') }
  function selectBrick () {
    if (this.blur) this.blur()
    emit('select-brick', this.value.split(' ').map(Number))
  }
  function clear () { emit('clear') }
}

},{"choo/html":8}]},{},[2]);
</script>

</html>